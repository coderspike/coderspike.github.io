<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="精于心简于形" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="小郭的编程之路">
<meta property="og:type" content="website">
<meta property="og:title" content="精于心简于形">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="精于心简于形">
<meta property="og:description" content="小郭的编程之路">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="精于心简于形">
<meta name="twitter:description" content="小郭的编程之路">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/page/2/"/>

  <title> 精于心简于形 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">精于心简于形</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">iOS Road</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-code">
          <a href="/categories/编程" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            编程
          </a>
        </li>
      
        
        <li class="menu-item menu-item-life">
          <a href="/categories/生活" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            生活
          </a>
        </li>
      
        
        <li class="menu-item menu-item-book">
          <a href="/categories/读书" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            读书
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/06/iOS页面流/" itemprop="url">
                  iOS页面流
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-06T14:09:27+08:00" content="2016-06-06">
              2016-06-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>开始学iOS编程的时候对页面之间如何跳转，传值等问题一直没太闹清楚，用这篇文章整理一下，大部分内容转载自这位阿里大神的博客（<a href="http://www.samirchen.com/），个人能力有限，希望在不断的记录中踏实前进。" target="_blank" rel="external">http://www.samirchen.com/），个人能力有限，希望在不断的记录中踏实前进。</a></p>
</blockquote>
<h2 id="页面流"><a href="#页面流" class="headerlink" title="页面流"></a>页面流</h2><p><img src="http://ww2.sinaimg.cn/mw1024/bc254b75jw1f4usactd4rj20k20j4gns.jpg" alt="页面流"></p>
<p>一个手机上的app，通常会有多个页面，我们从页面A跳转到页面B，再从页面B跳到页面C，然后我们从页面C跳回到B，或者直接从页面C跳回到页面A，这些跳转，就是我们页面流的逻辑。看看上面的图，可以知道，我们这里主要讨论的是iOS中基于 Navigation方式 + Modal方式 的页面流逻辑。</p>
<p>那么什么是 Navigation式 的跳转？什么又是 Modal式 的跳转呢？</p>
<p>Navigation式 的跳转就是上图中蓝色的实线箭头所表示的跳转方式，它所推动的整个视图流就如同一个树状结构，非常清晰，多用于主干视图的展现。iOS 在管理它们时用到了 UINavigationController，其机制就如同栈一样。在图中所有被 Navigation式 地管理着的 View Controller 我都把背景标为了蓝色。</p>
<p>Modal式 的跳转就是上图中绿色的虚线箭头所表示的跳转方式，它多用于场景式的视图的展现，所以作为 Modal 跳转的目的 VC 通常是用于展示数据的视图或者功能性视图等等，这样的视图可能会在主干中的多种情况下被调用，就比如图中的 VCM1 被 VCN2 和 VCN3 都用到了。在我们实际使用中，通常拍照页面对应的VC就会被用作是Modal式的。在图中所有被 Modal式 地管理着的 View Controller 我都把背景标为了绿色。</p>
<h2 id="页面之间的跳转及传参（暂列出几种，剩下的会在以后逐步添加。）"><a href="#页面之间的跳转及传参（暂列出几种，剩下的会在以后逐步添加。）" class="headerlink" title="页面之间的跳转及传参（暂列出几种，剩下的会在以后逐步添加。）"></a>页面之间的跳转及传参（暂列出几种，剩下的会在以后逐步添加。）</h2><ul>
<li><h4 id="在设置根控制器的时候可以传参："><a href="#在设置根控制器的时候可以传参：" class="headerlink" title="在设置根控制器的时候可以传参："></a>在设置根控制器的时候可以传参：</h4></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">NavigationController的初始化</span><br><span class="line">在图中，我们的入口是先创建一个 UINavigationController，并把它的初始VC设置为 VCN1，同时可以在这里传参，代码如下：</span><br><span class="line"></span><br><span class="line">// 在 AppDelegate.m 中</span><br><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</span><br><span class="line">&#123;</span><br><span class="line">	VCN1* vcn1 = [[VCN1 alloc] init];</span><br><span class="line">	vcn1.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">	UINavigationController* mainNavigationController = [[UINavigationController alloc] initWithRootViewController:vcn1];</span><br><span class="line">	[mainNavigationController setNavigationBarHidden:YES];</span><br><span class="line">	[self.window setRootViewController:mainNavigationController];</span><br><span class="line">	self.window.backgroundColor = [UIColor whiteColor];</span><br><span class="line">	[self.window makeKeyAndVisible];</span><br><span class="line">	return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><h4 id="Navigation-Push-传参"><a href="#Navigation-Push-传参" class="headerlink" title="Navigation-Push 传参"></a>Navigation-Push 传参</h4></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">在图中，蓝色实线正向的箭头就表示的是 Navigation 的 Push 动作，比如：VCN1-&gt;VCN2; VCN1-&gt;VCN3-&gt;VCN4; VCN5-&gt;VCN6; VCN5-&gt;VCN7-&gt;VCN8 等跳转。一般来说，我们都是一级一级往前Push的，不应该有 VCN1-&gt;VCN4 这样的正向跳跃式Push的需求，要不然图就不这样画了，页面流就不这样设计了。在Push动作中传参是非常简单直接的，因为你这里创建了你要跳达的VC，直接设置其参数属性就可以了。</span><br><span class="line"></span><br><span class="line">例如，VCN1-&gt;VCN2 的跳转代码</span><br><span class="line"></span><br><span class="line">// 在 VCN1.m 中</span><br><span class="line">-(void) goVCN2:(id)sender &#123;</span><br><span class="line">	VCN2* vcn2 = [[VCN2 alloc] init];</span><br><span class="line">	vcn2.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">	[self.navigationController pushViewController:vcn2 animated:YES]; // 这里的self.navigationController就是MainNavigationController。</span><br><span class="line">&#125;</span><br><span class="line">在做了以上Push后，VCN2 就会被压到由MainNavigationController管理的栈的栈顶。这个栈就是 self.navigationController.viewControllers。</span><br><span class="line"></span><br><span class="line">Push动作是很简单的，基本上所有的Push代码都类似上面这样写。</span><br><span class="line"></span><br><span class="line">以下为push传值的两个实例：</span><br><span class="line">实例一和实例二都是一个意思，主要是在.m中有可接收的属性，再用push的方式进行传值</span><br><span class="line"></span><br><span class="line">实例一：</span><br><span class="line">首先SecondViewController视图中需要有一个属性用来存储传递过来的值：</span><br><span class="line">@property(nonatomic,retain) NSString *firstValue ;//属性传值</span><br><span class="line"></span><br><span class="line">然后MainViewController视图需要引用SecondViewController视图的头文件，在视图中的按钮点击事件中，通过SecondViewController的对象将需要传递的值存在firstValue中:</span><br><span class="line">(void)buttonAction:(UIButton *)button</span><br><span class="line">&#123;</span><br><span class="line">SecondViewController *second = </span><br><span class="line">[[SecondViewController alloc]init];//用下一个视图的属性接受想要传过去的值,属性传值</span><br><span class="line">second.firstValue = _txtFiled.text;</span><br><span class="line">[self.navigationController pushViewController:second animated:YES];</span><br><span class="line">&#125;</span><br><span class="line">页面跳转之后，就能在SecondViewController视图中，通过存值的属性，取用刚才传递过来的值：</span><br><span class="line">//显示传过来的值[_txtFiled setText:_firstValue];</span><br><span class="line"></span><br><span class="line">实例二：</span><br><span class="line">属性传值 将A页面所拥有的信息通过属性传递到B页面使用</span><br><span class="line">B页面定义了一个naviTitle属性，在A页面中直接通过属性赋值将A页面中的值传到B页面。</span><br><span class="line"></span><br><span class="line">A页面DetailViewController.h文件</span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line">#import &quot;DetailViewController.h&quot;</span><br><span class="line">@interface RootViewController :UIViewController&lt;ChangeDelegate&gt;</span><br><span class="line">&#123;</span><br><span class="line">    UITextField *tf;</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">A RootViewController.m页面实现文件</span><br><span class="line">#import &quot;RootViewController.h&quot;</span><br><span class="line">#import &quot;DetailViewController.h&quot;</span><br><span class="line"></span><br><span class="line">@interface RootViewController ()</span><br><span class="line">@end</span><br><span class="line">@implementation RootViewController</span><br><span class="line">//核心代码</span><br><span class="line">-(void)loadView</span><br><span class="line">&#123;</span><br><span class="line">    UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];</span><br><span class="line">    btn.frame = CGRectMake(0, 0, 100, 30);</span><br><span class="line">    [btn setTitle:@&quot;Push&quot; forState:0];</span><br><span class="line">    [btn addTarget:self action:@selector(pushAction:) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">    [self.view addSubview:btn];</span><br><span class="line">&#125;</span><br><span class="line">-(void)pushAction:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    tf = (UITextField *)[self.viewviewWithTag:1000];</span><br><span class="line">    //导航push到下一个页面</span><br><span class="line">    //pushViewController 入栈引用计数+1，且控制权归系统</span><br><span class="line">    </span><br><span class="line">    DetailViewController *detailViewController = [[DetailViewControlleralloc]init];</span><br><span class="line">    //属性传值，直接属性赋值</span><br><span class="line">    detailViewController.naviTitle =tf.text;</span><br><span class="line">    //导航push到下一个页面</span><br><span class="line">    [self.navigationControllerpushViewController:detailViewController animated:YES];</span><br><span class="line">    [detailViewControllerrelease];   </span><br><span class="line">&#125;</span><br><span class="line">B页面DetailViewController.h文件</span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line">@interface DetailViewController :UIViewController</span><br><span class="line">&#123;</span><br><span class="line">   UITextField *textField;</span><br><span class="line">   NSString *_naviTitle;</span><br><span class="line">&#125;</span><br><span class="line">@property(nonatomic,retain)NSString *naviTitle;</span><br><span class="line">@end</span><br><span class="line">B页面.m实现文件</span><br><span class="line">#import &quot;DetailViewController.h&quot;</span><br><span class="line">@interface DetailViewController ()</span><br><span class="line">@end</span><br><span class="line">@implementation DetailViewController</span><br><span class="line">@synthesize naviTitle =_naviTitle;</span><br><span class="line">-(void)loadView</span><br><span class="line">&#123;</span><br><span class="line">    self.view = [[[UIViewalloc]initWithFrame:CGRectMake(0,0, 320,480)]autorelease];</span><br><span class="line">   self.title = self.naviTitle ;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><h4 id="Navigation-Pop-传参"><a href="#Navigation-Pop-传参" class="headerlink" title="Navigation-Pop 传参"></a>Navigation-Pop 传参</h4></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">在图中，蓝色实线反向的箭头就表示的是 Navigation 的 Pop 动作，比如：VCN2-&gt;VCN1; VCN4-&gt;VCN3 等跳转，Pop的跳转需求相对Push就复杂一点了，因为我们还可能有类似 VCN4-&gt;VCN1; VCN8-&gt;VCN5 这样的反向跳跃式Pop的需求，这种需求是合理的。比如：我们由“设置页面”进入“登陆页面”，由“登陆页面”进入“注册页面”，等注册完成了，我们想从“注册页面”直接跳回“登陆页面”这是合理的。所以这里Pop动作就分为：</span><br><span class="line"></span><br><span class="line">1）逐级Pop</span><br><span class="line">逐级Pop是很简单，但是要往回传参就没Push那样方便了，你需要去 self.navigationController.viewControllers 中去找到你要跳达的VC，然后设置其参数。例如，VCN2-&gt;VCN1 的跳转代码</span><br><span class="line"></span><br><span class="line">// 在 VCN2.m 中</span><br><span class="line">-(void) back:(id)sender &#123;</span><br><span class="line">    NSInteger *preVCIndex = self.navigationController.viewControllers.count - 2;</span><br><span class="line">    if (preVCIndex &gt;= 0) &#123;</span><br><span class="line">        UIViewController *preVC = [self.navigationController.viewControllers objectAtIndex:preVCIndex];</span><br><span class="line">        if ([preVC isKindOfClass:[VCN1 class]]) &#123;</span><br><span class="line">        	VCN1* vcn1 = (VCN1*) preVC;</span><br><span class="line">        	vcn1.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	[self.navigationController popViewControllerAnimated:YES];</span><br><span class="line">&#125;</span><br><span class="line">做了以上的Pop后，VCN2 就会被弹出由MainNavigationController管理的栈。</span><br><span class="line"></span><br><span class="line">2）跳跃式Pop</span><br><span class="line">要完成跳跃式Pop，可以去遍历 self.navigationController.viewControllers 找到你想跳达的页面，然后Pop过去就可以了，传参也在这时设置即可。例如，VCN4-&gt;VCN1 的跳转代码</span><br><span class="line"></span><br><span class="line">// 在 VCN4.m 中</span><br><span class="line">-(void) backToVCN1:(id)sender &#123;</span><br><span class="line">	// 这里要稍微复杂一点</span><br><span class="line">	for (UIViewController* vc in self.navigationController.viewControllers) &#123;</span><br><span class="line">    	if ([vc isKindOfClass:[VCN1 class]]) &#123;</span><br><span class="line">    		vcn1.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">        	[self.navigationController popToViewController:vc animated:YES];</span><br><span class="line">    	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">做了以上的跳跃式Pop后，self.navigationController.viewControllers 这个栈中所有在 VCN1 上面的 VC 都会被弹出。通过这种方式，可以跳到栈中任意的页面。</span><br><span class="line"></span><br><span class="line">如果你想直接回到栈底，比如在我们的图中 VCN4-&gt;VCN1 就是回到栈底的情况，你还可以这样做：</span><br><span class="line"></span><br><span class="line">// 在 VCN4.m 中</span><br><span class="line">-(void) backToVCN1:(id)sender &#123;</span><br><span class="line">	if ([[self.navigationController.viewControllers firstObject] isKindOfClass:[VCN1 class]]) &#123;</span><br><span class="line">    	VCN1* vcn1 = (VCN1*) [self.navigationController.viewControllers firstObject];</span><br><span class="line">    	vcn1.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">	&#125;</span><br><span class="line">	[self.navigationController popToRootViewControllerAnimated:YES];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><h5 id="Modal-Present"><a href="#Modal-Present" class="headerlink" title="Modal-Present"></a>Modal-Present</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">在图中，绿色虚线正向的箭头就表示的是 Modal 的 Present 动作，比如：VCN2-&gt;VCM1; VCM1-&gt;VCM2; VCN4-&gt;VCN5; VCN6-&gt;VCM3 等跳转。Present 也是一级一级往前的。在Present动作中传参，也跟Push类似，因为在这里你要创建你想要展示的页面，这时候设置其参数属性即可。但是在我们的图中出现了几种不同Present的情况：</span><br><span class="line"></span><br><span class="line">1）Navigation页面流中的某个页面Present一个Modal的页面</span><br><span class="line">例如，VCN2-&gt;VCM1 的跳转代码：</span><br><span class="line"></span><br><span class="line">// 在 VCN2.m 中</span><br><span class="line">-(void) goVCM1:(id)sender &#123;</span><br><span class="line">	VCM1* vcm1 = [[VCM1 alloc] init];</span><br><span class="line">	[vcm1 setModalTransitionStyle:UIModalTransitionStyleCoverVertical];</span><br><span class="line">	vcm1.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">	[self.navigationController presentViewController:vcm1 animated:YES completion:nil]; // Present modal vc, not pop. 这里用 self.navigationController present 和 用 self present 的效果都是一样的。但是倾向与用前者，后面说明为什么。</span><br><span class="line">&#125;</span><br><span class="line">2）一个Modal的页面Present另一个Modal的页面</span><br><span class="line">例如，VCM1-&gt;VCM2 的跳转代码：</span><br><span class="line"></span><br><span class="line">// 在 VCM1.m 中</span><br><span class="line">-(void) goVCM2:(id)sender &#123;</span><br><span class="line">	VCM2* vcm2 = [[VCM2 alloc] init];</span><br><span class="line">	[vcm2 setModalTransitionStyle:UIModalTransitionStyleCoverVertical];</span><br><span class="line">	vcm2.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">	[self presentViewController:vcm2 animated:YES completion:nil]; // Present modal vc, not pop. 这里只能用 self present 了。</span><br><span class="line">&#125;</span><br><span class="line">3）一个Navigation页面流中的某个页面Present另一个Navigation页面流</span><br><span class="line">这个过程其实就是再创建一个UINavigationController，指定它的 root vc，然后 Present 出来即可，但是注意这里Present的是这个新创建的 UINavigationController。</span><br><span class="line"></span><br><span class="line">例如，VCN4-&gt;SubNavigationVC.VCN5 的跳转代码：</span><br><span class="line"></span><br><span class="line">// 在 VCN4.m 中</span><br><span class="line">-(void) goSubNavigationVC:(id)sender &#123;</span><br><span class="line">	VCN5* vcn5 = [[VCN5 alloc] init]; // 这个是 subNavigationController 的 root vc。</span><br><span class="line">	vcn5.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">	UINavigationController* subNavigationController = [[UINavigationController alloc] initWithRootViewController:vcn5];</span><br><span class="line">	subNavigationController.navigationBarHidden = YES;</span><br><span class="line">	[self.navigationController presentViewController:subNavigationController animated:YES completion:nil]; // 这里 present 的是 subNavigationController。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><h5 id="Modal-Dismiss"><a href="#Modal-Dismiss" class="headerlink" title="Modal-Dismiss"></a>Modal-Dismiss</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">这种情况稍复杂，现在很多利用block回传待添加。</span><br><span class="line"></span><br><span class="line">在图中，绿色虚线反向的箭头就表示的是 Modal 的 Dismiss 动作，比如：VCM1-&gt;VCN2; VCM2-&gt;VCM1; VCM3-&gt;VCN6 等跳转。Dismiss 这个动作其实写起来是很简单的，但是想要往回传参通常就会复杂一点了，尤其是在不同的情况下。这里的关键点就在于搞清楚当前所在VC的 presentingViewController 这个属性到底指向着谁。</span><br><span class="line"></span><br><span class="line">也就是说，当前的VC1如果是被另一个VC2给Present出来的，那么VC1中self.presentingViewController就是VC2。如果当前的VC1不是被谁Present出来的，但是VC1的某个祖先VC是被另一个VC给Present出来的，那么VC1中self.presentingViewController就是Present当前这个VC1的最近的祖先的那个VC。</span><br><span class="line"></span><br><span class="line">那么下面，我们就根据self.presentingViewController这个属性含义，结合我们图中的几种情况做一下具体的说明：</span><br><span class="line"></span><br><span class="line">1）Navigation页面流中的某个页面Present一个Modal的页面后Dismiss</span><br><span class="line">在 VCM1-&gt;VCN2 这种情况下，在VCM1中，self.presentingViewController是谁呢？一般，我们会认为是 VCN2，但事实上不是VCN2 而是 MainNavigationVC，这是很容易弄错的地方。所以这里想要传参回去的话，就要去 MainNavigationVC 的 viewContollers 栈中找到 VCN2，设置其参数属性。这里就要提到我们在上面介绍 Modal-Present 的时候提到的 VCN2-&gt;VCM1 的跳转代码，在那段代码里我们是用 self.navigationController present...，其实这里不管用 self.navigationController present... 还是用 self present...，到VCM1后，VCM1的presentingViewController都是MainNavigationVC，所以我们选择写清楚点，用前者。</span><br><span class="line"></span><br><span class="line">2）一个Modal的页面Present另一个Modal的页面后Dismiss</span><br><span class="line">在 VCM2-&gt;VCM1 这种情况下，VCM1是被VCM2Present出来的，所以VCM2 的 presentingViewController 就是 VCM1，所以跳转代码如下：</span><br><span class="line"></span><br><span class="line">// 在 VCM2.m 中</span><br><span class="line">-(void) back:(id)sender &#123;</span><br><span class="line">	if ([self.presentingViewController isKindOfClass:[VCM1 class]]) &#123;</span><br><span class="line">		VCM1* vcm1 = (VCM1*) [self.presentingViewController isKindOfClass:[VCM1 class]];</span><br><span class="line">		vcm1.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">	&#125;</span><br><span class="line">	[self.presentingViewController dismissViewControllerAnimated:YES completion:nil];</span><br><span class="line">&#125;</span><br><span class="line">如果我们Present了多层的Modal式VC，而我们想直接跳跃式地Dismiss返回，比如：VCM4-&gt;VCM1 这种情况，VCM4 的 presentingViewController 是 VCM2，而 VCM2 的 presentingViewController 是 VCM1，所以 VCM4-&gt;VCM1 的跳转代码：</span><br><span class="line"></span><br><span class="line">// 在 VCM4.m 中</span><br><span class="line">-(void) backToVCM1:(id)sender &#123;</span><br><span class="line">	if ([self.presentingViewController.presentingViewController isKindOfClass:[VCM1 class]]) &#123;</span><br><span class="line">		VCM1* vcm1 = (VCM1*) [self.presentingViewController.presentingViewController isKindOfClass:[VCM1 class]];</span><br><span class="line">		vcm1.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">	&#125;</span><br><span class="line">	[self.presentingViewController.presentingViewController dismissViewControllerAnimated:YES completion:nil];</span><br><span class="line">&#125;</span><br><span class="line">这样写其实是比较不美观的，尤其是当层次更多更深的时候，如果真有那种情况，那就建议把多层次的Modal式页面流直接改成Navigation式管理更好。</span><br><span class="line"></span><br><span class="line">3）一个Navigation页面流中的某个页面Present另一个Navigation页面流后Dismiss</span><br><span class="line">在 SubNavigationVC.VCN5-&gt;VCN4 的情况下，VCN5 其实不是被谁Present出来的，但是它的父VC(self.parentViewController)是SubNavigationVC，而SubNavigationVC是被MainNavigationVC给Prsent出来的，所以VCN5的presentingViewController就是MainNavigationVC。</span><br><span class="line"></span><br><span class="line">SubNavigationVC.VCN5-&gt;VCN4 的跳转代码：</span><br><span class="line"></span><br><span class="line">// 在 VCN5.m 中</span><br><span class="line">-(void) back:(id)sender &#123;</span><br><span class="line">	// self.presentingViewController是MainNavigationVC</span><br><span class="line">	if ([self.presentingViewController isKindOfClass:[UINavigationController class]]) &#123;</span><br><span class="line">    	UINavigationController* mainNavigationController = (UINavigationController*) self.presentingViewController;</span><br><span class="line">    	if ([[mainNavigationController.viewControllers lastObject] isKindOfClass:[VCN4 class]]) &#123;</span><br><span class="line">        	VCN4* vcn4 = (VCN4*) [mainNavigationController.viewControllers lastObject];</span><br><span class="line">        	vcn4.stringPara = @&quot;value&quot;; // 传参</span><br><span class="line">    	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	[self.presentingViewController dismissViewControllerAnimated:YES completion:nil];</span><br><span class="line">&#125;</span><br><span class="line">其实所有由SubNavigationVC管理的这些VC(包括VCN5，VCN6，VCN7，VCN8)的presentingViewController都是MainNavigationVC。所以我们可以直接从这些VC中任意一个直接跳到MainNavigationVC的栈顶的VCN4页面。</span><br></pre></td></tr></table></figure>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">===Navigation方式+Modal方式 的页面流逻辑其实已经能够满足我们大多时候的使用场景，如果你发现仍然不能满足，那建议首先考虑考虑项目的视图流的设计是不是合理。</span><br><span class="line">Navigation式的跳转只要牢牢盯住所在 VC 的 self.navigationController，理解其像栈一样管理页面流的方式，然后好好使用 self.navigationController.viewControllers 这个 VC栈 就好了。</span><br><span class="line">Modal式的跳转只要牢牢盯住所在 VC 的 self.presentingViewController 就好了，一定要搞清楚它是哪个，这里是很容易弄混而造成代码逻辑错误的。从Navigation页面流Present出来的Modal页面，这个Modal页面的presentingViewController是对应的的UINavigationController，而不是其中的那个具体的页面。</span><br><span class="line"></span><br><span class="line">===关于基于Storyboard来实现页面跳转和传参的方式多是基于Segue来实现的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===DismissViewController</span><br><span class="line">这个是控制页面消失的方法，调用方法当前页面消失，适用于presentViewController的反操作。需求是连续dismiss两次回到最开始的页面。方法：[self dismissViewControllerAnimated:YES completion:^&#123;[self.navigationController popViewControllerAnimated:NO]&#125;];在回调的逻辑中填写你自己需要的跳转方法就可以了</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">====页面PopViewController的回退调用block</span><br><span class="line">这种回调的block是跟随着动画的，在uitableView中实验了，对于重新加载数据不好用，但是对于一般的回退，很有用[CATransaction begin];[CATransaction setCompletionBlock:^&#123;    // handle completion here&#125;];</span><br><span class="line">[self.navigationController popViewControllerAnimated:YES];</span><br><span class="line">[CATransaction commit];</span><br><span class="line"></span><br><span class="line">自己研究的方法是，在pop之前给一个全局变量赋值，然后在新的页面viewWillAppear()中，进行判断然后书写相应逻辑进行刷新等操作。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===StoryBoard使用segue页面间传递数据:</span><br><span class="line"></span><br><span class="line">- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    if ([segue.identifier isEqualToString:@&quot;SubLevelSegue&quot;]) &#123;</span><br><span class="line">        SubLevelViewController *mySubLevelViewController = segue.destinationViewController;</span><br><span class="line">        UITableViewCell *cell = sender;</span><br><span class="line">        mySubLevelViewController.title = cell.textLabel.text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender &#123;     UIViewController *destination = segue.destinationViewController;       if ([destination respondsToSelector:@selector(setDelegate:)]) &#123;            [destination setValue:self forKey:@&quot;delegate&quot;];        &#125;        if ([destination respondsToSelector:@selector(setSelection:)]) &#123;            // prepare selection info          NSIndexPath *indexPath = [self.tableView indexPathForCell:sender];                   id object = self.tasks[indexPath.row];                NSDictionary *selection = @&#123;   @&quot;indexPath&quot; : indexPath,   @&quot;object&quot; : object&#125;;            [destination setValue:selection forKey:@&quot;selection&quot;];    &#125; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===iOS PresentViewControlle后,直接返回根视图</span><br><span class="line">在开发中：用[self presentViewController:VC animated:YES completion:nil];实现跳转，多次跳转后，直接返回第一个。</span><br><span class="line">例如：</span><br><span class="line">A presentViewController B</span><br><span class="line">B presentViewController C</span><br><span class="line">C 直接回到A：</span><br><span class="line"> </span><br><span class="line">返回第一个视图核心代码如下：</span><br><span class="line">[self.presentingViewController.presentingViewController dismissViewControllerAnimated:YES completion:nil];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===关于几种逆向传值的方法接下来会补充：</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/06/iOS开发中的几种设计模式/" itemprop="url">
                  iOS开发中的几种设计模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-06T11:48:22+08:00" content="2016-06-06">
              2016-06-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>收录几种常见设计模式的使用方法</p>
</blockquote>
<h2 id="单例"><a href="#单例" class="headerlink" title="单例"></a>单例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">单例就是全局都只有一个对象存在，而且是在整个App运行过程中都存在。每个App都会有单例，比如UIApplication。而我们在做用户数据存储时，通常都会用单例存储，因为应用在所有操作中，经常要求先登录。</span><br><span class="line"></span><br><span class="line">单例模式的要点：</span><br><span class="line">一是某个类只能有一个实例；二是它必须自行创建这个实例；三是它必须自行向整个系统提供这个实例。</span><br><span class="line"></span><br><span class="line">下面这种写法是最常用的写法，这个是线程安全的。 </span><br><span class="line">dispach_once函数中的代码块只会被执行一次。+(SchoolManager *)sharedInstance  </span><br><span class="line">&#123;  </span><br><span class="line">    static SchoolManager *sharedManager;  </span><br><span class="line">      </span><br><span class="line">    static dispatch_once_t onceToken;  </span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;  </span><br><span class="line">        sharedManager = [[SchoolManager alloc] init];  </span><br><span class="line">    &#125;);  </span><br><span class="line">      </span><br><span class="line">    return sharedManager;  </span><br><span class="line">&#125;  </span><br><span class="line">获取实例：SchoolManager *schoolManager = [SchoolManager sharedInstance];  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===单例模式的实现：</span><br><span class="line">代码示例：</span><br><span class="line">MySingletonClass.h</span><br><span class="line"></span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line">@interface MySingletonClass : NSObject//单例方法</span><br><span class="line">+(MySingletonClass *)sharedInstance;</span><br><span class="line">@end</span><br><span class="line">MySingletonClass.m</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">#import &quot;MySingletonClass.h&quot;</span><br><span class="line">@implementation MySingletonClass</span><br><span class="line">//1、为单例对象实现一个静态实例，并初始化，然后设置成nil，static MySingletonClass *manager = nil;</span><br><span class="line">//2、实现一个实例构造方法检查上面声明的静态实例是否为nil，如果是则新建并返回一个本类的实例，+(MySingletonClass *)sharedInstance&#123;        @synchronized(self) &#123;        if(manager == nil) &#123;            manager = [[MySingletonClass  alloc] init]; //   assignment   not   done   here        &#125;    &#125;    return manager;&#125;</span><br><span class="line">//3、重写allocWithZone方法，用来保证其他人直接使用alloc和init试图获得一个新实力的时候不产生一个新实例，+(id)allocWithZone:(NSZone *)zone&#123;    @synchronized(self)&#123;                if (!manager) &#123;                        manager = [super allocWithZone:zone]; //确保使用同一块内存地址                        return manager;                    &#125;                return nil;    &#125;&#125;</span><br><span class="line">//4、适当实现copyWithZone，release和autorelease。- (id)init;&#123;    @synchronized(self) &#123;                if (self = [super init])&#123;                        return self;        &#125;                return nil;    &#125;&#125;</span><br><span class="line">//确保copy对象也是唯一- (id)copyWithZone:(NSZone *)zone;&#123;        return self;    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="委托模式"><a href="#委托模式" class="headerlink" title="委托模式"></a>委托模式</h3><p>转载自 :<a href="http://www.samirchen.com/ios-delegate/" target="_blank" rel="external">这里</a></p>
<ul>
<li>介绍：delegation，委托模式，是简单的强大的模式，可让一个对象扮演另外对象的行为。委托对象保持到另外对象的引用，并在适当的时候发消息给另外对象。委托对象可以在发送消息的时候做一些额外的事情。<br>在cocoa框架中的委托模式，委托对象往往是框架中的对象，被委托对象是自定义的controller对象。委托对象保持一个到被委托对象的弱引用。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">示例：</span><br><span class="line"></span><br><span class="line">2.1）代码：CPPropOperationView.h</span><br><span class="line"></span><br><span class="line">在这里定义了 CPPropOperationViewDelegate，它有两个 required 的方法 refreshPropOperationView: 和 closePropOperationView: ，所有实现这个 CPPropOperationViewDelegate 的类需要去实现这两个方法。</span><br><span class="line"></span><br><span class="line">接着，声明了 CPPropOperationView 这个类的一些属性，其中包括 id delegate。</span><br><span class="line"></span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"> </span><br><span class="line">#pragma mark - delegate</span><br><span class="line">@protocol CPPropOperationViewDelegate &lt;NSObject&gt;</span><br><span class="line">@required</span><br><span class="line">-(void) refreshPropOperationView:(id)sender;</span><br><span class="line">-(void) closePropOperationView:(id)sender; </span><br><span class="line">@end</span><br><span class="line"> </span><br><span class="line">#pragma mark - class</span><br><span class="line">@interface CPPropOperationView : UIView &#123;</span><br><span class="line">&#125;</span><br><span class="line">@property (nonatomic, assign) id&lt;CPPropOperationViewDelegate&gt; delegate;</span><br><span class="line">@property (nonatomic, retain) UIImageView* backgroundImageView;</span><br><span class="line">@property (nonatomic, retain) UIButton* refreshBtn;</span><br><span class="line">@property (nonatomic, retain) UIButton* closeBtn;</span><br><span class="line">@end</span><br><span class="line">2.2）代码：CPPropOperationView.m</span><br><span class="line"></span><br><span class="line">这里是对 CPPropOperationView 页面元素的一些实现代码。可以看到，我们在给 CPPropOperationView 的两个按钮 refreshBtn 和 closeBtn 绑定方法的时候，addTarget: 的对象是 delegate，这说明我们将用代理调用这些按钮对应的方法。</span><br><span class="line"></span><br><span class="line">#import &quot;CPPropOperationView.h&quot;</span><br><span class="line"> </span><br><span class="line">@implementation CPPropOperationView</span><br><span class="line">@synthesize delegate;</span><br><span class="line">@synthesize backgroundImageView = _backgroundImageView;</span><br><span class="line">@synthesize refreshBtn = _refreshBtn;</span><br><span class="line">@synthesize closeBtn = _closeBtn;</span><br><span class="line"> </span><br><span class="line">#pragma mark - View Life Cycle</span><br><span class="line">- (id)initWithFrame:(CGRect)frame &#123;</span><br><span class="line">    self = [super initWithFrame:frame];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        // Initialization code       </span><br><span class="line">        </span><br><span class="line">        // background image.</span><br><span class="line">        self.backgroundImageView = [[[UIImageView alloc] initWithImage:[UIImage imageNamed:@&quot;bg.png&quot;]] autorelease];</span><br><span class="line">        [self.backgroundImageView setFrame:CGRectMake(0, 0, frame.size.width, frame.size.height)];</span><br><span class="line">        [self addSubview:self.backgroundImageView];</span><br><span class="line">         </span><br><span class="line">        // Refresh button. Bind to delegate&apos;s refreshPropOperationView:.</span><br><span class="line">        self.refreshBtn = [UIButton buttonWithType:UIButtonTypeCustom];</span><br><span class="line">        [self.refreshBtn setFrame:CGRectMake(0, 0, 225, 45)];</span><br><span class="line">        [self.refreshBtn setTitle:@&quot;Refresh 0&quot; forState:UIControlStateNormal];</span><br><span class="line">        [self.refreshBtn addTarget:delegate action:@selector(refreshPropOperationView:) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">        [self addSubview:self.refreshBtn];</span><br><span class="line">        </span><br><span class="line">        // Prop close button. Bind to delegate&apos;s closePropOperationView:.</span><br><span class="line">        self.closeBtn = [UIButton buttonWithType:UIButtonTypeCustom];</span><br><span class="line">        [self.closeBtn setFrame:CGRectMake(0, 100, 45, 45)];</span><br><span class="line">        [self.closeBtn setImage:[UIImage imageNamed:@&quot;close.png&quot;] forState:UIControlStateNormal];</span><br><span class="line">        [self.closeBtn addTarget:delegate action:@selector(closePropOperationView:) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">        [self addSubview:self.closeBtn];</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">-(void) dealloc &#123;</span><br><span class="line">    [_backgroundImageView release];</span><br><span class="line">    [_refreshBtn release];</span><br><span class="line">    [_closeBtn release];</span><br><span class="line">    </span><br><span class="line">    [super dealloc];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@end</span><br><span class="line">2.3）代码：StoreViewCtrler.h StoreViewCtrler 拥有 CPPropOperationView 的实例，并实现 CPPropOperationViewDelegate。</span><br><span class="line"></span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line">#import &quot;CPPropOperationView.h&quot;</span><br><span class="line"> </span><br><span class="line">@interface StoreViewCtrler : UIViewController &lt;CPPropOperationViewDelegate&gt; &#123;</span><br><span class="line">&#125;</span><br><span class="line">@property (nonatomic, retain) CPPropOperationView* propOperationView;</span><br><span class="line">@end</span><br><span class="line">2.4）代码：StoreViewCtrler.m</span><br><span class="line"></span><br><span class="line">在这里，实现了 CPPropOperationViewDelegate 的 refreshPropOperationView: 和 closePropOperationView: 这两个方法。并通过 self.propOperationView.delegate = self; 将代理设为自己。那么点击 self.propOperationView 的 refreshBtn 和 closeBtn 将分别调用这里实现的 refreshPropOperationView: 和 closePropOperationView: 这两个方法。</span><br><span class="line"></span><br><span class="line">#import &quot;StoreViewCtrler.h&quot;</span><br><span class="line">#import &quot;CPPropOperationView.h&quot;</span><br><span class="line"> </span><br><span class="line">@implementation StoreViewCtrler</span><br><span class="line">@synthesize magiboxOperationView;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">#pragma mark - CPPropOperationViewDelegate </span><br><span class="line">-(void) refreshPropOperationView:(id)sender &#123; </span><br><span class="line">     self.backgroundImageView.image = [UIImage imageNamed:@&quot;bg2.png&quot;];</span><br><span class="line">     [self.propOperationView.refreshBtn setTitle:[NSString stringWithFormat:@&quot;Refresh 1&quot;] forState:UIControlStateNormal]; </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">-(void) closePropOperationView:(id)sender &#123;</span><br><span class="line">     self.propOperationView.hidden = YES;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">#pragma mark - View lifecycle </span><br><span class="line">-(void) viewWillAppear:(BOOL)animated &#123;</span><br><span class="line">    [super viewWillAppear:animated];</span><br><span class="line">     </span><br><span class="line">    if (self.propOperationView == nil) &#123;</span><br><span class="line">        self.propOperationView = [[[CPPropOperationView alloc] initWithFrame:CGRectMake(0, 0, 300, 300)] autorelease];</span><br><span class="line">        self.propOperationView.delegate = self;</span><br><span class="line">        [self.view addSubview:self.propOperationView];</span><br><span class="line">    &#125;</span><br><span class="line">    self.propOperationView.hidden = NO;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">- (void)viewDidUnload &#123;</span><br><span class="line">    [super viewDidUnload];</span><br><span class="line">    </span><br><span class="line">    // Release any retained subviews of the main view.</span><br><span class="line">    self.magiboxOperationView = nil;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">-(void) dealloc &#123;</span><br><span class="line">    [magiboxOperationView release];</span><br><span class="line">    </span><br><span class="line">    [super dealloc];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/31/UITableView的使用/" itemprop="url">
                  UITableView的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-31T10:19:25+08:00" content="2016-05-31">
              2016-05-31
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>UITableView是使用最多的UI控件之一，非常重要，以下内容来自网上一些优秀文章的摘录和自己日常使用中的心得。</p>
</blockquote>
<hr>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><blockquote>
<p>UITableView继承自UIScrollView，基本配置主要是通过两个协议，UITableViewDataSource（提供显示用的数据）和UITableViewDelegate（用来控制tableview的选择section的头和尾的显示），有两种风格Plain和Grouped。UITableView中显示的每一个单元都是一个UITableViewCell对象在tableView快速滑动的滑动的过程中，频繁的alloc对象是比较费时的，于是引入了cell的重用机制。简单的理解就是：UITableView只会创建一屏幕（或一屏幕多一点）的UITableViewCell，其他都是从中取出来重用的。每当Cell滑出屏幕时，就会放入到一个集合（或数组）中（这里就相当于一个重用池），当要显示某一位置的Cell时，会先去集合（或数组）中取，如果有，就直接拿来显示；如果没有，才会创建。这样做的好处可想而知，极大的减少了内存的开销。另外还有几点：<br>1、UITableView需要一个数据源(dataSource)来显示数据<br>2、UITableView会向数据源查询一共有多少行数据以及每一行显示什么数据等<br>3、没有设置数据源的UITableView只是个空壳<br>4、凡是遵守UITableViewDataSource协议的OC对象，都可以是UITableView的数据源</p>
</blockquote>
<h2 id="UITableView的常见属性"><a href="#UITableView的常见属性" class="headerlink" title="UITableView的常见属性"></a>UITableView的常见属性</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">/* tableView的样式 */</span><br><span class="line">@property (nonatomic, readonly) UITableViewStyle style;</span><br><span class="line">// tableView有两种样式</span><br><span class="line">//     UITableViewStylePlain  普通的表格样式</span><br><span class="line">//    UITableViewStyleGrouped  分组模式</span><br><span class="line"></span><br><span class="line">/* tableView的数据源 */</span><br><span class="line">@property (nonatomic, weak, nullable) id &lt;UITableViewDataSource&gt; dataSource;</span><br><span class="line">/* tableView的代理 */</span><br><span class="line">@property (nonatomic, weak, nullable) id &lt;UITableViewDelegate&gt; delegate;</span><br><span class="line"></span><br><span class="line">#pragma mark - 高度相关</span><br><span class="line">/* tableView每一行的高度，默认为44 */</span><br><span class="line">@property (nonatomic) CGFloat rowHeight;</span><br><span class="line">/* tableView统一的每一组头部的高度 */</span><br><span class="line">@property (nonatomic) CGFloat sectionHeaderHeight;</span><br><span class="line">/* tableView统一的每一组头部的高度 */</span><br><span class="line">@property (nonatomic) CGFloat sectionFooterHeight;</span><br><span class="line">/* 估算的tableView的统一的每一行行高 */</span><br><span class="line">@property (nonatomic) CGFloat estimatedRowHeight;</span><br><span class="line">/* 估算的统一的每一组头部高度，设置估算高度可以优化性能 */</span><br><span class="line">@property (nonatomic) CGFloat estimatedSectionHeaderHeight;</span><br><span class="line">/* 估算的统一的每一组的尾部高度 */</span><br><span class="line">@property (nonatomic) CGFloat estimatedSectionFooterHeight;</span><br><span class="line"></span><br><span class="line">/* 总共有多少组 */</span><br><span class="line">@property (nonatomic, readonly) NSInteger numberOfSections;</span><br><span class="line">/* 选中行的indexPath */</span><br><span class="line">@property (nonatomic, readonly, nullable) NSIndexPath *indexPathForSelectedRow;</span><br><span class="line"></span><br><span class="line">#pragma mark - 索引条</span><br><span class="line">/* 索引条文字的颜色 */</span><br><span class="line">@property (nonatomic, strong, nullable) UIColor *sectionIndexColor;</span><br><span class="line">/* 索引条的背景色 */</span><br><span class="line">@property (nonatomic, strong, nullable) UIColor *sectionIndexBackgroundColor;</span><br><span class="line"></span><br><span class="line">#pragma mark - 分隔线</span><br><span class="line">/* 分隔线的样式 */</span><br><span class="line">@property (nonatomic) UITableViewCellSeparatorStyle separatorStyle;</span><br><span class="line">// 分隔线的样式有：</span><br><span class="line">// UITableViewCellSeparatorStyleNone,  没有分隔线</span><br><span class="line">// UITableViewCellSeparatorStyleSingleLine, 正常分隔线</span><br><span class="line">/*  分隔线的颜色 */</span><br><span class="line">@property (nonatomic, strong, nullable) UIColor *separatorColor; </span><br><span class="line"></span><br><span class="line">#pragma mark - 头尾部控件</span><br><span class="line">/* tableView的头部控件，只能设置高度，宽度默认填充表格 */</span><br><span class="line">@property (nonatomic, strong, nullable) UIView *tableHeaderView;</span><br><span class="line">/* tableView的尾部控件，只能设置高度，宽度默认填充表格*/</span><br><span class="line">@property (nonatomic, strong, nullable) UIView *tableFooterView;</span><br><span class="line"></span><br><span class="line">#pragma mark - 编辑模式</span><br><span class="line">/* 是否是编辑模式，默认是NO */</span><br><span class="line">@property (nonatomic, getter=isEditing) BOOL editing;</span><br><span class="line">/* tableView处在编辑模式的时候是否允许选中行，默认是NO */</span><br><span class="line">@property (nonatomic) BOOL allowsSelectionDuringEditing;</span><br><span class="line">/* tableView处在编辑模式的时候是否允许选中多行数据，默认是NO */</span><br><span class="line">@property (nonatomic) BOOL allowsMultipleSelectionDuringEditing;</span><br></pre></td></tr></table></figure>
<h2 id="UITableViewCell的常见属性"><a href="#UITableViewCell的常见属性" class="headerlink" title="UITableViewCell的常见属性"></a>UITableViewCell的常见属性</h2><h5 id="cell的重用原理"><a href="#cell的重用原理" class="headerlink" title="cell的重用原理"></a>cell的重用原理</h5><p>iOS设备的内存有限，如果用UITableView显示成千上万条数据，就需要成千上万个UITableViewCell对象的话，那将会耗尽iOS设备的内存。要解决该问题，需要重用UITableViewCell对象。</p>
<p>重用原理：当滚动列表时，部分UITableViewCell会移出窗口，UITableView会将窗口外的UITableViewCell放入一个缓存池中，等待重用。当UITableView要求dataSource返回UITableViewCell时，dataSource会先查看这个缓存池，如果池中有未使用的UITableViewCell，dataSource会用新的数据配置这个UITableViewCell，然后返回给UITableView，重新显示到窗口中，从而避免创建新对象。</p>
<p>还有一个非常重要的问题：有时候需要自定义UITableViewCell(用一个子类继承UITableViewCell)，而且每一行用的不一定是同一种UITableViewCell，所以一个UITableView可能拥有不同类型的UITableViewCell，缓存池中也会有很多不同类型的UITableViewCell，那么UITableView在重用UITableViewCell时可能会得到错误类型的UITableViewCell。</p>
<p>解决方案：UITableViewCell有个NSString *reuseIdentifier属性，可以在初始化UITableViewCell的时候传入一个特定的字符串标识来设置reuseIdentifier(一般用UITableViewCell的类名)。当UITableView要求dataSource返回UITableViewCell时，先通过一个字符串标识到缓存池中查找对应类型的UITableViewCell对象，如果有，就重用，如果没有，就传入这个字符串标识来初始化一个UITableViewCell对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - Cell内部子控件</span><br><span class="line">/*  默认为nil，imageView是懒加载，用到时才加载 */</span><br><span class="line">@property (nonatomic, readonly, strong, nullable) UIImageView *imageView;</span><br><span class="line">/* 默认为nil，是懒加载，用到时才加载 */</span><br><span class="line">@property (nonatomic, readonly, strong, nullable) UILabel *textLabel;</span><br><span class="line">/* 只有当Cell的样式为UITableViewCellStyleSubtitle时才会显示出来，默认为nil，是懒加载，用到时才加载 */</span><br><span class="line">@property (nonatomic, readonly, strong, nullable) UILabel *detailTextLabel;</span><br><span class="line"></span><br><span class="line">/* 当你想要自定义一个cell的时候，子控件最好添加到cell的contentView上，方便编辑表格 */</span><br><span class="line">@property (nonatomic, readonly, strong) UIView *contentView;</span><br><span class="line"></span><br><span class="line">/* cell的复用标识 */</span><br><span class="line">@property (nonatomic, readonly, copy, nullable) NSString *reuseIdentifier;</span><br><span class="line"></span><br><span class="line">/* cell的选中样式 */</span><br><span class="line">@property (nonatomic) UITableViewCellSelectionStyle   selectionStyle;</span><br><span class="line">/* cell是否是选中状态 */</span><br><span class="line">@property (nonatomic, getter=isSelected) BOOL  selected;</span><br><span class="line"></span><br><span class="line">/* cell的编辑样式，默认是UITableViewCellEditingStyleNone */</span><br><span class="line">@property (nonatomic, readonly) UITableViewCellEditingStyle editingStyle;</span><br><span class="line">// cell的编辑样式有：</span><br><span class="line">// UITableViewCellEditingStyleNone,</span><br><span class="line">// UITableViewCellEditingStyleDelete, 删除模式</span><br><span class="line">// UITableViewCellEditingStyleInsert   插入模式</span><br><span class="line"></span><br><span class="line">/* 指示器的样式，默认是UITableViewCellAccessoryNone */</span><br><span class="line">@property (nonatomic) UITableViewCellAccessoryType accessoryType;</span><br><span class="line">// 指示器的样式有：</span><br><span class="line">// UITableViewCellAccessoryNone   不显示指示器</span><br><span class="line">// UITableViewCellAccessoryDisclosureIndicator cell右侧显示一个箭头</span><br><span class="line">// UITableViewCellAccessoryDetailDisclosureButton cell右侧显示一个箭头和一个详情图标</span><br><span class="line">// UITableViewCellAccessoryCheckmark cell右侧显示一个对勾</span><br><span class="line">// UITableViewCellAccessoryDetailButton cell右侧显示一个详情图标</span><br><span class="line"></span><br><span class="line">/* cell右侧指示器view，设置了以后，cell的accessoryType就会失效  */</span><br><span class="line">@property (nonatomic, strong, nullable) UIView *accessoryView;</span><br></pre></td></tr></table></figure>
<h2 id="UITableView的常用方法"><a href="#UITableView的常用方法" class="headerlink" title="UITableView的常用方法"></a>UITableView的常用方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">/* 全局刷新 */</span><br><span class="line">- (void)reloadData;</span><br><span class="line">/* 刷新索引条 */</span><br><span class="line">- (void)reloadSectionIndexTitles;</span><br><span class="line"></span><br><span class="line">/* 返回第section组有多少行 */</span><br><span class="line">- (NSInteger)numberOfRowsInSection:(NSInteger)section;</span><br><span class="line">/* 返回indexPath对应的那一行的cell */</span><br><span class="line">- (nullable __kindof UITableViewCell *)cellForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/* 返回第section组的头部view */</span><br><span class="line">- (nullable UITableViewHeaderFooterView *)headerViewForSection:(NSInteger)section;</span><br><span class="line">/* 返回第section组的尾部view */</span><br><span class="line">- (nullable UITableViewHeaderFooterView *)footerViewForSection:(NSInteger)section;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  插入数据,刷新数据</span><br><span class="line"> *  @param indexPaths 插入在哪个位置</span><br><span class="line"> *  @param animation  动画效果，枚举UITableViewRowAnimation</span><br><span class="line"> */</span><br><span class="line">- (void)insertRowsAtIndexPaths:(NSArray&lt;NSIndexPath *&gt; *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  删除数据</span><br><span class="line"> *  @param indexPaths 删除数据的位置</span><br><span class="line"> *  @param animation  动画效果，枚举UITableViewRowAnimation</span><br><span class="line"> */</span><br><span class="line">- (void)deleteRowsAtIndexPaths:(NSArray&lt;NSIndexPath *&gt; *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation;</span><br><span class="line">// 枚举UITableViewRowAnimation包括：</span><br><span class="line">// UITableViewRowAnimationFade,  淡入淡出</span><br><span class="line">// UITableViewRowAnimationRight,  向右滑动</span><br><span class="line">// UITableViewRowAnimationLeft,  向左滑动</span><br><span class="line">// UITableViewRowAnimationTop,  向上滑动</span><br><span class="line">// UITableViewRowAnimationBottom,  向下滑动</span><br><span class="line">// UITableViewRowAnimationNone,  无动画效果,iOS 3.0以后可用</span><br><span class="line">// UITableViewRowAnimationMiddle,  保持cell的中间，iOS 3.2以后可用</span><br><span class="line">// UITableViewRowAnimationAutomatic  自动选择一个合适的动画效果</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  刷新某一行的数据</span><br><span class="line"> *  @param indexPaths 刷新数据的位置</span><br><span class="line"> *  @param animation  动画效果，枚举UITableViewRowAnimation</span><br><span class="line"> */</span><br><span class="line">- (void)reloadRowsAtIndexPaths:(NSArray&lt;NSIndexPath *&gt; *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation;</span><br><span class="line"></span><br><span class="line">/** 动画开启/关闭编辑模式 */</span><br><span class="line">- (void)setEditing:(BOOL)editing animated:(BOOL)animated;</span><br><span class="line"></span><br><span class="line">/** 返回一个带有复用标识的cell */</span><br><span class="line">- (nullable __kindof UITableViewCell *)dequeueReusableCellWithIdentifier:(NSString *)identifier;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  使用xib时注册自定义的cell</span><br><span class="line"> *  @param nib        要注册的nib</span><br><span class="line"> *  @param identifier 复用标识</span><br><span class="line"> */</span><br><span class="line">- (void)registerNib:(nullable UINib *)nib forCellReuseIdentifier:(NSString *)identifier;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *   代码自定义cell时注册自定义的cell</span><br><span class="line"> *  @param cellClass  注册的自定义cell的类型</span><br><span class="line"> *  @param identifier 复用标识</span><br><span class="line"> */</span><br><span class="line">- (void)registerClass:(nullable Class)cellClass forCellReuseIdentifier:(NSString *)identifier;</span><br><span class="line"></span><br><span class="line">/** 初始化一个带有复用标识的cell */</span><br><span class="line">- (instancetype)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(nullable NSString *)reuseIdentifier</span><br></pre></td></tr></table></figure>
<h2 id="UITableViewDataSource中的常用方法"><a href="#UITableViewDataSource中的常用方法" class="headerlink" title="UITableViewDataSource中的常用方法"></a>UITableViewDataSource中的常用方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 必须实现的方法：</span><br><span class="line">/* 设置第section组有多少行数据 */</span><br><span class="line">- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section;</span><br><span class="line">/* 设置每一行cell的内容，每当有一个cell进入视野屏幕的时候就会调用这个方法，所以在这个方法内部进行优化（cell的复用） */</span><br><span class="line">- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">// 可实现可不实现的方法：</span><br><span class="line">/* 总共有多少组，如果不实现，默认是一组 */</span><br><span class="line">- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView;</span><br><span class="line"></span><br><span class="line">/* 第section组的头部标题 */</span><br><span class="line">- (nullable NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section;</span><br><span class="line">/* 第section组的尾部标题 */</span><br><span class="line">- (nullable NSString *)tableView:(UITableView *)tableView titleForFooterInSection:(NSInteger)section;</span><br><span class="line"></span><br><span class="line">/** 设置索引条 */</span><br><span class="line">- (nullable NSArray&lt;NSString *&gt; *)sectionIndexTitlesForTableView:(UITableView *)tableView;</span><br></pre></td></tr></table></figure>
<h2 id="UITableViewDelegate中的常用方法"><a href="#UITableViewDelegate中的常用方法" class="headerlink" title="UITableViewDelegate中的常用方法"></a>UITableViewDelegate中的常用方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">/** 设置每一行cell的高度 */</span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line">/** 设置第section组的头部高度 */</span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section;</span><br><span class="line">/** 设置第section组的尾部高度 */</span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section;</span><br><span class="line"></span><br><span class="line">/** 每一行的估算高度 */</span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView estimatedHeightForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/** 设置第section组的headerView */</span><br><span class="line">- (nullable UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section;</span><br><span class="line">/** 设置第section组的footerView */</span><br><span class="line">- (nullable UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section;</span><br><span class="line"></span><br><span class="line">/** 选中了某一行cell的时候就会调用这个方法 */</span><br><span class="line">- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  设置左滑删除按钮的文字</span><br><span class="line"> *  @param tableView         被编辑的tableView</span><br><span class="line"> *  @param indexPath         indexPath</span><br><span class="line"> *  @return 返回删除按钮显示的文字</span><br><span class="line"> */</span><br><span class="line">- (nullable NSString *)tableView:(UITableView *)tableView titleForDeleteConfirmationButtonForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  创建一个左滑出现按钮的操作（UITableViewRowAction）数组</span><br><span class="line"> *  @param tableView         添加操作的tableView</span><br><span class="line"> *  @param indexPath         indexPath，可以指定每一行有不同的效果</span><br><span class="line"> *  @return 返回一个操作（UITableViewRowAction）数组</span><br><span class="line"> */</span><br><span class="line">- (nullable NSArray&lt;UITableViewRowAction *&gt; *)tableView:(UITableView *)tableView editActionsForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  移动cell</span><br><span class="line"> *  @param tableView            操作的tableView</span><br><span class="line"> *  @param sourceIndexPath      移动的行</span><br><span class="line"> *  @param destinationIndexPath 目标行</span><br><span class="line"> */</span><br><span class="line">- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath;</span><br><span class="line"></span><br><span class="line">/** 根据editingStyle处理是删除还是添加操作，完成删除、插入操作刷新表格 */</span><br><span class="line">- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  设置表格编辑模式，不实现默认都是删除</span><br><span class="line"> *  @param tableView 操作的tableView</span><br><span class="line"> *  @param indexPath cell的位置</span><br><span class="line"> *  @return 返回表格编辑样式</span><br><span class="line"> */</span><br><span class="line">- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br></pre></td></tr></table></figure>
<h2 id="tableView展示数据的过程"><a href="#tableView展示数据的过程" class="headerlink" title="tableView展示数据的过程"></a>tableView展示数据的过程</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController ()&lt;UITableViewDataSource,UITableViewDelegate&gt;</span><br><span class="line"></span><br><span class="line">@property (weak, nonatomic) IBOutlet UITableView *tableView;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line"></span><br><span class="line">    self.tableView.dataSource = self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - UITableViewDataSource</span><br><span class="line">- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView&#123;</span><br><span class="line">    // 在这个方法中设置总共有多少组数据</span><br><span class="line">    // 这个方法如果不实现，默认是一组</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section&#123;</span><br><span class="line">    // 在这个方法中设置第section组有多行数据</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    // 1.定义一个cell的复用标识</span><br><span class="line">      static NSString *ID = @&quot;cell&quot;;</span><br><span class="line"></span><br><span class="line">    // 2.根据复用标识，从缓存池中取出带有同样的复用标识的cell</span><br><span class="line">      UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:ID];</span><br><span class="line"></span><br><span class="line">    // 3.如果缓存池中没有带有这种复用标识的cell，就创建一个带有这种复用标识的cell</span><br><span class="line">      if (cell == nil) &#123;</span><br><span class="line">        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:ID];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 4.设置cell的一些属性</span><br><span class="line"></span><br><span class="line">    return cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSString *)tableView:(UITableView *)tableView titleForFooterInSection:(NSInteger)section&#123;</span><br><span class="line">    // 在这个方法中设置第section组的尾部标题</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section&#123;</span><br><span class="line">    // 在这个方法中设置第section组的头部标题</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - UITableViewDelegate</span><br><span class="line"></span><br><span class="line">- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    // 当选中了某一行的时候就会调用这个方法，可以在这里进行一些操作</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="一些补充"><a href="#一些补充" class="headerlink" title="一些补充"></a>一些补充</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br></pre></td><td class="code"><pre><span class="line">更改Cell的背景</span><br><span class="line">UIView *myview = [[UIView alloc] init]; </span><br><span class="line">myview.frame = CGRectMake(0, 0, 320, 47); </span><br><span class="line">myview.backgroundColor = [UIColorcolorWithPatternImage:[UIImage imageNamed:@&quot;0006.png&quot;]]; </span><br><span class="line">cell.selectedBackgroundView = myview;</span><br><span class="line"></span><br><span class="line">更改Cell的标题</span><br><span class="line">cell.backgroundColor = [UIColorscrollViewTexturedBackgroundColor]; </span><br><span class="line">// 设置文字的字体  </span><br><span class="line">cell.textLabel.font = [UIFont fontWithName:@&quot;AmericanTypewriter&quot; size:100.0f]; </span><br><span class="line">// 设置文字的颜色  </span><br><span class="line">cell.textLabel.textColor = [UIColor orangeColor]; </span><br><span class="line">// 设置文字的背景颜色  </span><br><span class="line">cell.textLabel.shadowColor = [UIColor whiteColor]; </span><br><span class="line">// 设置文字的显示位置  </span><br><span class="line">cell.textLabel.textAlignment = UITextAlignmentCenter; </span><br><span class="line"></span><br><span class="line">默认选中某一行</span><br><span class="line"></span><br><span class="line">NSIndexPath *ip=[NSIndexPath indexPathForRow:0 inSection:2];  </span><br><span class="line">[tableView selectRowAtIndexPath:ip animated:YES scrollPosition:UITableViewScrollPositionBottom];  </span><br><span class="line"></span><br><span class="line">NSIndexPath *path=[NSIndexPath indexPathForItem:0 inSection:2];  </span><br><span class="line">[self tableView:tableView didSelectRowAtIndexPath:path];  </span><br><span class="line"></span><br><span class="line">手绘分割线：</span><br><span class="line"> if(indexPath.row&gt;0 &amp;&amp; indexPath.row&lt;=[self.basicData count])&#123;</span><br><span class="line">        self.tableView.separatorStyle=UITableViewCellSeparatorStyleNone;</span><br><span class="line">        UIView* separatorLineView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 0.5)];/// change size as you need.</span><br><span class="line">        separatorLineView.backgroundColor = [UIColor grayColor];// you can also put image here</span><br><span class="line">        [cell.contentView addSubview:separatorLineView];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">删除之前选中的行：</span><br><span class="line">- (void)viewWillAppear:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">	[super viewWillAppear:animated];</span><br><span class="line">	// this UIViewController is about to re-appear, make sure we remove the current selection in our table view</span><br><span class="line">	NSIndexPath *tableSelection = [self.tableView indexPathForSelectedRow];</span><br><span class="line">	[self.tableView deselectRowAtIndexPath:tableSelection animated:NO];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">多选：</span><br><span class="line">[uitableview本身就提供多选功能，选中的状态的管理不需要自己再维护。允许uitableivew多选设置一个属性就可以了,这时]:</span><br><span class="line">self.tableView.allowsMultipleSelectionDuringEditing=YES;</span><br><span class="line">[self.tableView setEditing:YES]; //////设置uitableview为编译状态</span><br><span class="line">//同时还有一个属性保存了你当前选择的indexPath集合</span><br><span class="line">NSArray *indexPaths =[self.tableView indexPathsForSelectedRows];</span><br><span class="line"></span><br><span class="line">重新设置uitableView的大小：</span><br><span class="line">- (void)viewDidAppear:(BOOL)animated&#123;    [self.tableView setFrame:CGRectMake(x, y, w, h)];&#125;</span><br><span class="line"></span><br><span class="line">隐藏多余的分割线:</span><br><span class="line">self.tableView.tableFooterView=[[UIView alloc] init]; // hide line</span><br><span class="line"></span><br><span class="line">动态添加行：</span><br><span class="line">dispatch_async(dispatch_get_main_queue(), ^&#123;  </span><br><span class="line">        self.dataSourceArray= a new Array.  </span><br><span class="line">        [self.tableView reloadData];  </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line">在一个UIview中添加UItableview：</span><br><span class="line">TODOTableViewController  *todo = [[TODOTableViewController alloc] init];</span><br><span class="line">    todo.view.autoresizingMask = UIViewAutoresizingNone;</span><br><span class="line">    [self addChildViewController:todo];</span><br><span class="line">    todo.view.frame = CGRectMake(0, 200, self.view.bounds.size.width, self.view.bounds.size.height);</span><br><span class="line">    [self.view addSubview:todo.view];</span><br><span class="line">    [todo didMoveToParentViewController:self];</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">点击行不变色：</span><br><span class="line">    cell.selectionStyle = UITableViewCellSelectionStyleNone;</span><br><span class="line">    </span><br><span class="line">实现UItableview的cell侧滑出现多个按钮：</span><br><span class="line">-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line">- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    return  UITableViewCellEditingStyleDelete;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">-(void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    if (editingStyle == UITableViewCellEditingStyleDelete) &#123;</span><br><span class="line">        [self.dataSource removeObjectAtIndex:indexPath.row];</span><br><span class="line">        [self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">- (NSArray *)tableView:(UITableView *)tableView editActionsForRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    //设置删除按钮</span><br><span class="line">      UITableViewRowAction *deleteRowAction = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDestructive title:@&quot;删除&quot;handler:^(UITableViewRowAction *action,NSIndexPath *indexPath) &#123;</span><br><span class="line">          [self.dataSource removeObjectAtIndex:indexPath.row];</span><br><span class="line">          [self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];</span><br><span class="line">      &#125;];</span><br><span class="line">    </span><br><span class="line">    //设置收藏按钮</span><br><span class="line">    UITableViewRowAction *collectRowAction = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDefault title:@&quot;收藏&quot;handler:^(UITableViewRowAction *action,NSIndexPath *indexPath) &#123;</span><br><span class="line">         collectRowAction.backgroundColor = [UIColor greenColor];</span><br><span class="line">         UIAlertView *alertView = [[UIAlertView alloc]initWithTitle:@&quot;收藏&quot; message:@&quot;收藏成功&quot; delegate:self cancelButtonTitle:@&quot;确定&quot;otherButtonTitles:nil, nil];</span><br><span class="line">         [alertView show];</span><br><span class="line">         &#125;];</span><br><span class="line">    //设置置顶按钮</span><br><span class="line">    UITableViewRowAction *topRowAction = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDefault title:@&quot;置顶&quot;handler:^(UITableViewRowAction *action, NSIndexPath *indexPath) &#123;</span><br><span class="line">         [self.dataSource exchangeObjectAtIndex:indexPath.row withObjectAtIndex:0];</span><br><span class="line">        NSIndexPath *firstIndexPath = [NSIndexPath indexPathForRow:0 inSection:indexPath.section];</span><br><span class="line">        [tableView moveRowAtIndexPath:indexPath toIndexPath:firstIndexPath];</span><br><span class="line">    &#125;];</span><br><span class="line">    collectRowAction.backgroundEffect = [UIBlurEffect effectWithStyle:UIBlurEffectStyleLight];</span><br><span class="line">    topRowAction.backgroundColor = [UIColor blueColor];</span><br><span class="line">    collectRowAction.backgroundColor = [UIColor grayColor]; </span><br><span class="line">    return  @[deleteRowAction,collectRowAction,topRowAction];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">行高：</span><br><span class="line">一种是针对所有 Cell 具有固定高度的情况，通过：</span><br><span class="line">self.tableView.rowHeight = 88;</span><br><span class="line">上面的代码指定了一个所有 cell 都是 88 高度的 UITableView，对于定高需求的表格，强烈建议使用这种</span><br><span class="line"></span><br><span class="line">自定义button右边箭头等标识：</span><br><span class="line">UIButton *actonButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];</span><br><span class="line">    [inactonButton setTitle:@&quot;活跃&quot;  forState:UIControlStateNormal];</span><br><span class="line">    [inactonButton setTintColor:[UIColor redColor]];</span><br><span class="line">    CGRect aframe = CGRectMake(0.0, 0.0, 30, 30);</span><br><span class="line">    inactonButton.frame=aframe;</span><br><span class="line">    cell.accessoryView=button;</span><br><span class="line">    可以自定义右边的显示图片，文字或图片可以通过设置button来设定</span><br><span class="line">    </span><br><span class="line">设置UItableview的imageview中image的大小:</span><br><span class="line">//1、首先对image付值</span><br><span class="line">cell.imageView.image=[UIImage imageNamed:@&quot;灰时间&quot;];</span><br><span class="line">//2、调整大小</span><br><span class="line">      CGSize itemSize = CGSizeMake(40, 40);      UIGraphicsBeginImageContextWithOptions(itemSize, NO, UIScreen.mainScreen.scale);      CGRect imageRect = CGRectMake(0.0, 0.0, itemSize.width, itemSize.height);      [cell.imageView.image drawInRect:imageRect];      cell.imageView.image = UIGraphicsGetImageFromCurrentImageContext();      UIGraphicsEndImageContext();     return cell;</span><br><span class="line">     </span><br><span class="line">UITableView  reloaddata:</span><br><span class="line"></span><br><span class="line">RIGHT WAY: </span><br><span class="line">Principle:  Always change dataSource in MAIN thread and call the reloadData immediately after it. </span><br><span class="line">Option 1: If the operation to change the dataSource should be executed in background, the operation can create a temp dataSource array and pass it to main thread with notification, the main thread observes the notification,  assign the tmpDataSource to dataSource and reload the tableView by reloadData.</span><br><span class="line"></span><br><span class="line">Option 2: In the background, call the GDC dispatch_async to send the two methods to main thread together.</span><br><span class="line">dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        self.dataSourceArray= a new Array.//   或删除当前列表的内容，从新加载[self.dataarray   removeAllObjects];</span><br><span class="line">             [self.tableView reloadData];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">设置搜索框:</span><br><span class="line">[_tableView setTableHeaderView:_searchBar];要记住在headerView中设置，否则会发生遮挡</span><br><span class="line"></span><br><span class="line">UItableview异步加载数据：</span><br><span class="line"></span><br><span class="line">用AFNetworking为TableView异步加载数据</span><br><span class="line">为了让APP有更好的用户体验，所以是不能阻塞主线程的，而RSS的获取和解析都需要一定的时间，所以需要异步地来处理这些工作，配上MBProgressHUD效果更好。</span><br><span class="line"></span><br><span class="line">@interface auditTableViewController ()&lt;MBProgressHUDDelegate&gt;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *bianHao;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *fakeData;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *userIdData;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *dataing;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *time;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *uid;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *searchResultsData;</span><br><span class="line">@property (strong, nonatomic) NSMutableDictionary *uAuditId;</span><br><span class="line">@property (strong, nonatomic) MBProgressHUD  *progress;</span><br><span class="line"></span><br><span class="line">@property (assign) NSInteger index;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation auditTableViewController</span><br><span class="line"></span><br><span class="line">-(void) getDataAsy:(NSString *)page &#123;</span><br><span class="line">    self.progress=[[MBProgressHUD alloc] initWithView:self.view];</span><br><span class="line">    self.progress.progress=0.4;</span><br><span class="line">    [self.view addSubview:self.progress];</span><br><span class="line">    self.progress.dimBackground=NO;</span><br><span class="line">    self.progress.labelText=@&quot;加载中，请稍后&quot;;</span><br><span class="line">    [self.progress show:YES];</span><br><span class="line">    AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];</span><br><span class="line">    manager.requestSerializer = [AFHTTPRequestSerializer serializer];</span><br><span class="line">    manager.responseSerializer = [AFHTTPResponseSerializer serializer];</span><br><span class="line">    NSString *sid = [[APPDELEGATE.sessionInfo objectForKey:@&quot;obj&quot;]objectForKey:@&quot;sid&quot;];</span><br><span class="line">    NSDictionary *parameters = @&#123;@&quot;MOBILE_SID&quot;:sid,</span><br><span class="line">                                 @&quot;page&quot;:page&#125;;</span><br><span class="line">    [manager POST:[SERVER_URL stringByAppendingString:@&quot;mJobSubmissionAction!renWuJBXXSHDatagrid.action?&quot;] parameters:parameters success:^(AFHTTPRequestOperation *operation, id responseObject) &#123;</span><br><span class="line">        NSString *result =  [[NSString alloc]initWithData:responseObject encoding:NSUTF8StringEncoding];</span><br><span class="line">        [self removeUnescapedCharacter:result];</span><br><span class="line">        NSDictionary *rececive = [NSJSONSerialization JSONObjectWithData:[[self removeUnescapedCharacter:result] dataUsingEncoding:NSUTF8StringEncoding] options:NSJSONReadingMutableContainers error:nil];</span><br><span class="line">        if([[rececive objectForKey:@&quot;success&quot;] boolValue] == YES)&#123;</span><br><span class="line">            NSArray *list = [rececive objectForKey:@&quot;obj&quot;];</span><br><span class="line">            for (int i = 0;i&lt;[list count];i++) &#123;</span><br><span class="line">                NSDictionary *listdic = [list objectAtIndex:i];</span><br><span class="line">                [self.uid addObject:listdic];</span><br><span class="line">                NSString *bianHao  = (NSString *)[listdic objectForKey:@&quot;bianHao&quot;];</span><br><span class="line">                NSString *teamname = (NSString *)[listdic objectForKey:@&quot;qiYeMC&quot;];</span><br><span class="line">                NSString *userId   = (NSString *)[listdic objectForKey:@&quot;yeWuZLMC_cn&quot;];</span><br><span class="line">                NSString *time     = (NSString *)[listdic objectForKey:@&quot;renWuTJSJStr&quot;];</span><br><span class="line">                [self.fakeData  addObject:teamname];</span><br><span class="line">                [self.time      addObject:time];</span><br><span class="line">                [self.dataing   addObject:userId];</span><br><span class="line">                [self.bianHao   addObject:bianHao];</span><br><span class="line">            &#125;</span><br><span class="line">            dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                [self.tableView reloadData];</span><br><span class="line">                [self.progress hide:YES];</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">             [self.progress hide:YES];</span><br><span class="line">            UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;网络连接超时&quot; message:@&quot;请检查网络，重新加载!&quot; delegate:self cancelButtonTitle:@&quot;OK&quot; otherButtonTitles: nil,nil];</span><br><span class="line">            [alert show];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; failure:^(AFHTTPRequestOperation *operation, NSError *error) &#123;</span><br><span class="line">        </span><br><span class="line">         [self.progress hide:YES];</span><br><span class="line">        NSLog(@&quot;%@&quot;,error);</span><br><span class="line">        UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;请求错误&quot; message:@&quot;请检查网络，重新加载!&quot; delegate:self cancelButtonTitle:@&quot;OK&quot; otherButtonTitles: nil,nil];</span><br><span class="line">        [alert show];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSMutableArray *)fakeData</span><br><span class="line">&#123;</span><br><span class="line">    if (!_fakeData) &#123;</span><br><span class="line">        self.bianHao=[[NSMutableArray alloc] init];</span><br><span class="line">        self.fakeData=[[NSMutableArray alloc] init];</span><br><span class="line">        self.dataing=[[NSMutableArray alloc] init];</span><br><span class="line">        self.time=[[NSMutableArray alloc] init];</span><br><span class="line">        self.uid=[[NSMutableArray alloc] init];</span><br><span class="line">        [self getDataAsy:@&quot;1&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">    return _fakeData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(void)viewWillAppear:(BOOL)animated&#123;</span><br><span class="line">    if([APPDELEGATE.paramForaudit isEqualToString:@&quot;fromAuditDetail&quot;])&#123;</span><br><span class="line">        APPDELEGATE.paramForaudit=@&quot;&quot;;//控制刷新，通过字段限定不是每个页面跳转回来都刷新页面</span><br><span class="line">        [self.fakeData removeAllObjects];</span><br><span class="line">        [self.bianHao  removeAllObjects];</span><br><span class="line">        [self.dataing  removeAllObjects];</span><br><span class="line">        [self.time     removeAllObjects];</span><br><span class="line">        [self.uid      removeAllObjects];</span><br><span class="line">        dispatch_async(dispatch_get_main_queue(),^&#123;</span><br><span class="line">            [self getDataAsy:@&quot;1&quot;];</span><br><span class="line">            [self.tableView reloadData];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">同上：</span><br><span class="line">- (void)loadFeed &#123;  AFHTTPRequestOperationManager *manager =      [AFHTTPRequestOperationManager manager];</span><br><span class="line">AFHTTPResponseSerializer *responseSerializer =      [AFHTTPResponseSerializer serializer];</span><br><span class="line">responseSerializer.acceptableContentTypes =      [NSSet setWithObjects:@&quot;application/atom+xml&quot;, nil];  manager.responseSerializer = responseSerializer;</span><br><span class="line">[manager GET:URL parameters:nil         success:^(AFHTTPRequestOperation *operation, id responseObject)&#123;      NSData *response = (NSData *)responseObject;      Feed *feed = [FeedParser parse:response];      self.feed = feed;</span><br><span class="line">     [self.tableView reloadData];    &#125;failure:  ^(AFHTTPRequestOperation * operation, NSError * error) &#123;    NSLog(@&quot;error: , %@&quot;, error);  &#125;];&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;  [super viewDidLoad];</span><br><span class="line">// Uncomment the following line to preserve selection between presentations.  // self.clearsSelectionOnViewWillAppear = NO;</span><br><span class="line">// Uncomment the following line to display an Edit button in the navigation  // bar for this view controller.  // self.navigationItem.rightBarButtonItem = self.editButtonItem;</span><br><span class="line">[self loadFeed];&#125;</span><br><span class="line"></span><br><span class="line">另外一种不阻塞主线程的方式:</span><br><span class="line">-(void)getDataForActivity&#123;</span><br><span class="line">    AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];</span><br><span class="line">    NSString *sid = [[APPDELEGATE.sessionInfo objectForKey:@&quot;obj&quot;]objectForKey:@&quot;sid&quot;];</span><br><span class="line">    NSDictionary *parameters = @&#123;@&quot;MOBILE_SID&quot;:sid,</span><br><span class="line">                                 @&quot;order&quot;:@&quot;desc&quot;,</span><br><span class="line">                                 @&quot;sort&quot; :@&quot;time&quot;&#125;;</span><br><span class="line">    [manager POST:[SERVER_URL stringByAppendingString:@&quot;mcustomerCallRecordsAction!mDatagrid1.action?&quot;] parameters:parameters success:^(AFHTTPRequestOperation *operation, id responseObject) &#123;</span><br><span class="line">        if([[responseObject objectForKey:@&quot;success&quot;] boolValue] == YES)&#123;</span><br><span class="line">            NSArray *list = [responseObject objectForKey:@&quot;obj&quot;];</span><br><span class="line">            for (int i = 0;i&lt;[list count];i++) &#123;</span><br><span class="line">                NSDictionary *listDic =[list objectAtIndex:i];</span><br><span class="line">                NSString *time = (NSString *)[listDic objectForKey:@&quot;timeStr&quot;];</span><br><span class="line">                if([time isEqualToString:self.date1])&#123;</span><br><span class="line">                    self.acitvityIndex1++;</span><br><span class="line">                &#125;else if([time isEqualToString:self.date2])&#123;</span><br><span class="line">                    self.acitvityIndex2++;</span><br><span class="line">                &#125;else if([time isEqualToString:self.date3])&#123;</span><br><span class="line">                    self.acitvityIndex3++;</span><br><span class="line">                &#125;else if([time isEqualToString:self.date4])&#123;</span><br><span class="line">                    self.acitvityIndex4++;</span><br><span class="line">                &#125;else if([time isEqualToString:self.date5])&#123;</span><br><span class="line">                    self.acitvityIndex5++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            NSString *data= [NSString stringWithFormat:@&quot;%d&quot;,self.acitvityIndex1];</span><br><span class="line">            [self performSelectorOnMainThread:@selector(setUpActivityUI) withObject:data waitUntilDone:YES];</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            [self setUpActivityUI];</span><br><span class="line">            UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;网络连接超时&quot; message:@&quot;请检查网络，重新加载!&quot; delegate:self cancelButtonTitle:@&quot;OK&quot; otherButtonTitles: nil,nil];</span><br><span class="line">            [alert show];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; failure:^(AFHTTPRequestOperation *operation, NSError *error) &#123;</span><br><span class="line">        UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;请求错误&quot; message:@&quot;请检查网络，重新加载!&quot; delegate:self cancelButtonTitle:@&quot;OK&quot; otherButtonTitles: nil,nil];</span><br><span class="line">        [alert show];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">上面是PNChart的调用画线，不阻塞主线程，当页面数据请求完毕时绘制，但是每次进入页面都会绘制，所以才去如下方法清空并重新绘制：</span><br><span class="line">-(void) viewWillAppear:(BOOL)animated&#123;</span><br><span class="line">    for(UIView *view in self.scrollView.subviews)&#123;</span><br><span class="line">        [view removeFromSuperview];</span><br><span class="line">    &#125;</span><br><span class="line">    self.acitvityIndex1=0;</span><br><span class="line">    self.acitvityIndex2=0;</span><br><span class="line">    self.acitvityIndex3=0;</span><br><span class="line">    self.acitvityIndex4=0;</span><br><span class="line">    self.acitvityIndex5=0;</span><br><span class="line">    self.telIndex1=0;</span><br><span class="line">    self.telIndex2=0;</span><br><span class="line">    self.telIndex3=0;</span><br><span class="line">    self.telIndex4=0;</span><br><span class="line">    self.telIndex5=0;</span><br><span class="line">    [self  setUpUI];</span><br><span class="line">    [self  DateForIn];</span><br><span class="line">    [self  getDataForActivity];</span><br><span class="line">    [self  getDataForTel];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">刷新当前行：</span><br><span class="line">[_tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];</span><br><span class="line"></span><br><span class="line">给UItableview添加动画：</span><br><span class="line">	</span><br><span class="line">	-(void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">	// 1. 配置CATransform3D的内容</span><br><span class="line">	CATransform3D transform;</span><br><span class="line">	transform = CATransform3DMakeRotation( (90.0*M_PI)/180, 0.0, 0.7, 0.4);</span><br><span class="line">	transform.m34 = 1.0/ -600;</span><br><span class="line">	// 2. 定义cell的初始状态</span><br><span class="line">	cell.layer.shadowColor = [[UIColor blackColor]CGColor];</span><br><span class="line">	cell.layer.shadowOffset = CGSizeMake(10, 10);</span><br><span class="line">	cell.alpha = 0;</span><br><span class="line">	cell.layer.transform = transform;</span><br><span class="line">	cell.layer.anchorPoint = CGPointMake(0, 0.5);</span><br><span class="line">	// 3. 定义cell的最终状态，并提交动画</span><br><span class="line">	[UIView beginAnimations:@&quot;transform&quot; context:NULL];</span><br><span class="line">	[UIView setAnimationDuration:0.5];</span><br><span class="line">	cell.layer.transform = CATransform3DIdentity;</span><br><span class="line">	cell.alpha = 1;</span><br><span class="line">	cell.layer.shadowOffset = CGSizeMake(0, 0);</span><br><span class="line">	cell.frame = CGRectMake(0, cell.frame.origin.y, cell.frame.size.width, cell.frame.size.height);</span><br><span class="line">	[UIView commitAnimations];</span><br><span class="line">	&#125;</span><br><span class="line">第一步：使用CATransform3D在Y和Z轴上做旋转设置。</span><br><span class="line">第二步：定义cell的初始状态，添加了一些阴影，并将第一步中的transform设置给cell中layer的transform matrix。然后将anchor设置为0.0, 0.5，也就是说让cell围绕着左边进行旋转。</span><br><span class="line">第三步：通过动画，将cell设置为原始状态。此处利用了UIView的beginAnimations:context方法来更新cell中layer的值。当然还有别的方法来执行动画，不过这种方法比较简单，我们可以设置持续时间。代码里面将transform设置为CATransform3DIdentity。</span><br><span class="line">这样通过第二步和第三步的状态就能够引导动画，以此完成最终效果。</span><br></pre></td></tr></table></figure>
<p>暂时就这么多吧，后续会更一下关于轻量化UItableview和自定义UItableview的内容，:-D</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/27/Foundation学习笔记/" itemprop="url">
                  Foundation学习笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-27T16:54:31+08:00" content="2016-05-27">
              2016-05-27
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>简介：Cocoa框架中包含众多子框架，Foundation是其中的重要框架，NSObject就在Foundation框架之中。</p>
</blockquote>
<h2 id="一-、常用结构体"><a href="#一-、常用结构体" class="headerlink" title="一 、常用结构体"></a>一 、常用结构体</h2><hr>
<ul>
<li><h5 id="NSRange-范围结构体，用来对对象进行范围操作。"><a href="#NSRange-范围结构体，用来对对象进行范围操作。" class="headerlink" title="NSRange:范围结构体，用来对对象进行范围操作。"></a>NSRange:范围结构体，用来对对象进行范围操作。</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    NSString *str = @&quot;123456789&quot;;  </span><br><span class="line"></span><br><span class="line">    NSRange r1 = [str rangeOfString:@&quot;9&quot;];  </span><br><span class="line">      </span><br><span class="line">    NSLog(@&quot;location = %ld, length = %ld&quot;, r1.location, r1.length);    </span><br><span class="line">&#125;</span><br><span class="line">结果：location = 8, length = 1  </span><br><span class="line"></span><br><span class="line">如果找不到相应字符串，返回的是NSNotFound, 而NSNotFound就是-1, 由于NSNotFound是unsignedlong类型, 所以打印出来是这么一大堆的数字 。</span><br><span class="line">调用输出语句输出NSNotFound，NSLog(@&quot;%d ---- %lu&quot;, NSNotFound, NSNotFound); </span><br><span class="line">结果：</span><br><span class="line">location = 9223372036854775807, length = 0  </span><br><span class="line"> -1 ---- 9223372036854775807</span><br></pre></td></tr></table></figure>
<ul>
<li><h5 id="NSPoint：表示一个点。"><a href="#NSPoint：表示一个点。" class="headerlink" title="NSPoint：表示一个点。"></a>NSPoint：表示一个点。</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    CGPoint p = NSMakePoint(1, 2);  </span><br><span class="line">      </span><br><span class="line">    NSPoint p1 = CGPointMake(10, 20); //开发中最长用的  </span><br><span class="line">  </span><br><span class="line">    NSLog(@&quot;px = %f, py = %f&quot;, p.x, p.y);  </span><br><span class="line">  </span><br><span class="line">    NSLog(@&quot;p1x = %f, p1y = %f&quot;, p1.x, p1.y);  </span><br><span class="line">       </span><br><span class="line">&#125;  </span><br><span class="line">结果： px = 1.000000, py = 2.000000  </span><br><span class="line">      p1x = 10.000000, p1y = 20.000000</span><br></pre></td></tr></table></figure>
<ul>
<li><h5 id="NSSize-表示宽高"><a href="#NSSize-表示宽高" class="headerlink" title="NSSize :表示宽高"></a>NSSize :表示宽高</h5>struct NSSize {<br>CGFloat width;<br>CGFloat height;<br>};  </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    NSSize size = &#123;10, 30&#125;;  </span><br><span class="line">      </span><br><span class="line">    CGSize size2 = NSMakeSize(100, 200);  </span><br><span class="line">      </span><br><span class="line">    NSSize s1 =  CGSizeMake(10, 30);  </span><br><span class="line">    NSSize s2 =  NSMakeSize(100, 200);  </span><br><span class="line">      </span><br><span class="line">    CGSize s3 = CGSizeMake(10, 30);  </span><br><span class="line">    CGSize s4 = NSMakeSize(100, 200);   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><h5 id="CGRect-用来表示一个矩形的位置和宽高"><a href="#CGRect-用来表示一个矩形的位置和宽高" class="headerlink" title="CGRect: 用来表示一个矩形的位置和宽高"></a>CGRect: 用来表示一个矩形的位置和宽高</h5></li>
</ul>
<p>struct CGRect {<br>  CGPoint origin;<br>  CGSize size;<br>};</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CGRect r1 = CGRectMake(10, 10, 50, 50);      </span><br><span class="line">CGRect r2 = &#123;&#123;0, 0&#125;, &#123;100, 100&#125;&#125;;  </span><br><span class="line">CGRect r3 = &#123;CGPointMake(0, 0), CGSizeMake(100, 100)&#125;;  </span><br><span class="line">NSLog(@&quot;r1 = %@&quot;, NSStringFromRect(r1));  </span><br><span class="line">NSLog(@&quot;r2 = %@&quot;, NSStringFromRect(r2));  </span><br><span class="line">NSLog(@&quot;r3 = %@&quot;, NSStringFromRect(r3));  </span><br><span class="line"></span><br><span class="line">r1 = &#123;&#123;10, 10&#125;, &#123;50, 50&#125;&#125;  </span><br><span class="line">r2 = &#123;&#123;0, 0&#125;, &#123;100, 100&#125;&#125;  </span><br><span class="line">r3 = &#123;&#123;0, 0&#125;, &#123;100, 100&#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="日期操作"><a href="#日期操作" class="headerlink" title="日期操作"></a>日期操作</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">//获得当前日期</span><br><span class="line">NSDate *date1=[NSDate date];</span><br><span class="line">NSLog(@&quot;%@&quot;,date1); //结果：2014-07-16 07:25:28 +0000</span><br><span class="line"></span><br><span class="line">//在当前日期的基础上加上100秒注意在ObjC中多数时间单位都是秒</span><br><span class="line">NSDate *date2=[NSDate dateWithTimeIntervalSinceNow:100];，</span><br><span class="line">NSLog(@&quot;%@&quot;,date2); //结果：2014-07-16 07:27:08 +0000</span><br><span class="line">//随机获取一个将来的日期</span><br><span class="line">NSDate *date3=[NSDate distantFuture];</span><br><span class="line">NSLog(@&quot;%@&quot;,date3); //结果：4001-01-01 00:00:00 +0000</span><br><span class="line"></span><br><span class="line">//日期之差,返回单位为秒</span><br><span class="line">NSTimeInterval time=[date2 timeIntervalSinceDate:date1];</span><br><span class="line">NSLog(@&quot;%f&quot;,time); //结果：100.008833</span><br><span class="line"></span><br><span class="line">//返回比较早的日期</span><br><span class="line">NSDate *date5=[date1 earlierDate:date3];</span><br><span class="line">NSLog(@&quot;%@&quot;,date5); //结果：2014-07-16 07:25:28 +0000</span><br><span class="line"></span><br><span class="line">//日期格式化</span><br><span class="line">//将日期时间转化为字符串</span><br><span class="line">// 实例化NSDateFormatter</span><br><span class="line">NSDateFormatter *formatter = [[NSDateFormatter alloc] init];</span><br><span class="line">// 设置日期格式</span><br><span class="line">[formatter setDateFormat:@&quot;yyyy-mm-dd HH:mm:ss&quot;];</span><br><span class="line">// 获取当前日期</span><br><span class="line">NSDate *currentDate = [NSDate date];</span><br><span class="line">NSString *currentDateString = [formatter stringFromDate:currentDate];</span><br><span class="line">NSLog(@&quot;%@&quot;, currentDateString);</span><br><span class="line"></span><br><span class="line">将时间字符串转换为日期</span><br><span class="line">NSDateFormatter *formatter = [[NSDateFormatter alloc] init];</span><br><span class="line">// 要转换的日期字符串</span><br><span class="line">NSString *dateString = @&quot;2011-05-03 23:11:40&quot;;</span><br><span class="line">// 设置为UTC时区</span><br><span class="line">// 这里如果不设置为UTC时区，会把要转换的时间字符串定为当前时区的时间（东八区）转换为UTC时区的时间</span><br><span class="line">NSTimeZone *timezone = [NSTimeZone timeZoneWithAbbreviation:@&quot;UTC&quot;];</span><br><span class="line">NSDate *someDay = [formatter dateFromString:dateString];</span><br><span class="line">NSLog(@&quot;%@&quot;, someDay);</span><br></pre></td></tr></table></figure>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><hr>
<ul>
<li><h5 id="不可变字符串"><a href="#不可变字符串" class="headerlink" title="不可变字符串"></a>不可变字符串</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"> NSString *str2=@&quot;OC string&quot;;//ObjC字符串需要加@，并且这种方式创建的对象不需要自己释放内存</span><br><span class="line"></span><br><span class="line">//下面的创建方法都应该释放内存</span><br><span class="line">NSString *str3=[[NSString alloc] init];</span><br><span class="line">str3=@&quot;OC string&quot;;</span><br><span class="line"></span><br><span class="line">NSString *str4=[[NSString alloc] initWithString:@&quot;Objective-C string&quot;];</span><br><span class="line"></span><br><span class="line">NSString *str5=[[NSString alloc] initWithFormat:@&quot;age is %i,name is %.2f&quot;,19,1.72f];</span><br><span class="line"></span><br><span class="line">NSString *str6=[[NSString alloc] initWithUTF8String:&quot;C string&quot;];//C语言的字符串转换为ObjC字符串</span><br><span class="line"></span><br><span class="line">//以上方法都有对应静态方法（一般以string开头）,不需要管理内存（系统静态方法一般都是自动释放）</span><br><span class="line">NSString *str7=[NSString stringWithString:@&quot;Objective-C string&quot;];</span><br><span class="line"></span><br><span class="line">***</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;\&quot;Hello world!\&quot; to upper is %@&quot;,[@&quot;Hello world!&quot; uppercaseString]);</span><br><span class="line">//结果：&quot;Hello world!&quot; to upper is HELLO WORLD!</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;\&quot;Hello world!\&quot; to lowwer is %@&quot;,[@&quot;Hello world!&quot; lowercaseString]);</span><br><span class="line">//结果：&quot;Hello world!&quot; to lowwer is hello world!</span><br><span class="line"></span><br><span class="line">//首字母大写，其他字母小写</span><br><span class="line">NSLog(@&quot;\&quot;Hello world!\&quot; to capitalize is %@&quot;,[@&quot;Hello world!&quot; capitalizedString]);</span><br><span class="line">//结果：&quot;Hello world!&quot; to capitalize is Hello World!</span><br><span class="line"></span><br><span class="line">BOOL result= [@&quot;abc&quot; isEqualToString:@&quot;aBc&quot;];</span><br><span class="line">NSLog(@&quot;%i&quot;,result);</span><br><span class="line">//结果：0</span><br><span class="line"></span><br><span class="line">NSComparisonResult result2= [@&quot;abc&quot; compare:@&quot;aBc&quot;];//如果是[@&quot;abc&quot; caseInsensitiveCompare:@&quot;aBc&quot;]则忽略大小写比较</span><br><span class="line">    if(result2==NSOrderedAscending)&#123;</span><br><span class="line">        NSLog(@&quot;left&lt;right.&quot;);</span><br><span class="line">    &#125;else if(result2==NSOrderedDescending)&#123;</span><br><span class="line">        NSLog(@&quot;left&gt;right.&quot;);</span><br><span class="line">    &#125;else if(result2==NSOrderedSame)&#123;</span><br><span class="line">        NSLog(@&quot;left=right.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">//结果：left&gt;right.</span><br><span class="line"></span><br><span class="line">***</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;has prefix ab? %i&quot;,[@&quot;abcdef&quot; hasPrefix:@&quot;ab&quot;]);</span><br><span class="line">//结果：has prefix ab? 1</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;has suffix ab? %i&quot;,[@&quot;abcdef&quot; hasSuffix:@&quot;ef&quot;]);</span><br><span class="line">//结果：has suffix ab? 1</span><br><span class="line"></span><br><span class="line">NSRange range=[@&quot;abcdefabcdef&quot; rangeOfString:@&quot;cde&quot;];//注意如果遇到cde则不再往后面搜索,如果从后面搜索或其他搜索方式可以设置第二个options参数</span><br><span class="line">if(range.location==NSNotFound)&#123;</span><br><span class="line">NSLog(@&quot;not found.&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">NSLog(@&quot;range is %@&quot;,NSStringFromRange(range));</span><br><span class="line">&#125;</span><br><span class="line">//结果：range is &#123;2, 3&#125;</span><br><span class="line"></span><br><span class="line">***</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%@&quot;,[@&quot;abcdef&quot; substringFromIndex:3]);//从第三个索引开始（包括第三个索引对应的字符）截取到最后一位</span><br><span class="line">//结果：def</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%@&quot;,[@&quot;abcdef&quot; substringToIndex:3]);////从0开始截取到第三个索引（不包括第三个索引对应的字符）</span><br><span class="line">//结果：abc</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%@&quot;,[@&quot;abcdef&quot; substringWithRange:NSMakeRange(2, 3)]);</span><br><span class="line">//结果：cde</span><br><span class="line"></span><br><span class="line">NSString *str1=@&quot;12.abcd.3a&quot;;</span><br><span class="line">NSArray *array1=[str1 componentsSeparatedByString:@&quot;.&quot;];//字符串分割</span><br><span class="line">NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">/*结果：</span><br><span class="line">(</span><br><span class="line">12,</span><br><span class="line">abcd,</span><br><span class="line">3a</span><br><span class="line">)</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">***</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%i&quot;,[@&quot;12&quot; intValue]);//类型转换</span><br><span class="line">//结果：12</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%zi&quot;,[@&quot;hello world,世界你好！&quot; length]);//字符串长度注意不是字节数</span><br><span class="line">//结果：17</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%c&quot;,[@&quot;abc&quot; characterAtIndex:0]);//取出制定位置的字符</span><br><span class="line">//结果：a</span><br><span class="line"></span><br><span class="line">const char *s=[@&quot;abc&quot; UTF8String];//转换为C语言字符串</span><br><span class="line">NSLog(@&quot;%s&quot;,s);</span><br><span class="line">//结果：abc</span><br><span class="line"></span><br><span class="line">//补充</span><br><span class="line"></span><br><span class="line">//去掉最后一个字符</span><br><span class="line">NSString * newString = [originString substringWithRange:NSMakeRange(0, [originString length] - 1)];</span><br><span class="line"></span><br><span class="line">//拼接字符串</span><br><span class="line">NSString </span><br><span class="line">NSString* string; // 结果字符串</span><br><span class="line">NSString* string1, string2; //已存在的字符串，需要将string1和string2连接起来</span><br><span class="line">方法1</span><br><span class="line">string = [NSString initWithFormat:@&quot;%@,%@&quot;, string1, string2 ];</span><br><span class="line">方法2</span><br><span class="line">string = [string1 stringByAppendingString:string2];</span><br><span class="line">方法3</span><br><span class="line">string = [string stringByAppendingFormat:@&quot;%@,%@&quot;,string1, string2];</span><br><span class="line">方法4：</span><br><span class="line">NSString *test =  [NSString stringWithFormat:@&quot;设备名称：%@ \n系统版本号：%@\n设备模式：%@\n手机型号: %@\nApp应用名称：%@\nApp应用版本：%@\n&quot;,strName,strSysVersion,strModel,phoneModel,strAppName,strAppVersion];</span><br><span class="line"></span><br><span class="line">//for循环添加字符串</span><br><span class="line"> for (NSString *str in rolePick)&#123;</span><br><span class="line">  string = [string stringByAppendingFormat:@&quot;%@,&quot;,str];</span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"> //截取字符串</span><br><span class="line">NSString *str = @&quot;hello:world&quot;;  </span><br><span class="line">NSRange range = [str rangeOfString:@&quot;:&quot;];  </span><br><span class="line">str = [str substringFromIndex:NSMaxRange(range)];  </span><br><span class="line">其中range这个东东有两个属性：length、location</span><br><span class="line">length表示用来做range的字符串的长度，在此就是&quot;:&quot;的长度 ＝ 1；</span><br><span class="line">location表示首个出现该匹配字符串的下标</span><br><span class="line"></span><br><span class="line">//判断字符串是否为空</span><br><span class="line">- (BOOL) isBlankString:(NSString *)string &#123;</span><br><span class="line">    if (string == nil || string == NULL)</span><br><span class="line">    &#123;</span><br><span class="line">        return YES;</span><br><span class="line">    &#125;</span><br><span class="line">    if ([string isKindOfClass:[NSNull class]])</span><br><span class="line">    &#123;</span><br><span class="line">        return YES;</span><br><span class="line">    &#125;</span><br><span class="line">    if ([[string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet]] length]==0)</span><br><span class="line">    &#123;</span><br><span class="line">        return YES;</span><br><span class="line">    &#125;</span><br><span class="line">    return NO;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//分割字符串为数组</span><br><span class="line">NSArray *array = [string componentsSeparatedByString:@&quot;,&quot;]; // 通过逗号分隔字符串转化为数组</span><br><span class="line"></span><br><span class="line">//计算某个字符在字符串中的个数</span><br><span class="line">-(int) numberOfCharaterInString:(NSString *)stringToCount characterToCount:(NSString *) character&#123;</span><br><span class="line">    int numberPoint = 0;</span><br><span class="line">    for (int i = 0; i&lt;stringToCount.length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        NSString * temp = [stringToCount substringWithRange:NSMakeRange(i, 1)];</span><br><span class="line">        if ([temp isEqualToString:character])</span><br><span class="line">        &#123;</span><br><span class="line">            numberPoint ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return  numberPoint;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//声明一个NSString属性使用copy要优于使用strong。</span><br><span class="line"></span><br><span class="line">//Nsstring 转 Nsnumber</span><br><span class="line"> NSNumberFormatter *f = [[NSNumberFormatter alloc] init];</span><br><span class="line">    if ([f numberFromString:ss])</span><br><span class="line">    &#123;</span><br><span class="line">        result=[NSNumber numberWithFloat:[ss floatValue]];</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        result=ss;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">//字符串与int互转</span><br><span class="line">int intString = [newString intValue];   </span><br><span class="line">NSString *stringInt = [NSString stringWithFormat:@&quot;%d&quot;,intString];</span><br><span class="line"></span><br><span class="line">//字符串与float互转</span><br><span class="line">float floatString = [ newString floatValue];NSString *stringFloat = [NSString stringWithFormat:@&quot;%f&quot;,intString];</span><br><span class="line"></span><br><span class="line">//与NSData的转化</span><br><span class="line">NSData *string2data = [string dataUsingEncoding:NSUTF8StringEncoding];    NSLog(@&quot;%@&quot;,string2data);//    NSData to NSString    NSString *data2String = [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];    NSLog(@&quot;dataString = %@&quot;,data2String);</span><br><span class="line"></span><br><span class="line">//与NSDate的转化</span><br><span class="line">NSString to NSDate    NSDate *string2date = [self convertDateFromString:dateString withFormattre:@&quot;yyyyMMdd&quot;];    NSLog(@&quot;date = %@&quot;,string2date);</span><br><span class="line">//NSDate to NSString    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];    [dateFormatter setDateFormat:@&quot;yyyy-MM-dd HH:mm:ss&quot;];    NSString *date2string = [dateFormatter stringFromDate:[NSDate date]];    NSLog(@&quot;%@&quot;, date2string);</span><br><span class="line">// NSString to NSArray    NSArray *string2Arry = [arry2String componentsSeparatedByString:@&quot; &quot;];    NSLog(@&quot; %@&quot;,string2Arry);</span><br><span class="line"></span><br><span class="line">//NSString to NSDictionary</span><br><span class="line"> </span><br><span class="line">  NSError *error = nil;  NSDictionary *string2dic = [NSJSONSerialization JSONObjectWithData: [dic2string dataUsingEncoding:NSUTF8StringEncoding]                                    options: NSJSONReadingMutableContainers                                      error: &amp;error];NSLog(@&quot;%@&quot;,string2dic);</span><br></pre></td></tr></table></figure>
<ul>
<li><h5 id="可变字符串"><a href="#可变字符串" class="headerlink" title="可变字符串"></a>可变字符串</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> /*可变字符串，注意NSMutableString是NSString子类*/</span><br><span class="line">//注意虽然initWithCapacity分配字符串大小，但是不是绝对的不可以超过此范围，声明此变量对性能有好处</span><br><span class="line"></span><br><span class="line">//设置字符串</span><br><span class="line">NSMutableString *str1= [[NSMutableString alloc] initWithCapacity:10];</span><br><span class="line">[str1 setString:@&quot;hello&quot;];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello</span><br><span class="line"></span><br><span class="line">//追加字符串</span><br><span class="line">[str1 appendString:@&quot;,world!&quot;];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!</span><br><span class="line"></span><br><span class="line">[str1 appendFormat:@&quot;我的年龄是%i。dear,I love you.&quot;,18];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!我的年龄是18。dear,I love you.</span><br><span class="line"></span><br><span class="line">//替换字符串</span><br><span class="line">NSRange range=[str1 rangeOfString:@&quot;dear&quot;];</span><br><span class="line">[str1 replaceCharactersInRange:range withString:@&quot;Honey&quot;];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!我的年龄是18。Honey,I love you.</span><br><span class="line"></span><br><span class="line">//插入字符串</span><br><span class="line">[str1 insertString:@&quot;My name is Kenshin.&quot; atIndex:12];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!My name is Kenshin.我的年龄是18。Honey,I love you.</span><br><span class="line"></span><br><span class="line">//删除指定字符串</span><br><span class="line">[str1 deleteCharactersInRange:[str1 rangeOfString:@&quot;My name is Kenshin.&quot;]];//删除指定范围的字符串</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!我的年龄是18。Honey,I love you.</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br></pre></td><td class="code"><pre><span class="line">在ObjC中路径、文件读写等操作是利用字符串来完成的，这里通过几个简单的例子来演示（首先在桌面上新建一个test.txt文件，里面存储的内容是”hello world,世界你好！”）</span><br><span class="line"></span><br><span class="line">//读取文件内容</span><br><span class="line">void test1()&#123;</span><br><span class="line">NSString *path=@&quot;/Users/kenshincui/Desktop/test.txt&quot;;</span><br><span class="line">NSString *str1=[NSString stringWithContentsOfFile:path encoding:NSUTF8StringEncoding error:nil];</span><br><span class="line">//注意上面也可以使用gb2312 gbk等,例如kCFStringEncodingGB_18030_2000，但是需要用CFStringConvertEncodingToNSStringEncoding转换</span><br><span class="line">NSLog(@&quot;str1 is %@&quot;,str1);</span><br><span class="line">//结果：str1 is hello world,世界你好！</span><br><span class="line"></span><br><span class="line">//上面我们看到了读取文件，但并没有处理错误,当然在ObjC中可以@try @catch @finnally但通常我们并不那么做</span><br><span class="line">//由于我们的test.txt中有中文，所以使用下面的编码读取会报错，下面的代码演示了错误获取的过程</span><br><span class="line">NSError *error;</span><br><span class="line">NSString *str2=[NSString stringWithContentsOfFile:path encoding:kCFStringEncodingGB_18030_2000 error:&amp;error];//注意这句话中的error变量是**error，就是指针的指针那就是指针的地址，由于error就是一个指针此处也就是error的地址&amp;error，具体原因见下面补充</span><br><span class="line">    if(error)&#123;</span><br><span class="line">        NSLog(@&quot;read error ,the error is %@&quot;,error);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        NSLog(@&quot;read success,the file content is %@&quot;,str2);</span><br><span class="line">    &#125;</span><br><span class="line">//结果：read error ,the error is Error </span><br><span class="line"></span><br><span class="line">Domain=NSCocoaErrorDomain Code=261 &quot;The file couldn’t be opened using the specified text encoding.&quot; UserInfo=0x100109620 &#123;NSFilePath=/Users/kenshincui/Desktop/test.txt, NSStringEncoding=1586&#125;</span><br><span class="line"></span><br><span class="line">//读取文件内容还有一种方式就是利用URl，它除了可以读取本地文件还可以读取网络文件</span><br><span class="line">//NSURL *url=[NSURL URLWithString:@&quot;file:///Users/kenshincui/Desktop/test.txt&quot;];</span><br><span class="line">NSURL *url=[NSURL URLWithString:@&quot;http://www.apple.com&quot;];</span><br><span class="line">NSString *str3=[NSString stringWithContentsOfURL:url encoding:NSUTF8StringEncoding error:nil];</span><br><span class="line">NSLog(@&quot;str3 is %@&quot;,str3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//下面是文件写入</span><br><span class="line">void test2()&#123;</span><br><span class="line">NSString *path1=@&quot;/Users/kenshincui/Desktop/test2.txt&quot;;</span><br><span class="line">NSError *error1;</span><br><span class="line">NSString *str11=@&quot;hello world,世界你好！&quot;;</span><br><span class="line">[str11 writeToFile:path1 atomically:YES encoding:NSUTF8StringEncoding error:&amp;error1];//automically代表一次性写入，如果写到中间出错了最后就全部不写入</span><br><span class="line">if(error1)&#123;</span><br><span class="line">NSLog(@&quot;write fail,the error is %@&quot;,[error1 localizedDescription]);//调用localizedDescription是只打印关键错误信息</span><br><span class="line">&#125;else&#123;</span><br><span class="line">NSLog(@&quot;write success!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">//结果：write success!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//路径操作</span><br><span class="line">void test3()&#123;</span><br><span class="line">NSMutableArray *marray=[NSMutableArray array];//可变数组</span><br><span class="line">[marray addObject:@&quot;Users&quot;];</span><br><span class="line">[marray addObject:@&quot;KenshinCui&quot;];</span><br><span class="line">[marray addObject:@&quot;Desktop&quot;];</span><br><span class="line">NSString *path=[NSString pathWithComponents:marray];</span><br><span class="line">NSLog(@&quot;%@&quot;,path);//字符串拼接成路径</span><br><span class="line">//结果：Users/KenshinCui/Desktop</span><br><span class="line">NSLog(@&quot;%@&quot;,[path pathComponents]);//路径分割成数组</span><br><span class="line">/*结果： </span><br><span class="line">(</span><br><span class="line">        Users,</span><br><span class="line">        KenshinCui,</span><br><span class="line">        Desktop</span><br><span class="line">)</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%i&quot;,[path isAbsolutePath]);//是否绝对路径（其实就是看字符串是否以“/”开头）</span><br><span class="line">//结果：0</span><br><span class="line">NSLog(@&quot;%@&quot;,[path lastPathComponent]);//取得最后一个目录</span><br><span class="line">//结果：Desktop</span><br><span class="line">NSLog(@&quot;%@&quot;,[path stringByDeletingLastPathComponent]);//删除最后一个目录，注意path本身是常量不会被修改,只是返回一个新字符串</span><br><span class="line">//结果：Users/KenshinCui</span><br><span class="line">NSLog(@&quot;%@&quot;,[path stringByAppendingPathComponent:@&quot;Documents&quot;]);//路径拼接</span><br><span class="line">//结果：Users/KenshinCui/Desktop/Documents</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//扩展名操作</span><br><span class="line">void test4()&#123;</span><br><span class="line">NSString *path=@&quot;Users/KenshinCui/Desktop/test.txt&quot;;</span><br><span class="line">NSLog(@&quot;%@&quot;,[path pathExtension]);//取得扩展名，注意ObjC中扩展名不包括&quot;.&quot;</span><br><span class="line">//结果：txt</span><br><span class="line">NSLog(@&quot;%@&quot;,[path stringByDeletingPathExtension]);//删除扩展名，注意包含&quot;.&quot;</span><br><span class="line">//结果：Users/KenshinCui/Desktop/test</span><br><span class="line">NSLog(@&quot;%@&quot;,[@&quot;Users/KenshinCui/Desktop/test&quot; stringByAppendingPathExtension:@&quot;mp3&quot;]);//添加扩展名</span><br><span class="line">//结果：Users/KenshinCui/Desktop/test.mp3</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*目录操作*/</span><br><span class="line">void test1()&#123;</span><br><span class="line">//文件管理器是专门用于文件管理的类</span><br><span class="line">NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">//获得当前程序所在目录(当然可以改变)</span><br><span class="line">    NSString *currentPath=[manager currentDirectoryPath];</span><br><span class="line">    NSLog(@&quot;current path is :%@&quot;,currentPath);</span><br><span class="line">    //结果：/Users/kenshincui/Library/Developer/Xcode/DerivedData/FoundationFramework-awxjohcpgsqcpsanqofqogwbqgbx/Build/Products/Debug</span><br><span class="line">    </span><br><span class="line">    //创建目录</span><br><span class="line">    NSString *myPath=@&quot;/Users/kenshincui/Desktop/myDocument&quot;;</span><br><span class="line">    BOOL result= [manager createDirectoryAtPath:myPath withIntermediateDirectories:YES attributes:nil error:nil];</span><br><span class="line">    if(result==NO)&#123;</span><br><span class="line">        NSLog(@&quot;Couldn&apos;t create directory!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //目录重命名，如果需要删除目录只要调用removeItemAtPath:&lt;#(NSString *)#&gt; error:&lt;#(NSError **)#&gt;</span><br><span class="line">    NSError *error;</span><br><span class="line">    NSString *newPath=@&quot;/Users/kenshincui/Desktop/myNewDocument&quot;;</span><br><span class="line">    if([manager moveItemAtPath:myPath toPath:newPath error:&amp;error]==NO)&#123;</span><br><span class="line">        NSLog(@&quot;Rename directory failed!Error infomation is:%@&quot;,error);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //改变当前目录</span><br><span class="line">    if([manager changeCurrentDirectoryPath:newPath]==NO)&#123;</span><br><span class="line">        NSLog(@&quot;Change current directory failed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    NSLog(@&quot;current path is :%@&quot;,[manager currentDirectoryPath]);</span><br><span class="line">    //结果：current path is :/Users/kenshincui/Desktop/myNewDocument</span><br><span class="line">    </span><br><span class="line">    //遍历整个目录</span><br><span class="line">    NSString *path;</span><br><span class="line">    NSDirectoryEnumerator *directoryEnumerator= [manager enumeratorAtPath:newPath];</span><br><span class="line">    while (path=[directoryEnumerator nextObject]) &#123;</span><br><span class="line">        NSLog(@&quot;%@&quot;,path);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     documents</span><br><span class="line">     est.txt</span><br><span class="line">    */</span><br><span class="line">    </span><br><span class="line">    //或者这样遍历</span><br><span class="line">    NSArray *paths= [manager contentsOfDirectoryAtPath:newPath error:nil];</span><br><span class="line">    NSObject *p;</span><br><span class="line">    for (p in paths) &#123;</span><br><span class="line">        NSLog(@&quot;%@&quot;,p);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     documents</span><br><span class="line">     est.txt</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*文件操作*/</span><br><span class="line">void test2()&#123;</span><br><span class="line">    NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">    NSString *filePath=@&quot;/Users/kenshincui/Desktop/myNewDocument/test.txt&quot;;</span><br><span class="line">    NSString *filePath2=@&quot;/Users/kenshincui/Desktop/test.txt&quot;;</span><br><span class="line">    NSString *newPath=@&quot;/Users/kenshincui/Desktop/myNewDocument/test2.txt&quot;;</span><br><span class="line">    </span><br><span class="line">    //判断文件是否存在，这个方法也可以判断目录是否存在，这要后面的参数设置位YES</span><br><span class="line">    if ([manager fileExistsAtPath:filePath isDirectory:NO]) &#123;</span><br><span class="line">        NSLog(@&quot;File exists！&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //文件是否可读</span><br><span class="line">    if([manager isReadableFileAtPath:filePath])&#123;</span><br><span class="line">        NSLog(@&quot;File is readable!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //判断两个文件内容是否相等</span><br><span class="line">    if ([manager contentsEqualAtPath:filePath andPath:filePath2]) &#123;</span><br><span class="line">        NSLog(@&quot;file1 equals file2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //文件重命名，方法类似于目录重命名</span><br><span class="line">    if (![manager moveItemAtPath:filePath toPath:newPath error:nil]) &#123;</span><br><span class="line">        NSLog(@&quot;Rename file1 failed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //文件拷贝</span><br><span class="line">    NSString *filePath3=@&quot;/Users/kenshincui/Desktop/test3.txt&quot;;</span><br><span class="line">    if(![manager copyItemAtPath:newPath toPath:filePath3 error:nil])&#123;</span><br><span class="line">        NSLog(@&quot;Copy failed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //读取文件属性</span><br><span class="line">    NSDictionary *attributes;</span><br><span class="line">    if ((attributes=[manager attributesOfItemAtPath:newPath error:nil])==nil) &#123;</span><br><span class="line">        NSLog(@&quot;Read attributes failed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    for (NSObject *key in attributes) &#123;</span><br><span class="line">        NSLog(@&quot;%@=%@&quot;,key,attributes[key]);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">         NSFileOwnerAccountID=501</span><br><span class="line">         NSFileHFSTypeCode=0</span><br><span class="line">         NSFileSystemFileNumber=1781953</span><br><span class="line">         NSFileExtensionHidden=0</span><br><span class="line">         NSFileSystemNumber=16777218</span><br><span class="line">         NSFileSize=27</span><br><span class="line">         NSFileGroupOwnerAccountID=20</span><br><span class="line">         NSFileOwnerAccountName=kenshincui</span><br><span class="line">         NSFileCreationDate=2014-07-28 11:47:58 +0000</span><br><span class="line">         NSFilePosixPermissions=420</span><br><span class="line">         NSFileHFSCreatorCode=0</span><br><span class="line">         NSFileType=NSFileTypeRegular</span><br><span class="line">         NSFileExtendedAttributes=&#123;</span><br><span class="line">         &quot;com.apple.TextEncoding&quot; = &lt;7574662d 383b3133 34323137 393834&gt;;</span><br><span class="line">         &#125;</span><br><span class="line">         NSFileGroupOwnerAccountName=staff</span><br><span class="line">         NSFileReferenceCount=1</span><br><span class="line">         NSFileModificationDate=2014-07-28 11:47:58 +0000</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    //删除文件</span><br><span class="line">    [manager removeItemAtPath:newPath error:nil];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">//文件操作--文件内容操作（NSData，非结构化字节流对象，有缓冲区管理机制，可用于网络传输）</span><br><span class="line">void test3()&#123;</span><br><span class="line">    NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">    NSString *filePath=@&quot;/Users/kenshincui/Desktop/myNewDocument/test2.txt&quot;;</span><br><span class="line">    NSData *data=[manager contentsAtPath:filePath];</span><br><span class="line">    NSLog(@&quot;%@&quot;,data);//存储的是二进制字节流</span><br><span class="line">    //结果:&lt;68656c6c 6f20776f 726c642c e4b896e7 958ce4bd a0e5a5bd efbc81&gt;</span><br><span class="line">    </span><br><span class="line">    //NSData转化成字符串</span><br><span class="line">    NSString *str1=[[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];</span><br><span class="line">    NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">    //结果：hello world,世界你好！</span><br><span class="line">    </span><br><span class="line">    //字符串转化成NSData</span><br><span class="line">    NSString *str2=@&quot;Kenshin&quot;;</span><br><span class="line">    NSData *data2=[str2 dataUsingEncoding:NSUTF8StringEncoding];</span><br><span class="line">    NSLog(@&quot;%@&quot;,data2);</span><br><span class="line">    </span><br><span class="line">    //当然一般如果仅仅是简单读取文件内容，直接用户NSString方法即可</span><br><span class="line">    NSString *content=[NSString stringWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,content);</span><br><span class="line">    //结果：hello world,世界你好！</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">//文件操作--细粒度控制文件,文件操作柄</span><br><span class="line">void test4()&#123;</span><br><span class="line">    NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">    NSString *filePath=@&quot;/Users/kenshincui/Desktop/myNewDocument/test2.txt&quot;;</span><br><span class="line">    </span><br><span class="line">    //以只读方式打开文件</span><br><span class="line">    NSFileHandle *fileHandle=[NSFileHandle fileHandleForReadingAtPath:filePath];//注意这个方法返回类型为instancetype，也就是说对于上面的NSFileHandle它的返回类型也是NSFileHandle</span><br><span class="line">    NSData *data= [fileHandle readDataToEndOfFile];//完整读取文件</span><br><span class="line">    NSString *newPath=@&quot;/Users/kenshincui/Desktop/test4.txt&quot;;</span><br><span class="line">    [manager createFileAtPath:newPath contents:nil attributes:nil];</span><br><span class="line">    NSFileHandle *fileHandle2=[NSFileHandle fileHandleForWritingAtPath:newPath];//以可写方式打开文件</span><br><span class="line">    [fileHandle2 writeData:data];//写入文件内容</span><br><span class="line">    </span><br><span class="line">    [fileHandle2 closeFile];//关闭文件</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    //定位到指定位置,默认在文件开头</span><br><span class="line">    [fileHandle seekToFileOffset:12];</span><br><span class="line">    NSData *data2= [fileHandle readDataToEndOfFile];</span><br><span class="line">    NSLog(@&quot;data2=%@&quot;,[[NSString alloc]initWithData:data2 encoding:NSUTF8StringEncoding]);</span><br><span class="line">    //结果：data2=世界你好！</span><br><span class="line">    </span><br><span class="line">    [fileHandle seekToFileOffset:6];</span><br><span class="line">    NSData *data3=[fileHandle readDataOfLength:5];</span><br><span class="line">    NSLog(@&quot;data3=%@&quot;,[[NSString alloc]initWithData:data3 encoding:NSUTF8StringEncoding]);</span><br><span class="line">    //结果：data3=world</span><br><span class="line">    </span><br><span class="line">    [fileHandle closeFile];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//文件路径</span><br><span class="line">void test5()&#123;</span><br><span class="line">    NSString *filePath=@&quot;/Users/kenshincui/Desktop/myDocument&quot;;</span><br><span class="line">    NSString *filePath2=@&quot;/Users/kenshincui/Desktop/test.txt&quot;;</span><br><span class="line"></span><br><span class="line">    //临时文件所在目录</span><br><span class="line">    NSString *path=NSTemporaryDirectory();</span><br><span class="line">    NSLog(@&quot;temporary directory is :%@&quot;,path);</span><br><span class="line">    //结果：/var/folders/h6/lss6gncs509c2pgzgty3wd_40000gn/T/</span><br><span class="line"></span><br><span class="line">    NSString *lastComponent= [filePath lastPathComponent];</span><br><span class="line">    NSLog(@&quot;%@&quot;,lastComponent); //结果：myDocument</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;%@&quot;,[filePath stringByDeletingLastPathComponent]);</span><br><span class="line">    //结果：/Users/kenshincui/Desktop</span><br><span class="line">    NSLog(@&quot;%@&quot;,[filePath stringByAppendingPathComponent:@&quot;Pictrues&quot;]);</span><br><span class="line">    //结果：/Users/kenshincui/Desktop/myDocument/Pictrues</span><br><span class="line">    NSLog(@&quot;%@&quot;,[filePath2 pathExtension]);</span><br><span class="line">    //结果：txt</span><br><span class="line">    </span><br><span class="line">    [[filePath pathComponents] enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) &#123;</span><br><span class="line">        NSLog(@&quot;%i=%@&quot;,idx,obj);</span><br><span class="line">    &#125;];</span><br><span class="line">    /*结果：</span><br><span class="line">     0=/</span><br><span class="line">     1=Users</span><br><span class="line">     2=kenshincui</span><br><span class="line">     3=Desktop</span><br><span class="line">     4=myDocument</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//文件操作--NSURL</span><br><span class="line">void test6()&#123;</span><br><span class="line">    NSURL *url=[NSURL URLWithString:@&quot;http://developer.apple.com&quot;];</span><br><span class="line">    NSString *str1=[NSString stringWithContentsOfURL:url encoding:NSUTF8StringEncoding error:nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//文件操作--NSBundle，程序包，一般用于获取Resource中的资源（当然由于当前并非IOS应用没有程序包，只是表示当前程序运行路径）</span><br><span class="line">//在ios中经常用于读取应用程序中的资源文件，如图片、声音、视频等</span><br><span class="line">void test7()&#123;</span><br><span class="line">    //在程序包所在目录创建一个文件</span><br><span class="line">    NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">    NSString *currentPath=[manager currentDirectoryPath];</span><br><span class="line">    NSLog(@&quot;current path is :%@&quot;,currentPath);</span><br><span class="line">    //结果：current path is :/Users/kenshincui/Library/Developer/Xcode/DerivedData/FoundationFramework-awxjohcpgsqcpsanqofqogwbqgbx/Build/Products/Debug</span><br><span class="line">    NSString *filePath=[currentPath stringByAppendingPathComponent:@&quot;test.txt&quot;];</span><br><span class="line">    [manager createFileAtPath:filePath contents:[@&quot;Hello,world!&quot; dataUsingEncoding:NSUTF8StringEncoding] attributes:nil];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //利用NSBundle在程序包所在目录查找对应的文件</span><br><span class="line">    NSBundle *bundle=[NSBundle mainBundle];//主要操作程序包所在目录</span><br><span class="line">    //如果有test.txt则返回路径，否则返回nil</span><br><span class="line">    NSString *path=[bundle pathForResource:@&quot;test&quot; ofType:@&quot;txt&quot;];//也可以写成：[bundle pathForResource:@&quot;instructions.txt&quot; ofType:nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,path);</span><br><span class="line">    //结果：/Users/kenshincui/Library/Developer/Xcode/DerivedData/FoundationFramework-awxjohcpgsqcpsanqofqogwbqgbx/Build/Products/Debug/test.txt</span><br><span class="line">    NSLog(@&quot;%@&quot;,[NSString stringWithContentsOfFile:path encoding:NSUTF8StringEncoding error:nil]);</span><br><span class="line">    //结果：Hello,world!</span><br><span class="line">    </span><br><span class="line">    //假设我们在程序运行创建一个Resources目录，并且其中新建pic.jpg，那么用下面的方法获得这个文件完整路径</span><br><span class="line">    NSString *path1= [bundle pathForResource:@&quot;pic&quot; ofType:@&quot;jpg&quot; inDirectory:@&quot;Resources&quot;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,path1);</span><br><span class="line">    //结果：/Users/kenshincui/Library/Developer/Xcode/DerivedData/FoundationFramework-awxjohcpgsqcpsanqofqogwbqgbx/Build/Products/Debug/Resources/pic.jpg</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><ul>
<li><h5 id="不可变数组"><a href="#不可变数组" class="headerlink" title="不可变数组"></a>不可变数组</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br></pre></td><td class="code"><pre><span class="line">void test1()&#123;</span><br><span class="line">//NSArray长度不可变所以初始化的时候就赋值，并且最后以nil结尾</span><br><span class="line">//此外需要注意NSArray不能存放C语言的基础类型</span><br><span class="line">NSObject *obj=[[NSObject alloc]init];</span><br><span class="line"></span><br><span class="line">NSArray *array1=[[NSArray alloc] initWithObjects:@&quot;abc&quot;,obj,@&quot;cde&quot;,@&quot;opq&quot;, nil];</span><br><span class="line"></span><br><span class="line">//推荐简便的声明方式</span><br><span class="line">NSArray *array1=@[@&quot;Mac Pro&quot;, @&quot;Mac mini&quot;, @&quot;iMac&quot;, @&quot;MacBook&quot;, @&quot;MacBook Pro&quot;, @&quot;MacBook Air&quot;];</span><br><span class="line"></span><br><span class="line">NSArray *array1=[NSArray arrayWithObjects:@&quot;abc&quot;,obj,@&quot;cde&quot;,@&quot;opq&quot;,@25, nil];</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%zi&quot;,array1.count);//数组长度,结果：5</span><br><span class="line">NSLog(@&quot;%i&quot;,[array1 containsObject:@&quot;cde&quot;]);//是否包含某个对象，结果：1</span><br><span class="line">NSLog(@&quot;%@&quot;,[array1 lastObject]);//最后一个对象，结果：25</span><br><span class="line">NSLog(@&quot;%zi&quot;,[array1 indexOfObject:@&quot;abc&quot;]);//对象所在的位置：0</span><br><span class="line">    </span><br><span class="line">    Person *person1=[Person personWithName:@&quot;Kenshin&quot;];</span><br><span class="line">    Person *person2=[Person personWithName:@&quot;Kaoru&quot;];</span><br><span class="line">    Person *person3=[Person personWithName:@&quot;Rosa&quot;];</span><br><span class="line">    NSArray *array2=[[NSArray alloc]initWithObjects:person1,person2,person3, nil];</span><br><span class="line">    [array2 makeObjectsPerformSelector:@selector(showMessage:) withObject:@&quot;Hello,world!&quot;];//执行所有元素的showMessage方法,后面的参数最多只能有一个</span><br><span class="line">    /*结果：</span><br><span class="line">     My name is Kenshin,the infomation is &quot;Hello,world!&quot;.</span><br><span class="line">     My name is Kaoru,the infomation is &quot;Hello,world!&quot;.</span><br><span class="line">     My name is Rosa,the infomation is &quot;Hello,world!&quot;.</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//数组的遍历</span><br><span class="line">void test2()&#123;</span><br><span class="line">    NSObject *obj=[[NSObject alloc]init];</span><br><span class="line">    NSArray *array=[[NSArray alloc] initWithObjects:@&quot;abc&quot;,obj,@&quot;cde&quot;,@&quot;opq&quot;,@25, nil];</span><br><span class="line">    //方法1</span><br><span class="line">    for(int i=0,len=array.count;i&lt;len;++i)&#123;</span><br><span class="line">        NSLog(@&quot;method1:index %i is %@&quot;,i,[array objectAtIndex:i]);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     method1:index 0 is abc</span><br><span class="line">     method1:index 1 is &lt;NSObject: 0x100106de0&gt;</span><br><span class="line">     method1:index 2 is cde</span><br><span class="line">     method1:index 3 is opq</span><br><span class="line">     method1:index 4 is 25</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法2</span><br><span class="line">    for(id obj in array)&#123;</span><br><span class="line">        NSLog(@&quot;method2:index %zi is %@&quot;,[array indexOfObject:obj],obj);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     method2:index 0 is abc</span><br><span class="line">     method2:index 1 is &lt;NSObject: 0x100602f00&gt;</span><br><span class="line">     method2:index 2 is cde</span><br><span class="line">     method2:index 3 is opq</span><br><span class="line">     method2:index 4 is 25</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法3,利用代码块方法</span><br><span class="line">    [array enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) &#123;</span><br><span class="line">        NSLog(@&quot;method3:index %zi is %@&quot;,idx,obj);</span><br><span class="line">        if(idx==2)&#123;//当idx=2时设置*stop为YES停止遍历</span><br><span class="line">            *stop=YES;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    /*结果：</span><br><span class="line">     method3:index 0 is abc</span><br><span class="line">     method3:index 1 is &lt;NSObject: 0x100106de0&gt;</span><br><span class="line">     method3:index 2 is cde</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法4，利用迭代器</span><br><span class="line">    //NSEnumerator *enumerator= [array objectEnumerator];//获得一个迭代器</span><br><span class="line">    NSEnumerator *enumerator=[array reverseObjectEnumerator];//获取一个反向迭代器</span><br><span class="line">    //NSLog(@&quot;all:%@&quot;,[enumerator allObjects]);//获取所有迭代对象，注意调用完此方法迭代器就遍历完了，下面的nextObject就没有值了</span><br><span class="line">    id obj2=nil;</span><br><span class="line">    while (obj2=[enumerator nextObject]) &#123;</span><br><span class="line">        NSLog(@&quot;method4:%@&quot;,obj2);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     method4:25</span><br><span class="line">     method4:opq</span><br><span class="line">     method4:cde</span><br><span class="line">     method4:&lt;NSObject: 0x100106de0&gt;</span><br><span class="line">     method4:abc</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//数组派生出新的数组</span><br><span class="line">void test3()&#123;</span><br><span class="line">    NSArray *array=[NSArray arrayWithObjects:@&quot;1&quot;,@&quot;2&quot;,@&quot;3&quot;, nil];</span><br><span class="line">    NSArray *array2=[array arrayByAddingObject:@&quot;4&quot;];//注意此时array并没有变</span><br><span class="line">    NSLog(@&quot;%@&quot;,array2);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3,</span><br><span class="line">         4</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">NSLog(@&quot;%@&quot;,[array2 arrayByAddingObjectsFromArray:[NSArray arrayWithObjects:@&quot;5&quot;,@&quot;6&quot;, nil]]);//追加形成新的数组</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3,</span><br><span class="line">         4,</span><br><span class="line">         5,</span><br><span class="line">         6</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">NSLog(@&quot;%@&quot;,[array2 subarrayWithRange:NSMakeRange(1, 3)]);//根据一定范围取得生成一个新的数组</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         2,</span><br><span class="line">         3,</span><br><span class="line">         4</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">NSLog(@&quot;%@&quot;,[array componentsJoinedByString:@&quot;,&quot;]);//数组连接，形成一个字符串</span><br><span class="line">    //结果：1,2,3</span><br><span class="line">    </span><br><span class="line">    //读写文件</span><br><span class="line">    NSString *path=@&quot;/Users/KenshinCui/Desktop/array.xml&quot;;</span><br><span class="line">    [array writeToFile:path atomically:YES];</span><br><span class="line">    NSArray *array3=[NSArray arrayWithContentsOfFile:path];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array3);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//数组排序</span><br><span class="line">void test4()&#123;</span><br><span class="line">    //方法1,使用自带的比较器</span><br><span class="line">    NSArray *array=[NSArray arrayWithObjects:@&quot;3&quot;,@&quot;1&quot;,@&quot;2&quot;, nil];</span><br><span class="line">    NSArray *array2= [array sortedArrayUsingSelector:@selector(compare:)];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array2);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法2,自己定义比较器</span><br><span class="line">    Person *person1=[Person personWithName:@&quot;Kenshin&quot;];</span><br><span class="line">    Person *person2=[Person personWithName:@&quot;Kaoru&quot;];</span><br><span class="line">    Person *person3=[Person personWithName:@&quot;Rosa&quot;];</span><br><span class="line">    NSArray *array3=[NSArray arrayWithObjects:person1,person2,person3, nil];</span><br><span class="line">    NSArray *array4=[array3 sortedArrayUsingSelector:@selector(comparePerson:)];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array4);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kaoru&quot;,</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Rosa&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法3使用代码块</span><br><span class="line">    NSArray *array5=[array3 sortedArrayUsingComparator:^NSComparisonResult(Person *obj1, Person *obj2) &#123;</span><br><span class="line">        return [obj2.name compare:obj1.name];//降序</span><br><span class="line">    &#125;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array5);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Rosa&quot;,</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法4 通过描述器定义排序规则</span><br><span class="line">    Person *person4=[Person personWithName:@&quot;Jack&quot;];</span><br><span class="line">    Person *person5=[Person personWithName:@&quot;Jerry&quot;];</span><br><span class="line">    Person *person6=[Person personWithName:@&quot;Tom&quot;];</span><br><span class="line">    Person *person7=[Person personWithName:@&quot;Terry&quot;];</span><br><span class="line">    NSArray *array6=[NSArray arrayWithObjects:person4,person5,person6,person7, nil];</span><br><span class="line">    //定义一个排序描述</span><br><span class="line">    NSSortDescriptor *personName=[NSSortDescriptor sortDescriptorWithKey:@&quot;name&quot; ascending:YES];</span><br><span class="line">    NSSortDescriptor *accountBalance=[NSSortDescriptor sortDescriptorWithKey:@&quot;account.balance&quot; ascending:YES];</span><br><span class="line">    NSArray *des=[NSArray arrayWithObjects:personName,accountBalance, nil];//先按照person的name排序再按照account的balance排序</span><br><span class="line">    NSArray *array7=[array6 sortedArrayUsingDescriptors:des];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array7);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Jack&quot;,</span><br><span class="line">         &quot;name=Jerry&quot;,</span><br><span class="line">         &quot;name=Terry&quot;,</span><br><span class="line">         &quot;name=Tom&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line">//补充</span><br><span class="line"></span><br><span class="line">//与可变数组的转化     </span><br><span class="line">NSArray --&gt; NSMutableArray: </span><br><span class="line">NSMutableArray *myMutableArray = [myArray mutableCopy];    </span><br><span class="line">NSMutableArray --&gt; NSArray:</span><br><span class="line">NSArray *myArray = [myMutableArray copy]; </span><br><span class="line"></span><br><span class="line">//可变性</span><br><span class="line">虽然 NSArray 类本身不可变，但它仍可包含可变对象。例如，如果将可变字符串添加到不可变的数组，</span><br><span class="line">如下所示：</span><br><span class="line">NSMutableString *mutableString = [NSMutableString stringWithString:@&quot;Hello&quot;];</span><br><span class="line">NSArray *immutableArray = @[mutableString];</span><br><span class="line">就可让您变异该字符串。</span><br><span class="line">if ([immutableArray count] &gt; 0) &#123;</span><br><span class="line">id string = immutableArray[0];</span><br><span class="line">if ([string isKindOfClass:[NSMutableString class]]) &#123;</span><br><span class="line">[string appendString:@&quot; World!&quot;];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//NSArray  去重</span><br><span class="line">面试题</span><br><span class="line">对数组中的元素去重复 </span><br><span class="line">NSArray *array = @[@&quot;12-11&quot;, @&quot;12-11&quot;, @&quot;12-11&quot;, @&quot;12-12&quot;, @&quot;12-13&quot;, @&quot;12-14&quot;];//推荐的写法</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">有如下几种方案：</span><br><span class="line">• 第一种方法：开辟新的内存空间，然后判断是否存在，若不存在则添加到数组中，得到最终结果的顺序不发生变化。效率分析：时间复杂度为O ( n2 )：</span><br><span class="line"> </span><br><span class="line">NSMutableArray *resultArray = [[NSMutableArray alloc] initWithCapacity:array.count];</span><br><span class="line">// 外层一个循环</span><br><span class="line">for (NSString *item in array) &#123;</span><br><span class="line">   // 调用-containsObject:本质也是要循环去判断，因此本质上是双层遍历</span><br><span class="line">   // 时间复杂度为O ( n^2 )而不是O (n)</span><br><span class="line">    if (![resultArray containsObject:item]) &#123;</span><br><span class="line">      [resultArray addObject:item];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">NSLog(@&quot;resultArray: %@&quot;, resultArray);</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">原来集合操作可以通过valueForKeyPath来实现的，去重可以一行代码实现： </span><br><span class="line">array = [array valueForKeyPath:@&quot;@distinctUnionOfObjects.self&quot;];</span><br><span class="line">NSLog(@&quot;%@&quot;, array);</span><br><span class="line"> </span><br><span class="line">但是返回的结果是无序的，与原来的顺序不同。</span><br><span class="line"></span><br><span class="line">• 第二种方法：利用NSDictionary去重，字典在设置key-value时，若已存在则更新值，若不存在则插入值，然后获取allValues。若不要求有序，则可以采用此种方法。若要求有序，还得进行排序。效率分析：只需要一个循环就可以完成放入字典，若不要求有序，时间复杂度为O(n)。若要求排序，则效率与排序算法有关：</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">NSMutableDictionary *resultDict = [[NSMutableDictionary alloc] initWithCapacity:array.count];</span><br><span class="line">for (NSString *item in array) &#123;</span><br><span class="line">    [resultDict setObject:item forKey:item];</span><br><span class="line">&#125;</span><br><span class="line">NSArray *resultArray = resultDict.allValues;</span><br><span class="line">NSLog(@&quot;%@&quot;, resultArray);</span><br><span class="line"> </span><br><span class="line">如果需要按照原来的升序排序，可以这样：</span><br><span class="line">resultArray = [resultArray sortedArrayUsingComparator:^NSComparisonResult(id  _Nonnull obj1, id  _Nonnull obj2) &#123;</span><br><span class="line">  NSString *item1 = obj1;</span><br><span class="line">  NSString *item2 = obj2;</span><br><span class="line">  return [item1 compare:item2 options:NSLiteralSearch];</span><br><span class="line">&#125;];</span><br><span class="line">NSLog(@&quot;%@&quot;, resultArray);</span><br><span class="line"></span><br><span class="line">• 第三种方法：利用集合NSSet的特性(确定性、无序性、互异性)，放入集合就自动去重了。但是它与字典拥有同样的无序性，所得结果顺序不再与原来一样。如果不要求有序，使用此方法与字典的效率应该是差不多的。效率分析：时间复杂度为O (n)：</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">NSSet *set = [NSSet setWithArray:array];</span><br><span class="line">NSArray *resultArray = [set allObjects];</span><br><span class="line">NSLog(@&quot;%@&quot;, resultArray);</span><br><span class="line"> </span><br><span class="line">如果要求有序，那就得排序，比如这里要升序排序：</span><br><span class="line"> </span><br><span class="line">resultArray = [resultArray sortedArrayUsingComparator:^NSComparisonResult(id  _Nonnull obj1, id  _Nonnull obj2) &#123;</span><br><span class="line">  NSString *item1 = obj1;</span><br><span class="line">  NSString *item2 = obj2;</span><br><span class="line">  return [item1 compare:item2 options:NSLiteralSearch];</span><br><span class="line">&#125;];</span><br><span class="line">NSLog(@&quot;%@&quot;, resultArray);</span><br><span class="line"> </span><br><span class="line">补充：</span><br><span class="line">一直没有使用过有序集合，网友们反馈到可以直接使用有序集合，感谢大家：</span><br><span class="line">NSOrderedSet *set = [NSOrderedSet orderedSetWithArray:array];</span><br><span class="line">NSLog(@&quot;%@&quot;, set.array);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> //NSArray to NSData</span><br><span class="line">NSData *arry2data = [NSKeyedArchiver archivedDataWithRootObject:array];//NSData to NSArrayNSArray *data2arry = [NSKeyedUnarchiver unarchiveObjectWithData:arry2data];NSLog(@&quot;%@  /n %@&quot;,arry2data,data2arry);</span><br><span class="line">//NSArray to NSString</span><br><span class="line">NSString *arry2String = [array componentsJoinedByString:@&quot; &quot;];NSLog(@&quot;string = %@&quot;,arry2String);</span><br><span class="line"></span><br><span class="line">//判断数组是否为空</span><br><span class="line">有人说可以用（［array count］＝＝0 ）来判断是否为空，都是坑，如果array为空的话，执行count就会直接报错，程序崩溃退出。</span><br><span class="line">正确判断NSArray是否为空的方法：用 （!array）</span><br><span class="line"> </span><br><span class="line">if (array != nil &amp;&amp; ![array isKindOfClass:[NSNull class]] &amp;&amp; array.count != 0)&#123;</span><br><span class="line">//执行array不为空时的操作</span><br><span class="line">&#125;</span><br><span class="line">这样才是iOS判断数组是否为空的准确方式。</span><br><span class="line"></span><br><span class="line">// 数组过滤</span><br><span class="line">需求：在一个数组里面，将在这个数组中的并且在另一个数组里面的元素过滤掉。</span><br><span class="line">即：在一个数组dataArray里面，将在dataArray数组中的并且在filteredArray数组里面的元素过滤掉。</span><br><span class="line">//iOS-筛选数组内的元素//在dataArray中里面，将在dataArray中的并且在filteredArray数组里面的元素过滤掉//需要去掉的元素数组NSMutableArray *filteredArray = [[NSMutableArray alloc]initWithObjects:@&quot;1&quot;,@&quot;3&quot;,@&quot;9&quot;, nil];//需要被筛选的数组NSMutableArray *dataArray = [[NSMutableArray alloc]initWithObjects:@&quot;1&quot;,@&quot;2&quot;,@&quot;3&quot;,@&quot;1&quot;,@&quot;1&quot;,@&quot;3&quot;,@&quot;1&quot;,@&quot;5&quot;,@&quot;7&quot;, nil];/*方法一：利用NSPredicate注：NSPredicate所属Cocoa框架，在密码、用户名等正则判断中经常用到。         类似于SQL语句         NOT 不是         SELF 代表字符串本身         IN 范围运算符         那么NOT (SELF IN %@) 意思就是：不是这里所指定的字符串的值         */NSPredicate * filterPredicate = [NSPredicate predicateWithFormat:@&quot;NOT (SELF IN %@)&quot;,filteredArray];//过滤数组NSArray * reslutFilteredArray = [dataArray filteredArrayUsingPredicate:filterPredicate];NSLog(@&quot;Reslut Filtered Array = %@&quot;,reslutFilteredArray);  /*方法二：从后往前遍历数组，然后匹配删除*/int i = (int)[dataArray count]-1;        for(;i &gt;= 0;i --)&#123;            //containsObject 判断元素是否存在于数组中(根据两者的内存地址判断，相同：YES  不同：NO）            if([filteredArray containsObject:[dataArray objectAtIndex:i]]) &#123;                [dataArray removeObjectAtIndex:i];&#125;&#125;NSLog(@&quot;Data Array = %@&quot;,dataArray);</span><br><span class="line"></span><br><span class="line">//浮点数存入数组</span><br><span class="line">NSNumber *number = [NSNumber numberWithFloat:value];  </span><br><span class="line">[temparray addObject:number;  </span><br><span class="line">//取出  </span><br><span class="line">[[temparray objectAtIndex:0] floatValue]； </span><br><span class="line">需要注意几点：</span><br><span class="line"></span><br><span class="line">NSArray中只能存放对象，不能存放基本数据类型，通常我们可以通过在基本数据类型前加@进行转换；</span><br><span class="line"></span><br><span class="line">数组中的元素后面必须加nil以表示数据结束；</span><br><span class="line"></span><br><span class="line">makeObjectsPerformSelector执行数组中对象的方法，其参数最多只能有一个；</span><br><span class="line"></span><br><span class="line">上面数组操作中无论是数组的追加、删除、截取都没有改变原来的数组，只是产生了新的数组而已；</span><br><span class="line"></span><br><span class="line">对象的比较除了使用系统自带的方法，我们可以通过自定义比较器的方法来实现；</span><br></pre></td></tr></table></figure>
<ul>
<li><h5 id="可变数组"><a href="#可变数组" class="headerlink" title="可变数组"></a>可变数组</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">void test1()&#123;</span><br><span class="line">    Person *person1=[Person personWithName:@&quot;Kenshin&quot;];</span><br><span class="line">    Person *person2=[Person personWithName:@&quot;Kaoru&quot;];</span><br><span class="line">    Person *person3=[Person personWithName:@&quot;Rosa&quot;];</span><br><span class="line">    NSMutableArray *array1=[NSMutableArray arrayWithObjects:person1,person2,person3, nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;,</span><br><span class="line">         &quot;name=Rosa&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    Person *person4=[Person personWithName:@&quot;Jack&quot;];//此时person4的retainCount为1</span><br><span class="line">    [array1 addObject:person4];//添加一个元素,此时person4的retainCount为2</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;,</span><br><span class="line">         &quot;name=Rosa&quot;,</span><br><span class="line">         &quot;name=Jack&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [array1 removeObject:person3];//删除一个元素</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;,</span><br><span class="line">         &quot;name=Jack&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [array1 removeLastObject];//删除最后一个元素,//此时person4的retainCount为1</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [array1 removeAllObjects];//删除所以元素</span><br><span class="line">    </span><br><span class="line">    //注意当往数组中添加一个元素时会retain因此计数器+1，当从数组中移除一个元素时会release因此计数器-1</span><br><span class="line">    //当NSMutalbeArray对象release的时候会依次调用每一个对象的release</span><br><span class="line">&#125;</span><br><span class="line">void test2()&#123;</span><br><span class="line">    NSMutableArray *array1=[NSMutableArray arrayWithObjects:@&quot;1&quot;,@&quot;3&quot;,@&quot;2&quot;, nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         3,</span><br><span class="line">         2</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    NSArray *array2= [array1 sortedArrayUsingSelector:@selector(compare:)];//注意这个方法没有修改array1</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         3,</span><br><span class="line">         2</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;%@&quot;,array2);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    [array1 sortUsingSelector:@selector(compare:)];//这个方法会修改array1</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//补充</span><br><span class="line"></span><br><span class="line">//NSMutableArray 转json</span><br><span class="line">NSMutableArray *arr = [[NSMutableArray alloc] init];  </span><br><span class="line">NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:  </span><br><span class="line">                        @&quot;ni hao&quot;, @&quot;key&quot;,  </span><br><span class="line">                        @&quot;45&quot;, @&quot;value&quot;,  </span><br><span class="line">                        @&quot;USD&quot;, @&quot;code&quot;,nil];  </span><br><span class="line">NSDictionary *params2 = [NSDictionary dictionaryWithObjectsAndKeys:  </span><br><span class="line">                        @&quot;hao&quot;, @&quot;key&quot;,  </span><br><span class="line">                        @&quot;45&quot;, @&quot;value&quot;,  </span><br><span class="line">                        @&quot;USD&quot;, @&quot;code&quot;,nil]; </span><br><span class="line">[arr addObject:params];  </span><br><span class="line">[arr addObject:params2];  </span><br><span class="line">NSDictionary *params3 = [NSDictionary dictionaryWithObjectsAndKeys:  </span><br><span class="line">                          arr, @&quot;json&quot;,  </span><br><span class="line">                         nil nil];  </span><br><span class="line">//convert object to data  </span><br><span class="line">NSData* jsonData =[NSJSONSerialization dataWithJSONObject:params3  </span><br><span class="line">                                                  options:NSJSONWritingPrettyPrinted error:&amp;error];    </span><br><span class="line">//print out the data contents    </span><br><span class="line">NSString* text =[[NSString alloc] initWithData:jsonData  </span><br><span class="line">                                        encoding:NSUTF8StringEncoding];    </span><br><span class="line">  NSLog(@&quot;json字典里面的内容为--》%@&quot;, text );</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">可变数组中的元素后面必须加nil以表示数据结束；</span><br><span class="line"></span><br><span class="line">往一个可变数组中添加一个对象，此时这个对象的引用计数器会加1，当这个对象从可变数组中移除其引用计数器减1。同时当整个数组销毁之后会依次调</span><br><span class="line">用每个对象的releaes方法。</span><br><span class="line"></span><br><span class="line">在不可变数组中无论对数组怎么排序，原来的数组顺序都不会改变，但是在可变数组中如果使用sortUsingSelector:排序原来的数组顺序就发生了变化。</span><br></pre></td></tr></table></figure>
<ul>
<li><h5 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line">void test1()&#123;</span><br><span class="line">    NSDictionary *dic1=[NSDictionary dictionaryWithObject:@&quot;1&quot; forKey:@&quot;a&quot;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic1);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">        a = 1;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    //常用的方式</span><br><span class="line">    NSDictionary *dic2=[NSDictionary dictionaryWithObjectsAndKeys:</span><br><span class="line">                        @&quot;1&quot;,@&quot;a&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;b&quot;,</span><br><span class="line">                        @&quot;3&quot;,@&quot;c&quot;,</span><br><span class="line">                        nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic2);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 1;</span><br><span class="line">         b = 2;</span><br><span class="line">         c = 3;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    NSDictionary *dic3=[NSDictionary dictionaryWithObjects:[NSArray arrayWithObjects:@&quot;1&quot;,@&quot;2&quot;, nil] forKeys:[NSArray arrayWithObjects:@&quot;a&quot;,@&quot;b&quot;, nil]];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic3);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 1;</span><br><span class="line">         b = 2;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //更简单的方式</span><br><span class="line">    NSDictionary *dic4=@&#123;@&quot;1&quot;:@&quot;a&quot;,@&quot;2&quot;:@&quot;b&quot;,@&quot;3&quot;:@&quot;c&quot;&#125;;</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic4);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         1 = a;</span><br><span class="line">         2 = b;</span><br><span class="line">         3 = c;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line">void test2()&#123;</span><br><span class="line">    NSDictionary *dic1=[NSDictionary dictionaryWithObjectsAndKeys:</span><br><span class="line">                        @&quot;1&quot;,@&quot;a&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;b&quot;,</span><br><span class="line">                        @&quot;3&quot;,@&quot;c&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;d&quot;,</span><br><span class="line">                        nil];</span><br><span class="line">    NSLog(@&quot;%zi&quot;,[dic1 count]); //结果：4</span><br><span class="line">    NSLog(@&quot;%@&quot;,[dic1 valueForKey:@&quot;b&quot;]);//根据键取得值，结果：2</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic1[@&quot;b&quot;]);//还可以这样读取，结果：2</span><br><span class="line">    NSLog(@&quot;%@,%@&quot;,[dic1 allKeys],[dic1 allValues]);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         d,</span><br><span class="line">         b,</span><br><span class="line">         c,</span><br><span class="line">         a</span><br><span class="line">     ),(</span><br><span class="line">         2,</span><br><span class="line">         2,</span><br><span class="line">         3,</span><br><span class="line">         1</span><br><span class="line">     )</span><br><span class="line"></span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;%@&quot;,[dic1 objectsForKeys:[NSArray arrayWithObjects:@&quot;a&quot;,@&quot;e&quot; , nil]notFoundMarker:@&quot;not fount&quot;]);//后面一个参数notFoundMarker是如果找不到对应的key用什么值代替</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         &quot;not fount&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line">void test3()&#123;</span><br><span class="line">    NSDictionary *dic1=[NSDictionary dictionaryWithObjectsAndKeys:</span><br><span class="line">                        @&quot;1&quot;,@&quot;a&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;b&quot;,</span><br><span class="line">                        @&quot;3&quot;,@&quot;c&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;d&quot;,</span><br><span class="line">                        nil];</span><br><span class="line">    //遍历1</span><br><span class="line">    for (id key in dic1) &#123;//注意对于字典for遍历循环的是key</span><br><span class="line">        NSLog(@&quot;%@=%@&quot;,key,[dic1 objectForKey:key]);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     d=2</span><br><span class="line">     b=2</span><br><span class="line">     c=3</span><br><span class="line">     a=1</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    //遍历2</span><br><span class="line">    NSEnumerator *enumerator=[dic1 keyEnumerator];//还有值的迭代器[dic1 objectEnumerator]</span><br><span class="line">    id key=nil;</span><br><span class="line">    while (key=[enumerator nextObject]) &#123;</span><br><span class="line">        NSLog(@&quot;%@=%@&quot;,key,[dic1 objectForKey:key]);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     d=2</span><br><span class="line">     b=2</span><br><span class="line">     c=3</span><br><span class="line">     a=1</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    //遍历3</span><br><span class="line">    [dic1 enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) &#123;</span><br><span class="line">        NSLog(@&quot;%@=%@&quot;,key,obj);</span><br><span class="line">    &#125;];</span><br><span class="line">    /*结果：</span><br><span class="line">     d=2</span><br><span class="line">     b=2</span><br><span class="line">     c=3</span><br><span class="line">     a=1</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void test4()&#123;</span><br><span class="line">    NSMutableDictionary *dic=[NSMutableDictionary dictionaryWithObjectsAndKeys:@&quot;1&quot;,@&quot;a&quot;,</span><br><span class="line">                              @&quot;2&quot;,@&quot;b&quot;,</span><br><span class="line">                              @&quot;3&quot;,@&quot;c&quot;,</span><br><span class="line">                              @&quot;2&quot;,@&quot;d&quot;,</span><br><span class="line">                            nil];</span><br><span class="line">    [dic removeObjectForKey:@&quot;b&quot;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 1;</span><br><span class="line">         c = 3;</span><br><span class="line">         d = 2;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [dic addEntriesFromDictionary:@&#123;@&quot;e&quot;:@&quot;7&quot;,@&quot;f&quot;:@&quot;6&quot;&#125;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 1;</span><br><span class="line">         c = 3;</span><br><span class="line">         d = 2;</span><br><span class="line">         e = 7;</span><br><span class="line">         f = 6;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [dic setValue:@&quot;5&quot; forKey:@&quot;a&quot;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 5;</span><br><span class="line">         c = 3;</span><br><span class="line">         d = 2;</span><br><span class="line">         e = 7;</span><br><span class="line">         f = 6;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">     </span><br><span class="line">    </span><br><span class="line">    //注意，一个字典的key或value添加到字典中时计数器+1；字典释放时调用key或value的release一次，计数器-1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//一些补充</span><br><span class="line"></span><br><span class="line">//判断是否为空</span><br><span class="line">![listi isKindOfClass:[NSNull class]]</span><br><span class="line"></span><br><span class="line">//NSDictionary Json</span><br><span class="line">NSDictionary *dictionary  = [NSDictionary dictionaryWithObjectsAndKeys:</span><br><span class="line">myDelegate.reason,@&quot;reason&quot;,</span><br><span class="line">myDelegate.username,@&quot;userName&quot;,nil];</span><br><span class="line"></span><br><span class="line">NSError *parseError = nil;</span><br><span class="line"></span><br><span class="line">NSData* jsonData = [NSJSONSerialization dataWithJSONObject:dictionary options:NSJSONWritingPrettyPrinted error:&amp;parseError];</span><br><span class="line"></span><br><span class="line">NSString* businessData = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];</span><br><span class="line"></span><br><span class="line">//NSDictionary to NSData</span><br><span class="line">NSMutableData *dic2data = [[NSMutableData alloc] init];    NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:dic2data];    [archiver encodeObject:dic forKey:@&quot;Some Key Value&quot;];    [archiver finishEncoding];    NSLog(@&quot;%@&quot;,dic2data);</span><br><span class="line">//NSData to NSDictionaryNSKeyedUnarchiver *unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData:dic2data];    NSDictionary *data2dic = [unarchiver decodeObjectForKey:@&quot;Some Key Value&quot;];    [unarchiver finishDecoding];    NSLog(@&quot;%@&quot;,data2dic);</span><br><span class="line"></span><br><span class="line">//NSDictionary to NSStringNSString *dic2string=[dic JSONRepresentation]; //这个方法是SBJson类库里的，需要导入SBJson.hNSLog(@&quot;%@&quot;,dic2string);</span><br></pre></td></tr></table></figure>
<h2 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bool 是int</span><br><span class="line">BOOL 是char</span><br><span class="line">bool b1 当b1&gt;0 就＝YES</span><br><span class="line">BOOL b2 当b2=1 才＝YES</span><br><span class="line"></span><br><span class="line">//__NSCFBoolean 判断</span><br><span class="line">if ([[messageDic objectForKey:@&quot;myself&quot;]boolValue] == NO)</span><br><span class="line"></span><br><span class="line">//输出Bool值</span><br><span class="line">NSLog(@&quot;ifReadOnly value: %@&quot; ,ifReadOnly?@&quot;YES&quot;:@&quot;NO&quot;);</span><br></pre></td></tr></table></figure>
<h2 id="NSNumber"><a href="#NSNumber" class="headerlink" title="NSNumber"></a>NSNumber</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">NSNumber *myIntValue = @32;</span><br><span class="line">NSNumber *myDoubleValue = @3.22346432;</span><br><span class="line"></span><br><span class="line">NSNumber *myBoolValue = @YES;</span><br><span class="line">NSNumber *myCharValue = @&apos;V&apos;;</span><br><span class="line"></span><br><span class="line">可以创建 NSNumber 对象，表示无符号整型 (unsigned integers)、长整型 (long integers)、长长整型 (long</span><br><span class="line">long integers) 和浮点值 (float values)，方法是将字符“U”、“L”、“LL”和“F”分别追加到记号值末尾。例如，</span><br><span class="line">创建封装浮点值的 NSNumber 对象，可以编写如下代码：</span><br><span class="line">NSNumber *myFloatValue = @3.2F</span><br></pre></td></tr></table></figure>
<h2 id="NSUserDefaults"><a href="#NSUserDefaults" class="headerlink" title="NSUserDefaults"></a>NSUserDefaults</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//全局的NsUserDefaults	</span><br><span class="line">//AppDelegate.h文件中添加 #define appDelegate ((AppDelegate *)[[UIApplication sharedApplication] delegate])@property (assign, nonatomic)NSUserDefaults *appDefault;</span><br><span class="line">	</span><br><span class="line">//AppDelegate.m文件中添加@synthesize appDefault;appDelegate.appDefault = [NSUserDefaults standardUserDefaults];</span><br><span class="line">	</span><br><span class="line">//顺带初始化下</span><br><span class="line">[appDelegate.appDefault setObject:NULL forKey:@&quot;one&quot;];</span><br><span class="line">	</span><br><span class="line">//存数据[appDelegate.appDefault setObject:@&quot;122333&quot; forKey:@&quot;one&quot;];//读数据[appDelegate.appDefault objectForKey:@&quot;one&quot;]</span><br></pre></td></tr></table></figure>
<h2 id="NSobject"><a href="#NSobject" class="headerlink" title="NSobject"></a>NSobject</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSobject常见的类方法有:alloc、new（基本等同于[[alloc]init],缺点是无法调用initWith等方法了）、description等。</span><br></pre></td></tr></table></figure>
<h2 id="NSLocale"><a href="#NSLocale" class="headerlink" title="NSLocale"></a>NSLocale</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">NSLocale可以获取用户的本地化信息设置，例如货币类型，国家，语言，数字，日期格式的格式化，提供正确的地理位置显示等等。下面的代码获取机器当前语言和国家代码。</span><br><span class="line">//Getting the User’s Language  </span><br><span class="line">NSArray *languageArray = [NSLocale preferredLanguages];  </span><br><span class="line">NSString *language = [languageArray objectAtIndex:0];  </span><br><span class="line">NSLog(@&quot;语言：%@&quot;, language);//en  </span><br><span class="line">NSLocale *locale = [NSLocale currentLocale];  </span><br><span class="line">NSString *country = [locale localeIdentifier];  </span><br><span class="line">NSLog(@&quot;国家：%@&quot;, country); //en_US</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/25/iOS编程常用技巧/" itemprop="url">
                  iOS编程常用技巧&一些知识点
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-25T14:18:47+08:00" content="2016-05-25">
              2016-05-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>在编写iOS程序时，有一些通用的代码，在这里做一个收录，都是转自各路大神的博客，不停维护中～</p>
</blockquote>
<h5 id="项目中的controller太多，不知道具体运行的是哪一个。"><a href="#项目中的controller太多，不知道具体运行的是哪一个。" class="headerlink" title="项目中的controller太多，不知道具体运行的是哪一个。"></a>项目中的controller太多，不知道具体运行的是哪一个。</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">建立UIViewController的Category</span><br><span class="line">-(void)viewDidAppear:(BOOL)animated &#123;</span><br><span class="line">    NSLog(@&quot;===%@===&quot;,NSStringFromClass([self class]));</span><br><span class="line">&#125;</span><br><span class="line">这样在运行时就可以知道运行的是哪一个了。</span><br></pre></td></tr></table></figure>
<h6 id="如何将状态栏中的字体颜色变白"><a href="#如何将状态栏中的字体颜色变白" class="headerlink" title="如何将状态栏中的字体颜色变白"></a>如何将状态栏中的字体颜色变白</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 、将info.plist中的 View-based status bar appearance  设为 NO</span><br><span class="line">2、在对应的viewcontrolle.m里添加</span><br><span class="line"> //设置状态栏颜色    [[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleLightContent animated:NO];</span><br><span class="line">就设置成功了。</span><br></pre></td></tr></table></figure>
<h5 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">也称为延迟加载，即在需要的时候才加载（效率低，占用内存小）。所谓懒加载，写的是其get方法.</span><br><span class="line">- (NSMutableArray *)fakeData</span><br><span class="line">&#123;</span><br><span class="line">      if (!_fakeData)//判断是否已经有了，若没有，则进行实例化</span><br><span class="line">    &#123;</span><br><span class="line">        self.fakeData   = [NSMutableArray array];</span><br><span class="line">    &#125;</span><br><span class="line">    return _fakeData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">优点：</span><br><span class="line">防止对象被提前创建（内存优化，如加载plist文件等耗内存的操作）</span><br><span class="line">防止对象重复创建 （永远只加载一次）</span><br><span class="line">防止对象使用时,还没被创建</span><br><span class="line">可以在懒加载方法里面,进行初始化操作</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">懒加载代码示例</span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">[super viewDidLoad];&#125;</span><br><span class="line">- (NSArray *)shopData&#123;    if (!_shopData) &#123;        _shopData = [NSArray arrayWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@&quot;shop&quot; ofType:@&quot;plist&quot;]];    &#125;    return _shopData;&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h5 id="获取状态栏和导航栏高度、宽度信息"><a href="#获取状态栏和导航栏高度、宽度信息" class="headerlink" title="获取状态栏和导航栏高度、宽度信息"></a>获取状态栏和导航栏高度、宽度信息</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">iPhone开发当中，有时需要获取状态栏和导航栏高度、宽度信息，方便布局其他控件。下面介绍一下如何获取这些信息(可直接将结果放在全局宏中方便使用)：</span><br><span class="line">    // 状态栏(statusbar)  </span><br><span class="line">    CGRect rectStatus = [[UIApplication sharedApplication] statusBarFrame];  </span><br><span class="line">    NSLog(@&quot;status width - %f&quot;, rectStatus.size.width);   </span><br><span class="line">    NSLog(@&quot;status height - %f&quot;, rectStatus.size.height); </span><br><span class="line">      </span><br><span class="line">    // 导航栏（navigationbar）  </span><br><span class="line">    CGRect rectNav = self.navigationController.navigationBar.frame;  </span><br><span class="line">    NSLog(@&quot;nav width - %f&quot;, rectNav.size.width);   </span><br><span class="line">    NSLog(@&quot;nav height - %f&quot;, rectNav.size.height);</span><br></pre></td></tr></table></figure>
<h5 id="检测是否为手机号"><a href="#检测是否为手机号" class="headerlink" title="检测是否为手机号"></a>检测是否为手机号</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)validateMobile:(NSString *)mobileNum&#123;    NSString *regex = @&quot;^1[3|5|7|8][0-9]\\d&#123;8&#125;$&quot;;    NSPredicate *pred = [NSPredicate predicateWithFormat:@&quot;SELF MATCHES %@&quot;, regex];        if(![pred evaluateWithObject:mobileNum])    &#123;        return NO;    &#125;        else    &#123;        return YES;    &#125;&#125;</span><br></pre></td></tr></table></figure>
<h5 id="获取当前年月日及星期几"><a href="#获取当前年月日及星期几" class="headerlink" title="获取当前年月日及星期几"></a>获取当前年月日及星期几</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">NSArray * arrWeek=[NSArray arrayWithObjects:@&quot;星期日&quot;,@&quot;星期一&quot;,@&quot;星期二&quot;,@&quot;星期三&quot;,@&quot;星期四&quot;,@&quot;星期五&quot;,@&quot;星期六&quot;, nil];</span><br><span class="line">    NSDate *date = [NSDate date];</span><br><span class="line">    NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSCalendarIdentifierGregorian] ;</span><br><span class="line">    NSDateComponents *comps = [[NSDateComponents alloc] init] ;</span><br><span class="line">    NSInteger unitFlags = NSCalendarUnitYear |</span><br><span class="line">    NSCalendarUnitMonth |</span><br><span class="line">    NSCalendarUnitDay |</span><br><span class="line">    NSCalendarUnitWeekday |</span><br><span class="line">    NSCalendarUnitHour |</span><br><span class="line">    NSCalendarUnitMinute |</span><br><span class="line">    NSCalendarUnitSecond;</span><br><span class="line">    comps = [calendar components:unitFlags fromDate:date];</span><br><span class="line">    int week = [comps weekday]-1;</span><br><span class="line">    int year=[comps year];</span><br><span class="line">    int month = [comps month];</span><br><span class="line">    int day = [comps day];</span><br><span class="line">    NSString *timeForShow=[[NSString stringWithFormat:@&quot;%d年%d月%d日,&quot;,year,month,day] stringByAppendingString:[NSString stringWithFormat:@&quot;%@&quot;,[arrWeek objectAtIndex:week]]];</span><br><span class="line">    NSLog(@&quot;%@&quot;,timeForShow);</span><br></pre></td></tr></table></figure>
<h5 id="抽取controller"><a href="#抽取controller" class="headerlink" title="抽取controller"></a>抽取controller</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">当一个项目里有大量的controller时，可以抽取出一个通用的basicController这样可以总体的设置某些属性。</span><br><span class="line">#import &quot;SDBasicViewContoller.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation SDBasicViewContoller</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    self.view.backgroundColor = [UIColor whiteColor];</span><br><span class="line">    </span><br><span class="line">    [self.navigationItem.backBarButtonItem setTitleTextAttributes:@&#123;NSFontAttributeName : [UIFont systemFontOfSize:5]&#125; forState:UIControlStateNormal];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//这样的话可以通用的设置整体的属性</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h5 id="返回按钮只留下白色箭头"><a href="#返回按钮只留下白色箭头" class="headerlink" title="返回按钮只留下白色箭头"></a>返回按钮只留下白色箭头</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[UIBarButtonItem appearance] setBackButtonTitlePositionAdjustment:UIOffsetMake(0, -60)                                                        forBarMetrics:UIBarMetricsDefault];</span><br></pre></td></tr></table></figure>
<h5 id="获取当前时间"><a href="#获取当前时间" class="headerlink" title="获取当前时间"></a>获取当前时间</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSDate *timeDate=[NSDate date];    NSDateFormatter * dateformatter=[[NSDateFormatter alloc] init];    [dateformatter setDateFormat:@&quot;YYYYMMddHHmmsssss&quot;];    NSString *locationString=[dateformatter stringFromDate:timeDate];</span><br></pre></td></tr></table></figure>
<h5 id="判断一个类是否存在"><a href="#判断一个类是否存在" class="headerlink" title="判断一个类是否存在"></a>判断一个类是否存在</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">我们在开发的过程中难免会用到低版本中没有的类，如果我们想让我们的应用尽可能的兼容多个版本，我们需要考虑。</span><br><span class="line">Class pkClass=NSClassFromString(@&quot;PKAddPassesViewController&quot;);</span><br><span class="line">    if (pkClass) &#123;</span><br><span class="line">     NSLog(@&quot;available&quot;);</span><br><span class="line">// 如果可以使用，我们可以使用passkit的一些功能</span><br><span class="line">    &#125;else</span><br><span class="line">    &#123;  NSLog(@&quot;unavailable&quot;);</span><br><span class="line">如果不可以，我们就要提示用户，或者进行一些其他的处理</span><br><span class="line">  &#125;</span><br><span class="line">NSString *pkClassStr=NSStringFromClass([PKAddPassesViewController class]);</span><br><span class="line">    if (pkClassStr) &#123;</span><br><span class="line">        NSLog(@&quot;available&quot;);</span><br><span class="line">// 如果可以使用，我们可以使用passkit的一些功能</span><br><span class="line">    &#125;else &#123;</span><br><span class="line"> NSLog(@&quot;unavailable&quot;);</span><br><span class="line">如果不可以，我们就要提示用户，或者进行一些其他的处理</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h5 id="退出应用"><a href="#退出应用" class="headerlink" title="退出应用"></a>退出应用</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">带有一些动画效果：</span><br><span class="line">AppDelegate *app = [UIApplication sharedApplication].delegate;UIWindow *window = app.window;     [UIView animateWithDuration:0.4f animations:^&#123;     window.alpha = 0;     CGFloat y = window.bounds.size.height;     CGFloat x = window.bounds.size.width / 2;     window.frame = CGRectMake(x, y, 0, 0);&#125; completion:^(BOOL finished) &#123;     exit(0);&#125;];</span><br></pre></td></tr></table></figure>
<h5 id="截屏"><a href="#截屏" class="headerlink" title="截屏"></a>截屏</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-(void)snapshot</span><br><span class="line">&#123;</span><br><span class="line">    //开启上下文</span><br><span class="line">    UIGraphicsBeginImageContext(self.view.bounds.size);</span><br><span class="line">    //拿到上下文</span><br><span class="line">    CGContextRef context=UIGraphicsGetCurrentContext();</span><br><span class="line">    [self.view.layer renderInContext:context];</span><br><span class="line">    UIImage *image=UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line">    UIGraphicsEndImageContext();</span><br><span class="line">    //保存到相册</span><br><span class="line">    UIImageWriteToSavedPhotosAlbum(image, self, @selector(image:didFinishSavingWithError:contextInfo:), nil);</span><br><span class="line">&#125;</span><br><span class="line">- (void)image:(UIImage *)image didFinishSavingWithError:(NSError *)error contextInfo:(void *)contextInfo</span><br><span class="line">&#123;</span><br><span class="line">    if (!error) &#123;</span><br><span class="line">        NSLog(@&quot;save success&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="应用中的数据存储"><a href="#应用中的数据存储" class="headerlink" title="应用中的数据存储"></a>应用中的数据存储</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">集中存储的方式：</span><br><span class="line">1 属性列表</span><br><span class="line">2 Preference（NSUserDefaults）</span><br><span class="line">3 键值归档（NSKeyeArchiver,NSCoding）</span><br><span class="line">4 SQLite数据库</span><br><span class="line">5 Core Data </span><br><span class="line"></span><br><span class="line">NSUserDefaults只支持： NSString, NSNumber, NSDate, NSArray, NSDictionary.</span><br><span class="line">NSUserDefaults适合存储轻量级的本地数据，比如要保存一个登陆界面的数据，用户名、密码之类的，个人觉得使用NSUserDefaults是首选。下次再登陆的时候就可以直接从NSUserDefaults里面读取上次登陆的信息咯。</span><br><span class="line">用NSUserDefaults存储的数据下次程序运行的时候依然存在，它把数据存储在什么地方了？如何能够清除？</span><br><span class="line">其实它存储在应用程序内置的一个plist文件里。</span><br></pre></td></tr></table></figure>
<h5 id="判断邮箱格式"><a href="#判断邮箱格式" class="headerlink" title="判断邮箱格式"></a>判断邮箱格式</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">判断邮箱格式是否正确的代码：</span><br><span class="line">	// 利用正则表达式验证 -( BOOL )isValidateEmail:( NSString  *)email  </span><br><span class="line">	&#123;  </span><br><span class="line">	NSString  *emailRegex =  @&quot;[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]&#123;2,4&#125;&quot; ;  </span><br><span class="line">	NSPredicate  *emailTest = [ NSPredicate   predicateWithFormat : @&quot;SELF MATCHES%@&quot; ,emailRegex];  </span><br><span class="line">	return  [emailTest  evaluateWithObject :email];  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">所有 init开头的方法都是构造函数，withxxx 就是带不同参数的构造函数。</span><br><span class="line">在前面的代码中我们已经看到如果要初始化一个类需要调用init方法，那么下面看一下如何自定义构造方法</span><br><span class="line">Person.h</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line">@interface Person : NSObject</span><br><span class="line">@property NSString *name;@property int age;</span><br><span class="line">-(id)initWithName:(NSString *)name andAge:(int )age;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">Person.m</span><br><span class="line">#import &quot;Person.h&quot;</span><br><span class="line">@implementation Person</span><br><span class="line">//自定义构造方法-(id)initWithName:(NSString *)name andAge:(int)age&#123;    if(self=[super init])&#123; //super代表父类，这是苹果推荐的写法        self.name=name;        self.age=age;    &#125;    return self;&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">main.m</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;#import &quot;Person.h&quot;</span><br><span class="line">int main(int argc, const char * argv[]) &#123;        Person *p=[[Person alloc]initWithName:@&quot;Kenshin&quot; andAge:28];    NSLog(@&quot;name=%@,age=%i&quot;,p.name,p.age);    //结果：name=Kenshin,age=28    return 0;&#125;</span><br><span class="line">在ObjC中super代表父类，通过调用父类的方法给当前对象赋值，然后判断这个对象是否为nil，如果不为空则依次给name、age属性赋值。</span><br></pre></td></tr></table></figure>
<h5 id="判断程序是否为第一次启动"><a href="#判断程序是否为第一次启动" class="headerlink" title="判断程序是否为第一次启动"></a>判断程序是否为第一次启动</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(![[NSUserDefaults standardUserDefaults] boolForKey:@&quot;firstLaunch&quot;])&#123;        [[NSUserDefaults standardUserDefaults] setBool:YES forKey:@&quot;firstLaunch&quot;];        NSLog(@&quot;第一次启动&quot;);        [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@&quot;isLogin&quot;];</span><br><span class="line">&#125;else&#123;        NSLog(@&quot;已经不是第一次启动了&quot;);    &#125;</span><br></pre></td></tr></table></figure>
<h5 id="处理标签字符串中的空格-换行-t-制表符-等"><a href="#处理标签字符串中的空格-换行-t-制表符-等" class="headerlink" title="处理标签字符串中的空格,换行,/t(制表符)等"></a>处理标签字符串中的空格,换行,/t(制表符)等</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (NSString *)replaceStringWithString :(NSMutableString *)string&#123;    NSString *string1 = [string stringByReplacingOccurrencesOfString:@&quot;\n&quot; withString:@&quot;&quot;] ;    NSString *string2 = [string1 stringByReplacingOccurrencesOfString:@&quot; &quot; withString:@&quot;&quot;] ;    NSString *string3 = [string2 stringByReplacingOccurrencesOfString:@&quot;\r&quot; withString:@&quot;&quot;] ;    NSString *string4 = [string3 stringByReplacingOccurrencesOfString:@&quot;\t&quot; withString:@&quot;&quot;] ;    return string4 ;&#125;</span><br><span class="line">`</span><br></pre></td></tr></table></figure>
<h5 id="UIImage与字符串互转"><a href="#UIImage与字符串互转" class="headerlink" title="UIImage与字符串互转"></a>UIImage与字符串互转</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//图片转字符串  -(NSString *)UIImageToBase64Str:(UIImage *) image  &#123;      NSData *data = UIImageJPEGRepresentation(image, 1.0f);      NSString *encodedImageStr = [data base64EncodedStringWithOptions:NSDataBase64Encoding64CharacterLineLength];      return encodedImageStr;  &#125;</span><br><span class="line">//字符串转图片  -(UIImage *)Base64StrToUIImage:(NSString *)_encodedImageStr  &#123;      NSData *_decodedImageData   = [[NSData alloc] initWithBase64Encoding:_encodedImageStr];      UIImage *_decodedImage      = [UIImage imageWithData:_decodedImageData];      return _decodedImage;  &#125;</span><br></pre></td></tr></table></figure>
<h5 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line">===点语法的本质是getter/setter方法调用于</span><br><span class="line"></span><br><span class="line">setter/getter里面不能使用self，会造死循环</span><br><span class="line"></span><br><span class="line">SEL其实是对方法的一种包装，将方法包装成一个SEL类型的数据，去找对应的方法地址。找到地址就可以调用方法。其实消息就是SEL</span><br><span class="line"></span><br><span class="line">===僵尸对象：所占用内存已经被回收的对象，僵尸对象不能再使用</span><br><span class="line"></span><br><span class="line">===野指针：指向僵尸对象(不可用内存)的指针，给野指针发消息会报错(EXEC_BAD_ACCESS)</span><br><span class="line"></span><br><span class="line">===空指针：没有指向任何东西的指针(存的东西是0, NULL, nil)，给空指针发消息不报错</span><br><span class="line">BOOL类型property一般指定getter方法格式为isMethod, e.g.:@property (getter=isRich) BOOL rich;</span><br><span class="line"></span><br><span class="line">===当一个对象调用autorelease方法时，会将整个对象方放到栈顶的释放池</span><br><span class="line"></span><br><span class="line">===创建对象时不要直接调用类名，一般用self.e.g.</span><br><span class="line"></span><br><span class="line">===类的本质是对象。是Class类型的对象，简称类对象。 typedef struct objc_class *Class. 类名就代表着类对象，每个类只有一个类对象</span><br><span class="line"></span><br><span class="line">===NSUserDefaults 里面不能够存储UIViewController实例或者其示例数组</span><br><span class="line"></span><br><span class="line">===创建视图控制器的时候，最好不要在初始化方法中做与视图相关的操作(getter)，可能引发循环调用</span><br><span class="line"></span><br><span class="line">===ARC的特点：</span><br><span class="line">不允许调用release、retain、retainCount方法</span><br><span class="line">允许重写dealloc、但是不允许调用[super dealloc]</span><br><span class="line">@property的参数</span><br><span class="line">strong: 相当于retain(适用于OC对象类型)</span><br><span class="line">weak: 相当于assign(适用于OC对象类型)</span><br><span class="line">assign: 适用于非OC对象类型</span><br><span class="line">MRC的retain改为strong(循环引用的时使用：一端用strong，一端用weak)</span><br><span class="line"></span><br><span class="line">===weak &amp; Outlet:</span><br><span class="line">当我们使用Outlet属性的时候，我们是在viewController里面使用，而这个Outlet属性是有view来进行强引用的，我们在viewController里面仅仅是对其使用，并没有必要拥有它，所以是weak的。</span><br><span class="line"></span><br><span class="line">===.h .m属性:</span><br><span class="line">属性在.h文件中和在.m中声明是有区别的。区别就是，在.h文件中声明的属性，外部类可以通过“类实例.属性”来调用但在.m中声明的则不可以，获取和设置的方法，只能是通过setValue:forKey和valueForKey来实现。</span><br><span class="line"></span><br><span class="line">===awakeFromNib：</span><br><span class="line">当.nib文件被加载的时候，会发送一个awakeFromNib的消息到.nib文件中的每个对象，每个对象都可以定义自己的awakeFromNib函数来响应这个消息，执行一些必要的操作。</span><br><span class="line">也就是说只有通过.nib文件创建view对象时才会执行awakeFromNib 。</span><br><span class="line">一般的，当IB加载的时候，我们会通过调用自定义对象的awakeFromNib函数，来对界面进行补充。</span><br><span class="line">选择的时机：当你需要写一个UIView的子类并且想在load nib的时候做一些初始化工作的时候很有用。bundle在load nib后会给每个view对象发送一个awakeFromNib消息。</span><br><span class="line"></span><br><span class="line">===@interace</span><br><span class="line">1. 继承</span><br><span class="line">2. 声明协议</span><br><span class="line">3. 定义实例变量（@interface后面加大括号那种）</span><br><span class="line">4. 定义@property</span><br><span class="line">5. 声明方法</span><br><span class="line">.h里面的@interface，不消说，是典型的头文件，它是供其它Class调用的。它的@property和functions，都能够被其它Class“看到”。</span><br><span class="line">而.m里面的@interface，在OC里叫作Class Extension，是.h文件中@interface的补充。但是.m文件里的@interface，对外是不开放的，只在.m文件里可见。</span><br><span class="line">因此，我们将对外开放的方法、变量放到.h文件中，而将不想要对外开放的变量放到.m文件中（.m文件的方法可以不声明，直接用）。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===@implementation</span><br><span class="line"></span><br><span class="line">1. 继承</span><br><span class="line">2. 定义实例变量</span><br><span class="line">3. 合成属性（@synthesize和@dynamic）</span><br><span class="line">实现方法（包括协议方法）</span><br><span class="line"></span><br><span class="line">@selector设置string为方法:</span><br><span class="line">NSString *selName = [NSString stringWithFormat@&quot;button%i&quot;, i];SEL selector = NSSelectorFromString(selName);</span><br><span class="line">[button1 addTarget:self action:selector forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===在输出系统中封装的结构体和类时尝试调用NSStringFromXXX经常可以输出</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===对象、消息、运行期</span><br><span class="line">&quot;属性&quot;概念</span><br><span class="line">@property：编译器会自动写出一套存取方法，用以访问给定类型中具有给定名称的变量。</span><br><span class="line">@interface TestPeople : NSObject</span><br><span class="line">@property NSString * name;@property NSString * age;</span><br><span class="line">@end</span><br><span class="line">等同于</span><br><span class="line">@interface TestPeople : NSObject</span><br><span class="line">- (NSString *)name;- (void)setName:(NSString *)name;- (NSString *)age;- (void)setAge:(NSString *)age;</span><br><span class="line">@end</span><br><span class="line">在类的实现代码里通过@synthesize语法来指定实例变量的名字(不写@synthesize也可以，调用就是self.xxx就可以)</span><br><span class="line"> @implementation TestPeople</span><br><span class="line">@synthesize name = _myName;@synthesize age = _myAge;</span><br><span class="line">@end</span><br><span class="line">属性特征 </span><br><span class="line">readwrite：拥有“获取方法”和“设置方法”，可读可写。</span><br><span class="line"></span><br><span class="line">readonly：仅仅拥有“获取方法”,只可读。</span><br><span class="line"></span><br><span class="line">assign：“设置方法”只会执行针对“纯量类型”（CGFloat,NSINteger）的简单赋值操作。</span><br><span class="line"></span><br><span class="line">strong：为这种属性设置新值的时候，设置方法会先保留新值，并释放旧值，然后再将新值设置上去。</span><br><span class="line"></span><br><span class="line">weak：为这种属性设置新值的时候，设置方法不保留新值，也不释放旧值，但是在属性所指的对象遭到销毁的时候，属性值会清空。</span><br><span class="line"></span><br><span class="line">copy:设置方法并不保留新值，而是将其拷贝。特别是像 NSString *，因为其传递给设置的新值可能指向一个NSMutableString类的实例，当值变化后，拷贝了的情况会保证字符串值不会无意间变动。</span><br><span class="line"></span><br><span class="line">atomic：默认是有该属性的，这个属性是为了保证程序在多线程情况下，编译器会自动生成一些互斥加锁代码，避免该变量的读写不同步问题。</span><br><span class="line"></span><br><span class="line">nonatomic：如果该对象无需考虑多线程的情况，请加入这个属性，这样会让编译器少生成一些互斥加锁代码，可以提高效率。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===在.m中的声明@interface</span><br><span class="line"></span><br><span class="line">//in Header.h</span><br><span class="line">@interface Header&#123;&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">//in Header.m</span><br><span class="line">@interface Header()</span><br><span class="line">@end</span><br><span class="line">这是个非常常见的设计,为什么在.m文件里面,也要出现一个接口声明呢?</span><br><span class="line">这很类似于一个分类,但其实它不是一个分类(或者你也可以叫它anonymous Catogary),其实这是一个叫做class extension的东西</span><br><span class="line"> </span><br><span class="line">说说区别:</span><br><span class="line">1.  首先 extension 可以重声明一个数据成员,比如一个数据成员是只读的,你可以把它变成可读写</span><br><span class="line">2.  分类根本不同意你扩展数据成员,它只扩展一些方法, 但是在Clang/LLVM 2.0 compiler 以后, extension可以这么做.</span><br><span class="line">3.  有时候,你如果希望实现一些不公开的方法供自己使用,那你可以把它放入.m的extension里面.那么这些接口都是不公开的了</span><br><span class="line"></span><br><span class="line">===不要再viewWillAppear中做费时的操作，只进行背景色、字体等设置</span><br><span class="line"></span><br><span class="line">使用多线程来延迟加载资源、如图片</span><br><span class="line"></span><br><span class="line">View 的复用和懒加载机制：</span><br><span class="line"></span><br><span class="line">当你的程序中需要展示很多的 View 的时候，这就意味着需要更多的 CPU 处理时间和内存空间，这个情况对程序性能的影响在你使用 UIScrollView 来装载和呈现界面时会变得尤为显著。</span><br><span class="line">处理这种情况的一种方案就是向 UITableView 和 UICollectionView 学习，不要一次性把所有的 subviews 都创建出来，而是在你需要他们的时候创建，并且用复用机制去复用他们。这样减少了内存分配的开销，节省了内存空间。</span><br><span class="line">「懒加载机制」就是把创建对象的时机延后到不得不需要它们的时候。这个机制常常用在对一个类的属性的初始化上，比如：</span><br><span class="line"></span><br><span class="line">- (UITableView *)myTableView &#123;</span><br><span class="line">if (!_myTableView) &#123;</span><br><span class="line">CGRect viewBounds = self.view.bounds;</span><br><span class="line">_myTableView = [[UITableView alloc] initWithFrame:viewBounds style:UITableViewStylePlain];</span><br><span class="line">_myTableView.showsHorizontalScrollIndicator = NO;</span><br><span class="line">_myTableView.showsVerticalScrollIndicator = NO;</span><br><span class="line">_myTableView.backgroundColor = [UIColor whiteColor];</span><br><span class="line">[_myTableView setSeparatorStyle:UITableViewCellSeparatorStyleNone];</span><br><span class="line">_myTableView.dataSource = self;</span><br><span class="line">_myTableView.delegate = self;</span><br><span class="line">&#125;</span><br><span class="line">return _myTableView;</span><br><span class="line">&#125;</span><br><span class="line">只有当我们第一次用到 self.myTableView 的时候采取初始化和创建它。</span><br><span class="line">但是，存在这样一种场景：你点击一个按钮的时候，你需要显示一个 View，这时候你有两种实现方案：</span><br><span class="line">• 1）在当前界面第一次加载的时候就创建出这个 View，只是把它隐藏起来，当你需要它的时候，只用显示它就行了。</span><br><span class="line">• 2）使用「懒加载机制」，在你需要这个 View 的时候才创建它，并展示它。</span><br><span class="line">这两种方案都各有利弊。采用方案一，你在不需要这个 View 的时候显然白白地占用了更多的内存，但是当你点击按钮展示它的时候，你的程序能响应地相对较快，因为你只需要改变它的 hidden 属性。采用方案二，那么你得到的效果相反，你更准确的使用了内存，但是如果对这个 View 的初始化和创建比较耗时，那么响应性相对就没那么好了。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===imageNamed 和 imageWithContentsOfFile</span><br><span class="line"></span><br><span class="line">在 iOS 应用中加载图片通常有 - [UIImage imageNamed:] 和 -[UIImage imageWithContentsOfFile:] 两种方式。它们的不同在于前者会对图片进行缓存，而后者只是简单的从文件加载文件。</span><br><span class="line">UIImage *img = [UIImage imageNamed:@&quot;myImage&quot;]; // caching</span><br><span class="line">// or</span><br><span class="line">UIImage *img = [UIImage imageWithContentsOfFile:@&quot;myImage&quot;]; // no caching</span><br><span class="line">在整个程序运行的过程中，当你需要加载一张较大的图片，并且只会使用它一次，那么你就没必要缓存这个图片，这时你可以使用 -[UIImage imageWithContentsOfFile:]，这样系统也不会浪费内存来做缓存了。当然，如果你会多次使用到一张图时，用 - [UIImage imageNamed:] 就会高效很多，因为这样就不用每次都从硬盘上加载图片了。</span><br><span class="line"></span><br><span class="line">=== IBAction &amp; IBOutlet</span><br><span class="line"></span><br><span class="line">从界面上的一个控件 Control+drag 拖一个方法到代码的实现区，会得到类似：</span><br><span class="line">-(IBAction) touchCardButton:(UIButton*)sender;</span><br><span class="line">这里的 IBAction 其实返回的是 void，类似 typedef IBAction void。IBAction 是为了让 Xcode 去区别方法是不是 target action，这样我们可以做到鼠标在上面的时候界面会高亮对应的控件之类的。但是编译器会忽略它，对编译器来说它就是 void。当你要改这个方法名的时候，有点麻烦的是你需要对着对应的控件点右键，然后叉掉方法绑定，然后重新连接。</span><br><span class="line">从界面上的一个控件 Control+drag 拖一个方法到代码的属性区，会得到类似：</span><br><span class="line">@property (weak, nonatomic) IBOutlet UILabel* flipsLabel;</span><br><span class="line">的UI属性。这里一定是一个 weak 的属性，因为这个属性是被 View 所 strong 持有的，对 Controller 来说只应该 weak 地指向它。这里的 IBOutlet 跟 IBAction 的意思差不多，主要是方便 Xcode用它，编译器会忽略它。</span><br></pre></td></tr></table></figure>
<h5 id="时间处理"><a href="#时间处理" class="headerlink" title="时间处理"></a>时间处理</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">===输出当前时间</span><br><span class="line">NSDate *currentDate = [NSDate date];//获取当前时间，日期</span><br><span class="line">NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];</span><br><span class="line">[dateFormatter setDateFormat:@&quot;YYYY/MM/dd hh:mm:ss&quot;];</span><br><span class="line">NSString *dateString = [dateFormatter stringFromDate:currentDate];</span><br><span class="line">NSLog(@&quot;dateString1:%@&quot;,dateString);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===UTC/GMT</span><br><span class="line">- (NSDate *)getNowDateFromatAnDate:(NSDate *)anyDate  </span><br><span class="line">&#123;  </span><br><span class="line">    //设置源日期时区  </span><br><span class="line">    NSTimeZone* sourceTimeZone = [NSTimeZone timeZoneWithAbbreviation:@&quot;UTC&quot;];//或GMT  </span><br><span class="line">    //设置转换后的目标日期时区  </span><br><span class="line">    NSTimeZone* destinationTimeZone = [NSTimeZone localTimeZone];  </span><br><span class="line">    //得到源日期与世界标准时间的偏移量  </span><br><span class="line">    NSInteger sourceGMTOffset = [sourceTimeZone secondsFromGMTForDate:anyDate];  </span><br><span class="line">    //目标日期与本地时区的偏移量  </span><br><span class="line">    NSInteger destinationGMTOffset = [destinationTimeZone secondsFromGMTForDate:anyDate];  </span><br><span class="line">    //得到时间偏移量的差值  </span><br><span class="line">    NSTimeInterval interval = destinationGMTOffset - sourceGMTOffset;  </span><br><span class="line">    //转为现在时间  </span><br><span class="line">    NSDate* destinationDateNow = [[[NSDate alloc] initWithTimeInterval:interval sinceDate:anyDate] autorelease];  </span><br><span class="line">    return destinationDateNow;  </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">===//NSString 2 NSDate</span><br><span class="line">- (NSDate *)stringToDate:(NSString *)strdate</span><br><span class="line">&#123;</span><br><span class="line">    NSDateFormatter *dateFormatter = [[NSDateFormatteralloc] init];</span><br><span class="line">    [dateFormatter setDateFormat:@&quot;yyyy-MM-dd HH:mm:ss&quot;];</span><br><span class="line">    NSDate *retdate = [dateFormatter dateFromString:strdate];</span><br><span class="line">    [dateFormatter release];</span><br><span class="line">    return retdate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">===//NSDate 2 NSString</span><br><span class="line">- (NSString *)dateToString:(NSDate *)date</span><br><span class="line">&#123;</span><br><span class="line">    NSDateFormatter *dateFormatter = [[NSDateFormatteralloc] init];</span><br><span class="line">    [dateFormatter setDateFormat:@&quot;yyyy-MM-dd HH:mm:ss&quot;];</span><br><span class="line">    NSString *strDate = [dateFormatter stringFromDate:date];</span><br><span class="line">    [dateFormatter release];</span><br><span class="line">    return strDate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===//将本地日期字符串转为UTC日期字符串  </span><br><span class="line">//本地日期格式:2013-08-03 12:53:51  </span><br><span class="line">//可自行指定输入输出格式  </span><br><span class="line">-(NSString *)getUTCFormateLocalDate:(NSString *)localDate  </span><br><span class="line">&#123;  </span><br><span class="line">    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];  </span><br><span class="line">    //输入格式  </span><br><span class="line">    [dateFormatter setDateFormat:@&quot;yyyy-MM-dd HH:mm:ss&quot;];  </span><br><span class="line">      </span><br><span class="line">    NSDate *dateFormatted = [dateFormatter dateFromString:localDate];  </span><br><span class="line">    NSTimeZone *timeZone = [NSTimeZone timeZoneWithName:@&quot;UTC&quot;];  </span><br><span class="line">    [dateFormatter setTimeZone:timeZone];  </span><br><span class="line">    //输出格式  </span><br><span class="line">    [dateFormatter setDateFormat:@&quot;yyyy-MM-dd&apos;T&apos;HH:mm:ssZ&quot;];  </span><br><span class="line">    NSString *dateString = [dateFormatter stringFromDate:dateFormatted];  </span><br><span class="line">    [dateFormatter release];  </span><br><span class="line">    return dateString;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">===//将UTC日期字符串转为本地时间字符串  </span><br><span class="line">//输入的UTC日期格式2013-08-03T04:53:51+0000  </span><br><span class="line">-(NSString *)getLocalDateFormateUTCDate:(NSString *)utcDate  </span><br><span class="line">&#123;  </span><br><span class="line">    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];  </span><br><span class="line">    //输入格式  </span><br><span class="line">    [dateFormatter setDateFormat:@&quot;yyyy-MM-dd&apos;T&apos;HH:mm:ssZ&quot;];  </span><br><span class="line">    NSTimeZone *localTimeZone = [NSTimeZone localTimeZone];  </span><br><span class="line">    [dateFormatter setTimeZone:localTimeZone];  </span><br><span class="line">      </span><br><span class="line">    NSDate *dateFormatted = [dateFormatter dateFromString:utcDate];  </span><br><span class="line">    //输出格式  </span><br><span class="line">    [dateFormatter setDateFormat:@&quot;yyyy-MM-dd HH:mm:ss&quot;];  </span><br><span class="line">    NSString *dateString = [dateFormatter stringFromDate:dateFormatted];  </span><br><span class="line">    [dateFormatter release];  </span><br><span class="line">    return dateString;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">===//通过传入时间utc/gmt转为现在本地时间的字符串</span><br><span class="line">- (NSString *)getNowDateFromatAnDate:(NSDate *)anyDate</span><br><span class="line">&#123;</span><br><span class="line">    //设置源日期时区</span><br><span class="line">    NSTimeZone* sourceTimeZone = [NSTimeZone timeZoneWithAbbreviation:@&quot;UTC&quot;];//或GMT</span><br><span class="line">    //设置转换后的目标日期时区</span><br><span class="line">    NSTimeZone* destinationTimeZone = [NSTimeZone localTimeZone];</span><br><span class="line">    //得到源日期与世界标准时间的偏移量</span><br><span class="line">    NSInteger sourceGMTOffset = [sourceTimeZone secondsFromGMTForDate:anyDate];</span><br><span class="line">    //目标日期与本地时区的偏移量</span><br><span class="line">    NSInteger destinationGMTOffset = [destinationTimeZone secondsFromGMTForDate:anyDate];</span><br><span class="line">    //得到时间偏移量的差值</span><br><span class="line">    NSTimeInterval interval = destinationGMTOffset - sourceGMTOffset;</span><br><span class="line">    //转为现在时间</span><br><span class="line">    NSDate* destinationDateNow = [[NSDate alloc] initWithTimeInterval:interval sinceDate:anyDate] ;</span><br><span class="line">    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];</span><br><span class="line">    //输出格式</span><br><span class="line">    [dateFormatter setDateFormat:@&quot;yyyy-MM-dd HH:mm:ss&quot;];</span><br><span class="line">    NSTimeZone *timeZone = [NSTimeZone timeZoneWithName:@&quot;GMT&quot;];</span><br><span class="line">    [dateFormatter setTimeZone:timeZone];</span><br><span class="line">    NSString *dateString = [dateFormatter stringFromDate:destinationDateNow];</span><br><span class="line">    return dateString;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="获取设备版本"><a href="#获取设备版本" class="headerlink" title="获取设备版本"></a>获取设备版本</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (NSString*)deviceVersion&#123;    // 需要#import &quot;sys/utsname.h&quot;    struct utsname systemInfo;    uname(&amp;systemInfo);    NSString *deviceString = [NSString stringWithCString:systemInfo.machine encoding:NSUTF8StringEncoding];    //iPhone    if ([deviceString isEqualToString:@&quot;iPhone1,1&quot;])    return @&quot;iPhone 1G&quot;;    if ([deviceString isEqualToString:@&quot;iPhone1,2&quot;])    return @&quot;iPhone 3G&quot;;    if ([deviceString isEqualToString:@&quot;iPhone2,1&quot;])    return @&quot;iPhone 3GS&quot;;    if ([deviceString isEqualToString:@&quot;iPhone3,1&quot;])    return @&quot;iPhone 4&quot;;    if ([deviceString isEqualToString:@&quot;iPhone3,2&quot;])    return @&quot;Verizon iPhone 4&quot;;    if ([deviceString isEqualToString:@&quot;iPhone4,1&quot;])    return @&quot;iPhone 4S&quot;;    if ([deviceString isEqualToString:@&quot;iPhone5,1&quot;])    return @&quot;iPhone 5&quot;;    if ([deviceString isEqualToString:@&quot;iPhone5,2&quot;])    return @&quot;iPhone 5&quot;;    if ([deviceString isEqualToString:@&quot;iPhone5,3&quot;])    return @&quot;iPhone 5C&quot;;    if ([deviceString isEqualToString:@&quot;iPhone5,4&quot;])    return @&quot;iPhone 5C&quot;;    if ([deviceString isEqualToString:@&quot;iPhone6,1&quot;])    return @&quot;iPhone 5S&quot;;    if ([deviceString isEqualToString:@&quot;iPhone6,2&quot;])    return @&quot;iPhone 5S&quot;;    if ([deviceString isEqualToString:@&quot;iPhone7,1&quot;])    return @&quot;iPhone 6 Plus&quot;;    if ([deviceString isEqualToString:@&quot;iPhone7,2&quot;])    return @&quot;iPhone 6&quot;;    if ([deviceString isEqualToString:@&quot;iPhone8,1&quot;])    return @&quot;iPhone 6s&quot;;    if ([deviceString isEqualToString:@&quot;iPhone8,2&quot;])    return @&quot;iPhone 6s Plus&quot;;        //iPod    if ([deviceString isEqualToString:@&quot;iPod1,1&quot;])      return @&quot;iPod Touch 1G&quot;;    if ([deviceString isEqualToString:@&quot;iPod2,1&quot;])      return @&quot;iPod Touch 2G&quot;;    if ([deviceString isEqualToString:@&quot;iPod3,1&quot;])      return @&quot;iPod Touch 3G&quot;;    if ([deviceString isEqualToString:@&quot;iPod4,1&quot;])      return @&quot;iPod Touch 4G&quot;;    if ([deviceString isEqualToString:@&quot;iPod5,1&quot;])      return @&quot;iPod Touch 5G&quot;;        //iPad    if ([deviceString isEqualToString:@&quot;iPad1,1&quot;])      return @&quot;iPad&quot;;    if ([deviceString isEqualToString:@&quot;iPad2,1&quot;])      return @&quot;iPad 2 (WiFi)&quot;;    if ([deviceString isEqualToString:@&quot;iPad2,2&quot;])      return @&quot;iPad 2 (GSM)&quot;;    if ([deviceString isEqualToString:@&quot;iPad2,3&quot;])      return @&quot;iPad 2 (CDMA)&quot;;    if ([deviceString isEqualToString:@&quot;iPad2,4&quot;])      return @&quot;iPad 2 (32nm)&quot;;    if ([deviceString isEqualToString:@&quot;iPad2,5&quot;])      return @&quot;iPad mini (WiFi)&quot;;    if ([deviceString isEqualToString:@&quot;iPad2,6&quot;])      return @&quot;iPad mini (GSM)&quot;;    if ([deviceString isEqualToString:@&quot;iPad2,7&quot;])      return @&quot;iPad mini (CDMA)&quot;;        if ([deviceString isEqualToString:@&quot;iPad3,1&quot;])      return @&quot;iPad 3(WiFi)&quot;;    if ([deviceString isEqualToString:@&quot;iPad3,2&quot;])      return @&quot;iPad 3(CDMA)&quot;;    if ([deviceString isEqualToString:@&quot;iPad3,3&quot;])      return @&quot;iPad 3(4G)&quot;;    if ([deviceString isEqualToString:@&quot;iPad3,4&quot;])      return @&quot;iPad 4 (WiFi)&quot;;    if ([deviceString isEqualToString:@&quot;iPad3,5&quot;])      return @&quot;iPad 4 (4G)&quot;;    if ([deviceString isEqualToString:@&quot;iPad3,6&quot;])      return @&quot;iPad 4 (CDMA)&quot;;        if ([deviceString isEqualToString:@&quot;iPad4,1&quot;])      return @&quot;iPad Air&quot;;    if ([deviceString isEqualToString:@&quot;iPad4,2&quot;])      return @&quot;iPad Air&quot;;    if ([deviceString isEqualToString:@&quot;iPad4,3&quot;])      return @&quot;iPad Air&quot;;    if ([deviceString isEqualToString:@&quot;iPad5,3&quot;])      return @&quot;iPad Air 2&quot;;    if ([deviceString isEqualToString:@&quot;iPad5,4&quot;])      return @&quot;iPad Air 2&quot;;    if ([deviceString isEqualToString:@&quot;i386&quot;])         return @&quot;Simulator&quot;;    if ([deviceString isEqualToString:@&quot;x86_64&quot;])       return @&quot;Simulator&quot;;        if ([deviceString isEqualToString:@&quot;iPad4,4&quot;]        ||[deviceString isEqualToString:@&quot;iPad4,5&quot;]        ||[deviceString isEqualToString:@&quot;iPad4,6&quot;])      return @&quot;iPad mini 2&quot;;        if ([deviceString isEqualToString:@&quot;iPad4,7&quot;]        ||[deviceString isEqualToString:@&quot;iPad4,8&quot;]        ||[deviceString isEqualToString:@&quot;iPad4,9&quot;])      return @&quot;iPad mini 3&quot;;        return deviceString;&#125;</span><br></pre></td></tr></table></figure>
<h5 id="代码风格"><a href="#代码风格" class="headerlink" title="代码风格"></a>代码风格</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line">===多用字面量语法，少用与之等价的方法</span><br><span class="line">推荐：</span><br><span class="line"></span><br><span class="line">//字面量令代码中更为整洁 NSNumber * someNumber = @1; NSArray   * someArray = @[@&quot;1&quot;,@&quot;2&quot;]; NSDictionary * someDictionary = @&#123;@&quot;one&quot;:@1,@&quot;two&quot;:@2&#125;;</span><br><span class="line"></span><br><span class="line">//取值 NSString * one = someArray[0]; NSNumber * oneNumber = someDictionary[@&quot;one&quot;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===多用类型常量，少用#define预处理指令</span><br><span class="line">#define YANG_ANIMATION_DURATION 0.5  // 转换为static const NSTimeInterval yangAnimationDuration = 0.3;</span><br><span class="line"></span><br><span class="line">当然我们用到更多的是在编译单元之外的&quot;全局符号表&quot;：</span><br><span class="line">// .m 文件中 NSString * const LoginMethod =  @&quot;loginRequestHandler&quot;;  // .h 文件中 UIKIT_EXTERN NSString * const LoginMethod;</span><br><span class="line"></span><br><span class="line">不要用预处理指令定义常量。 这样定义出来的常量不含类型信息，编译器只是会在编译前据此执行查找与替换操作，即使有人重新定义了常量值，编译器也不会产生，导致应用程序中的常量值不一致。</span><br><span class="line"></span><br><span class="line">在实现文件中使用 static const 来定义“只在编译单元内可见的常量”；</span><br><span class="line">头文件中使用 UIKIT_EXTERN来声明全局常量，并在相关实现文件中定义其值。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===用枚举表示状态、选项、状态码</span><br><span class="line">当使用 enum 的时候，建议使用新的固定的基础类型定义，因它有更强大的的类型检查和代码补全。 SDK 现在有一个宏来鼓励和促进使用固定类型定义 - NS_ENUM()</span><br><span class="line">typedef NS_ENUM(NSUInteger, YangMachineState) &#123;      YangMachineStateNone,      YangMachineStateIdle,      YangMachineStateRunning,      YangMachineStatePaused&#125;;</span><br><span class="line">在处理枚举类型的switch 语句中不要实现default分支。这样的话，假如新枚举之后编译器就会提示我们开发者：switch 语句并未处理所有枚举。</span><br><span class="line"></span><br><span class="line">===推荐的代码书写方式</span><br><span class="line">Preferred:</span><br><span class="line">if (!error) &#123;    return success;&#125;</span><br><span class="line">Not preferred:</span><br><span class="line">if (!error)    return success;</span><br><span class="line">or</span><br><span class="line">if (!error) return success;</span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">- (void)someMethod &#123;  if (![someOther boolValue]) &#123;      return;  &#125;</span><br><span class="line">//Do something important&#125;</span><br><span class="line">Not preferred:</span><br><span class="line">- (void)someMethod &#123;  if ([someOther boolValue]) &#123;    //Do something important  &#125;&#125;</span><br><span class="line">Preferred:</span><br><span class="line">if ([myValue isEqual:@42]) &#123; ...</span><br><span class="line">Not preferred:</span><br><span class="line">if ([@42 isEqual:myValue]) &#123; ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">if (someObject) &#123; ...if (![someObject boolValue]) &#123; ...if (!someObject) &#123; ...</span><br><span class="line">Not Preferred:</span><br><span class="line">if (someObject == YES) &#123; ... // Wrongif (myRawValue == YES) &#123; ... // Never do this.if ([someObject boolValue] == NO) &#123; ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">- (void)someMethod &#123;  if (![someOther boolValue]) &#123;      return;  &#125;</span><br><span class="line">//Do something important&#125;</span><br><span class="line">Not preferred:</span><br><span class="line">- (void)someMethod &#123;  if ([someOther boolValue]) &#123;    //Do something important  &#125;&#125;</span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">BOOL nameContainsSwift  = [sessionName containsString:@&quot;Swift&quot;];BOOL isCurrentYear      = [sessionDateCompontents year] == 2014;BOOL isSwiftSession     = nameContainsSwift &amp;&amp; isCurrentYear;</span><br><span class="line">if (isSwiftSession) &#123;    // Do something very cool&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">result = a &gt; b ? x : y;</span><br><span class="line">Not preferred:</span><br><span class="line">result = a &gt; b ? x = c &gt; d ? c : d : y;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">result = object ? : [self createObject];</span><br><span class="line">Not preferred:</span><br><span class="line">result = object ? object : [self createObject];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Case Statements</span><br><span class="line">case的几种形式：</span><br><span class="line">switch (condition) &#123;    case 1:        // ...        break;    case 2: &#123;        // ...        // Multi-line example using braces        break;       &#125;    case 3:        // ...        break;    default:         // ...        break;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">switch (condition) &#123;    case 1:    case 2:        // code executed for values 1 and 2        break;    default:         // ...        break;&#125;</span><br><span class="line"></span><br><span class="line">When using an enumerated type for a switch, default is not needed. For example:</span><br><span class="line">switch (menuType) &#123;    case ZOCEnumNone:        // ...        break;    case ZOCEnumValue1:        // ...        break;    case ZOCEnumValue2:        // ...        break;&#125;</span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">UIButton *settingsButton;</span><br><span class="line">Not Preferred:</span><br><span class="line">UIButton *setBut;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">static const NSTimeInterval ZOCSignInViewControllerFadeOutAnimationDuration = 0.4;</span><br><span class="line">Not Preferred:</span><br><span class="line">static const NSTimeInterval fadeOutTime = 0.4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">static NSString * const ZOCCacheControllerDidClearCacheNotification = @&quot;ZOCCacheControllerDidClearCacheNotification&quot;;static const CGFloat ZOCImageThumbnailHeight = 50.0f;</span><br><span class="line">Not Preferred:</span><br><span class="line">#define CompanyName @&quot;Apple Inc.&quot;#define magicNumber 42</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Methods:</span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">- (void)setExampleText:(NSString *)text image:(UIImage *)image;- (void)sendAction:(SEL)aSelector to:(id)anObject forAllCells:(BOOL)flag;- (id)viewWithTag:(NSInteger)tag;- (instancetype)initWithWidth:(CGFloat)width height:(CGFloat)height;</span><br><span class="line">Not Preferred:</span><br><span class="line">- (void)setT:(NSString *)text i:(UIImage *)image;- (void)sendAction:(SEL)aSelector :(id)anObject :(BOOL)flag;- (id)taggedView:(NSInteger)tag;- (instancetype)initWithWidth:(CGFloat)width andHeight:(CGFloat)height;- (instancetype)initWith:(int)width and:(int)height;  // Never do this.</span><br><span class="line"></span><br><span class="line">init methods should be structured like this:</span><br><span class="line">- (instancetype)init&#123;    self = [super init]; // call the designated initializer    if (self) &#123;        // Custom initialization    &#125;    return self;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Designated and Secondary Initializers</span><br><span class="line">@implementation ZOCEvent</span><br><span class="line">- (instancetype)initWithTitle:(NSString *)title                         date:(NSDate *)date                     location:(CLLocation *)location&#123;    self = [super init];    if (self) &#123;        _title    = title;        _date     = date;        _location = location;    &#125;    return self;&#125;</span><br><span class="line">- (instancetype)initWithTitle:(NSString *)title                         date:(NSDate *)date&#123;    return [self initWithTitle:title date:date location:nil];&#125;</span><br><span class="line">- (instancetype)initWithTitle:(NSString *)title&#123;    return [self initWithTitle:title date:[NSDate date] location:nil];&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A typical example is whether you create a UIViewController subclass overriding initWithNibName:bundle::</span><br><span class="line">@implementation ZOCViewController</span><br><span class="line">- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil&#123;    // call to the superclass designated initializer    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];    if (self) &#123;        // Custom initialization    &#125;    return self;&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> Let&apos;s see an example of the correct way to implement this:</span><br><span class="line">@implementation ZOCNewsViewController</span><br><span class="line">- (id)initWithNews:(ZOCNews *)news&#123;    // call to the immediate superclass&apos;s designated initializer    self = [super initWithNibName:nil bundle:nil];    if (self) &#123;        _news = news;    &#125;    return self;&#125;</span><br><span class="line">// Override the immediate superclass&apos;s designated initializer- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil&#123;    // call the new designated initializer    return [self initWithNews:nil];&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Singleton</span><br><span class="line">+ (instancetype)sharedInstance&#123;   static id sharedInstance = nil;   static dispatch_once_t onceToken = 0;   dispatch_once(&amp;onceToken, ^&#123;      sharedInstance = [[self alloc] init];   &#125;);   return sharedInstance;&#125;</span><br><span class="line">The use of dispatch_once(), which is synchronous, replaces the following, yet obsolete, idiom:</span><br><span class="line">+ (instancetype)sharedInstance&#123;    static id sharedInstance;    @synchronized(self) &#123;        if (sharedInstance == nil) &#123;            sharedInstance = [[MyClass alloc] init];        &#125;    &#125;    return sharedInstance;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Properties</span><br><span class="line">For example:</span><br><span class="line">NSString *text;</span><br><span class="line">Not:</span><br><span class="line">NSString* text;NSString * text;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">For example:</span><br><span class="line">view.backgroundColor = [UIColor orangeColor];[UIApplication sharedApplication].delegate;</span><br><span class="line">Not:</span><br><span class="line">[view setBackgroundColor:[UIColor orangeColor]];UIApplication.sharedApplication.delegate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Property Declaration</span><br><span class="line">@property (nonatomic, readwrite, copy) NSString *name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In order to achieve a public getter and a private setter, you can declare the public property as readonly and re-declare the same property in the the class extension as readwrite:</span><br><span class="line">@interface MyClass : NSObject@property (nonatomic, readonly) NSObject *object@end</span><br><span class="line">@implementation MyClass ()@property (nonatomic, readwrite, strong) NSObject *object@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Private Properties</span><br><span class="line">For example:</span><br><span class="line">@interface ZOCViewController ()@property (nonatomic, strong) UIView *bannerView;@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Lazy Loading</span><br><span class="line">- (NSDateFormatter *)dateFormatter &#123;  if (!_dateFormatter) &#123;    _dateFormatter = [[NSDateFormatter alloc] init];        NSLocale *enUSPOSIXLocale = [[NSLocale alloc] initWithLocaleIdentifier:@&quot;en_US_POSIX&quot;];        [dateFormatter setLocale:enUSPOSIXLocale];        [dateFormatter setDateFormat:@&quot;yyyy-MM-dd&apos;T&apos;HH:mm:ss.SSSSS&quot;];  &#125;  return _dateFormatter;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A complete pattern for the isEqual* method should be as so:</span><br><span class="line">- (BOOL)isEqual:(id)object &#123;    if (self == object) &#123;      return YES;    &#125;</span><br><span class="line">if (![object isKindOfClass:[ZOCPerson class]]) &#123;      return NO;    &#125;</span><br><span class="line">return [self isEqualToPerson:(ZOCPerson *)object];&#125;</span><br><span class="line">- (BOOL)isEqualToPerson:(Person *)person &#123;    if (!person) &#123;        return NO;    &#125;</span><br><span class="line">BOOL namesMatch = (!self.name &amp;&amp; !person.name) ||                       [self.name isEqualToString:person.name];    BOOL birthdaysMatch = (!self.birthday &amp;&amp; !person.birthday) ||                           [self.birthday isEqualToDate:person.birthday];</span><br><span class="line">return haveEqualNames &amp;&amp; haveEqualBirthdays;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Categories</span><br><span class="line">Example:</span><br><span class="line">@interface NSDate (ZOCTimeExtensions)- (NSString *)zoc_timeAgoShort;@end</span><br><span class="line">Not:</span><br><span class="line">@interface NSDate (ZOCTimeExtensions)- (NSString *)timeAgoShort;@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface NSDate : NSObject &lt;NSCopying, NSSecureCoding&gt;</span><br><span class="line">@property (readonly) NSTimeInterval timeIntervalSinceReferenceDate;</span><br><span class="line">@end</span><br><span class="line">@interface NSDate (NSDateCreation)</span><br><span class="line">+ (instancetype)date;+ (instancetype)dateWithTimeIntervalSinceNow:(NSTimeInterval)secs;+ (instancetype)dateWithTimeIntervalSinceReferenceDate:(NSTimeInterval)ti;+ (instancetype)dateWithTimeIntervalSince1970:(NSTimeInterval)secs;+ (instancetype)dateWithTimeInterval:(NSTimeInterval)secsToBeAdded sinceDate:(NSDate *)date;// ...@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Beautifying the code</span><br><span class="line">Preferred:</span><br><span class="line">if (user.isHappy) &#123;    //Do something&#125;else &#123;    //Do something else&#125;</span><br><span class="line">Not Preferred:</span><br><span class="line">if (user.isHappy)&#123;  //Do something&#125; else &#123;  //Do something else&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">[UIView animateWithDuration:1.0                 animations:^&#123;                     // something                 &#125;                 completion:^(BOOL finished) &#123;                     // something                 &#125;];</span><br><span class="line">Not Preferred:</span><br><span class="line">[UIView animateWithDuration:1.0 animations:^&#123;    // something &#125; completion:^(BOOL finished) &#123;    // something&#125;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSURL *url = (&#123;    NSString *urlString = [NSString stringWithFormat:@&quot;%@/%@&quot;, baseURLString, endpoint];    [NSURL URLWithString:urlString];&#125;);</span><br><span class="line"></span><br><span class="line">warning</span><br><span class="line">- (float)divide:(float)dividend by:(float)divisor&#123;    #warning Dude, don&apos;t compare floating point numbers like this!    if (divisor != 0.0) &#123;        return (dividend / divisor);    &#125;    else &#123;        return NAN;    &#125;&#125;</span><br></pre></td></tr></table></figure>
<h5 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">===描述一下iOS的内存管理，在开发中对于内存的使用和优化包含哪些方面。我们在开发中应该注意哪些问题。</span><br><span class="line">参考答案：</span><br><span class="line"></span><br><span class="line">内存管理准则：谁强引用过，谁就在不再使用时使引用计数减一。</span><br><span class="line">对于内存的使用和优化常见的有以下方面：</span><br><span class="line">重用问题：如UITableViewCells、UICollectionViewCells、UITableViewHeaderFooterViews设置正确的reuseIdentifier，充分重用。</span><br><span class="line">尽量把views设置为不透明：当opque为NO的时候，图层的半透明取决于图片和其本身合成的图层为结果，可提高性能。</span><br><span class="line">不要使用太复杂的XIB/Storyboard：载入时就会将XIB/storyboard需要的所有资源，包括图片全部载入内存，即使未来很久才会使用。那些相比纯代码写的延迟加载，性能及内存就差了很多。</span><br><span class="line">选择正确的数据结构：学会选择对业务场景最合适的数组结构是写出高效代码的基础。比如，数组: 有序的一组值。使用索引来查询很快，使用值查询很慢，插入/删除很慢。字典: 存储键值对，用键来查找比较快。集合: 无序的一组值，用值来查找很快，插入/删除很快。</span><br><span class="line">gzip/zip压缩：当从服务端下载相关附件时，可以通过gzip/zip压缩后再下载，使得内存更小，下载速度也更快。</span><br><span class="line">延迟加载：对于不应该使用的数据，使用延迟加载方式。对于不需要马上显示的视图，使用延迟加载方式。比如，网络请求失败时显示的提示界面，可能一直都不会使用到，因此应该使用延迟加载。</span><br><span class="line">数据缓存：对于cell的行高要缓存起来，使得reload数据时，效率也极高。而对于那些网络数据，不需要每次都请求的，应该缓存起来，可以写入数据库，也可以通过plist文件存储。</span><br><span class="line">处理内存警告：一般在基类统一处理内存警告，将相关不用资源立即释放掉</span><br><span class="line">重用大开销对象：一些objects的初始化很慢，比如NSDateFormatter和NSCalendar，但又不可避免地需要使用它们。通常是作为属性存储起来，防止反复创建。</span><br><span class="line">避免反复处理数据：许多应用需要从服务器加载功能所需的常为JSON或者XML格式的数据。在服务器端和客户端使用相同的数据结构很重要。</span><br><span class="line">使用Autorelease Pool：在某些循环创建临时变量处理数据时，自动释放池以保证能及时释放内存。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===深复制和浅复制的区别：</span><br><span class="line">浅复制只复制指向对象的指针，而不复制引用对象的本身。深层复制复制对象的本身。</span><br><span class="line">意思就是说我有个A对象，复制一份后得到A_copy对象，对于浅复制来说，A和A_copy指向的是同一个内存资源，复制的只不过是一个指针，对象本身的资源还是只有一份，当对A_copy执行修改操作时，我们发现A引用的对象同样被修改，深复制对象中存在了两份独立的对象本身，浅复制好比你和你的影子，你完蛋，影子也完蛋，深复制好比克隆人，你完蛋，克隆人还活着。</span><br><span class="line"></span><br><span class="line">===什么情况使用 weak 关键字，相比 assign 有什么不同？</span><br><span class="line">什么情况使用 weak 关键字？</span><br><span class="line">在 ARC 中,在有可能出现循环引用的时候,往往要通过让其中一端使用 weak 来解决,比如: delegate 代理属性。</span><br><span class="line">自身已经对它进行一次强引用,没有必要再强引用一次,此时也会使用 weak,自定义 IBOutlet 控件属性一般也使用 weak；当然，也可以使用strong。在下文也有论述：《IBOutlet连出来的视图属性为什么可以被设置成weak?》</span><br><span class="line">不同点：</span><br><span class="line">weak 此特质表明该属性定义了一种“非拥有关系” (nonowning relationship)。为这种属性设置新值时，设置方法既不保留新值，也不释放旧值。此特质同assign类似， 然而在属性所指的对象遭到摧毁时，属性值也会清空(nil out)。 而assign 的“设置方法”只会执行针对“纯量类型” (scalar type，例如 CGFloat 或 NSlnteger 等)的简单赋值操作。</span><br><span class="line">assigin 可以用非 OC 对象,而 weak 必须用于 OC 对象</span><br><span class="line"></span><br><span class="line">===怎么用 copy 关键字？</span><br><span class="line">用途：</span><br><span class="line">NSString、NSArray、NSDictionary 等等经常使用copy关键字，是因为他们有对应的可变类型：NSMutableString、NSMutableArray、NSMutableDictionary；</span><br><span class="line">block 也经常使用 copy 关键字</span><br><span class="line"></span><br><span class="line">@property 的本质是什么？</span><br><span class="line">@property = ivar + getter + setter;</span><br><span class="line">下面解释下：</span><br><span class="line">“属性” (property)有两大概念：ivar（实例变量）、存取方法（access method ＝ getter + setter）。</span><br><span class="line">“属性” (property)作为 Objective-C 的一项特性，主要的作用就在于封装对象中的数据。 Objective-C 对象通常会把其所需要的数据保存为各种实例变量。实例变量一般通过“存取方法”(access method)来访问。其中，“获取方法” (getter)用于读取变量值，而“设置方法” (setter)用于写入变量值。这个概念已经定型，并且经由“属性”这一特性而成为 Objective-C 2.0 的一部分。 而在正规的 Objective-C 编码风格中，存取方法有着严格的命名规范。 正因为有了这种严格的命名规范，所以 Objective-C 这门语言才能根据名称自动创建出存取方法。其实也可以把属性当做一种关键字，其表示:</span><br><span class="line">编译器会自动写出一套存取方法，用以访问给定类型中具有给定名称的变量。 所以你也可以这么说：</span><br><span class="line">@property = getter + setter;</span><br><span class="line">例如下面这个类：</span><br><span class="line">@interface Person : NSObject@property NSString *firstName;@property NSString *lastName;@end</span><br><span class="line">上述代码写出来的类与下面这种写法等效：</span><br><span class="line">@interface Person : NSObject- (NSString *)firstName;- (void)setFirstName:(NSString *)firstName;- (NSString *)lastName;- (void)setLastName:(NSString *)lastName;@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===ARC下，不显式指定任何属性关键字时，默认的关键字都有哪些？</span><br><span class="line">对应基本数据类型默认关键字是atomic,readwrite,assign</span><br><span class="line">对于普通的 Objective-C 对象atomic,readwrite,strong</span><br><span class="line"></span><br><span class="line">===一个objc对象的isa的指针指向什么？有什么作用？</span><br><span class="line">指向他的类对象,从而可以找到对象上的方法</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===objc中的类方法和实例方法有什么本质区别和联系？</span><br><span class="line">类方法：</span><br><span class="line">	类方法是属于类对象的</span><br><span class="line">	类方法只能通过类对象调用</span><br><span class="line">	类方法中的self是类对象</span><br><span class="line">	类方法可以调用其他的类方法</span><br><span class="line">	类方法中不能访问成员变量</span><br><span class="line">	类方法中不定直接调用对象方法</span><br><span class="line">实例方法：</span><br><span class="line">	实例方法是属于实例对象的</span><br><span class="line">	实例方法只能通过实例对象调用</span><br><span class="line">	实例方法中的self是实例对象</span><br><span class="line">	实例方法中可以访问成员变量</span><br><span class="line">	实例方法中直接调用实例方法</span><br><span class="line">	实例方法中也可以调用类方法(通过类名)</span><br><span class="line"></span><br><span class="line">===iOS 的沙盒目录结构是怎样的？ App Bundle 里面都有什么？</span><br><span class="line">	1.沙盒结构</span><br><span class="line">	Application：存放程序源文件，上架前经过数字签名，上架后不可修改</span><br><span class="line">	Documents：常用目录，iCloud备份目录，存放数据,这里不能存缓存文件,否则上架不被通过</span><br><span class="line">	Library</span><br><span class="line">	Caches：存放体积大又不需要备份的数据,SDWebImage缓存路径就是这个</span><br><span class="line">	Preference：设置目录，iCloud会备份设置信息</span><br><span class="line">	tmp：存放临时文件，不会被备份，而且这个文件下的数据有可能随时被清除的可能</span><br><span class="line">	2.App Bundle 里面有什么</span><br><span class="line">	Info.plist:此文件包含了应用程序的配置信息.系统依赖此文件以获取应用程序的相关信息</span><br><span class="line">	可执行文件:此文件包含应用程序的入口和通过静态连接到应用程序target的代码</span><br><span class="line">	资源文件:图片,声音文件一类的</span><br><span class="line">	其他:可以嵌入定制的数据资源</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">===Objective-C 如何对已有的方法，添加自己的功能代码以实现类似记录日志这样的功能？</span><br><span class="line">	这题目主要考察的是runtime如何交换方法</span><br><span class="line">	先在分类中添加一个方法,注意不能重写系统方法,会覆盖</span><br><span class="line">	+ (NSString *)myLog&#123;    // 这里写打印行号,什么方法,哪个类调用等等&#125;</span><br><span class="line">	然后交换方法</span><br><span class="line">	// 加载分类到内存的时候调用+ (void)load&#123;    // 获取imageWithName方法地址    Method description = class_getClassMethod(self, @selector(description));</span><br><span class="line">	// 获取imageWithName方法地址    Method myLog = class_getClassMethod(self, @selector(myLog));</span><br><span class="line">	// 交换方法地址，相当于交换实现方式    method_exchangeImplementations(description, myLog);&#125;</span><br><span class="line"></span><br><span class="line">===strong / weak / unsafe_unretained 的区别？</span><br><span class="line">weak只能修饰OC对象,使用weak不会使计数器加1,对象销毁时修饰的对象会指向nil</span><br><span class="line">strong等价与retain,能使计数器加1,且不能用来修饰数据类型</span><br><span class="line">unsafe_unretained等价与assign,可以用来修饰数据类型和OC对象,但是不会使计数器加1,且对象销毁时也不会将对象指向nil,容易造成野指针错误</span><br><span class="line"></span><br><span class="line">===如何为 Class 定义一个对外只读对内可读写的属性?</span><br><span class="line">在头文件中将属性定义为readonly,在.m文件中将属性重新定义为readwrite</span><br><span class="line"></span><br><span class="line">===frame 和 bounds 的区别是什么？</span><br><span class="line">frame相对于父视图,是父视图坐标系下的位置和大小。bounds相对于自身,是自身坐标系下的位置和大小。</span><br><span class="line">frame以父控件的左上角为坐标原点，bounds以自身的左上角为坐标原点</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">====Instancetype:</span><br><span class="line"></span><br><span class="line">@interface NSArray  </span><br><span class="line">+ (id)constructAnArray;  </span><br><span class="line">@end  </span><br><span class="line">当我们使用如下方式初始化NSArray时：</span><br><span class="line">[NSArray constructAnArray];  </span><br><span class="line">根据Cocoa的方法命名规范，得到的返回类型就和方法声明的返回类型一样，是id</span><br><span class="line"></span><br><span class="line">@interface NSArray  </span><br><span class="line">+ (instancetype)constructAnArray;  </span><br><span class="line">@end  </span><br><span class="line">当使用相同方式初始化NSArray时：</span><br><span class="line">1. [NSArray constructAnArray];  </span><br><span class="line">得到的返回类型和方法所在类的类型相同，是NSArray*</span><br><span class="line">instancetype的作用，就是使那些非关联返回类型的方法返回所在类的类型！</span><br><span class="line">①instancetype可以返回和方法所在类相同类型的对象，id只能返回未知类型的对象；</span><br><span class="line">②instancetype只能作为返回值，不能像id那样作为参数，比如下面的写法</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===面试题：请把字符串2015-04-10格式化日期转为NSDate类型</span><br><span class="line">NSString *timeStr = @&quot;2015-04-10&quot;;</span><br><span class="line">NSDateFormatter *formatter = [[NSDateFormatter alloc] init];</span><br><span class="line">formatter.dateFormat = @&quot;yyyy-MM-dd&quot;;</span><br><span class="line">formatter.timeZone = [NSTimeZone defaultTimeZone];</span><br><span class="line">NSDate *date = [formatter dateFromString:timeStr];</span><br><span class="line">// 2015-04-09 16:00:00 +0000</span><br><span class="line">NSLog(@&quot;%@&quot;, date);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/25/自定义UINavigationController/" itemprop="url">
                  自定义UINavigationController
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-25T12:07:22+08:00" content="2016-05-25">
              2016-05-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>在开发iOS项目时，经常会遇到设置导航栏的颜色，返回按钮样式，是否隐藏二级的tarbar等操作，将UINavigationController封装起来是一个比较好的选择。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">@interface GwbNavigationController : UINavigationController</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GwbNavigationController.h&quot;</span><br><span class="line"></span><br><span class="line">@interface GwbNavigationController ()&lt;UIGestureRecognizerDelegate&gt;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GwbNavigationController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    self.interactivePopGestureRecognizer.delegate = self;</span><br><span class="line">    [self setupNavigationBar];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)setupNavigationBar</span><br><span class="line">&#123;</span><br><span class="line">    UINavigationBar *appearance = [UINavigationBar appearance];</span><br><span class="line">    //统一设置导航栏颜色，如果单个界面需要设置，可以在viewWillAppear里面设置，在viewWillDisappear设置回统一格式。</span><br><span class="line">    [appearance setBarTintColor:NAVBLUECOLOR];</span><br><span class="line">    NSMutableDictionary *textAttribute = [NSMutableDictionary dictionary];</span><br><span class="line">    textAttribute[NSForegroundColorAttributeName] = [UIColor whiteColor];</span><br><span class="line">    textAttribute[NSFontAttributeName] = [UIFont systemFontOfSize:15];</span><br><span class="line">    [appearance setTitleTextAttributes:textAttribute];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)pushViewController:(UIViewController *)viewController animated:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    if (self.viewControllers.count &gt; 0) &#123;</span><br><span class="line">        viewController.hidesBottomBarWhenPushed = YES;</span><br><span class="line">        UIButton *backButton = [[UIButton alloc]initWithFrame:CGRectMake(0, 0, 22, 22)];</span><br><span class="line">        [backButton setImage:[UIImage imageNamed:@&quot;back&quot;] forState:UIControlStateNormal];</span><br><span class="line">        [backButton setImage:[UIImage imageNamed:@&quot;back&quot;] forState:UIControlStateHighlighted];</span><br><span class="line">        [backButton setImageEdgeInsets:UIEdgeInsetsMake(0, -20, 0, 0)];</span><br><span class="line">        [backButton addTarget:self action:@selector(popView) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">        viewController.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc]initWithCustomView:backButton];</span><br><span class="line">    &#125;</span><br><span class="line">    [super pushViewController:viewController animated:animated];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)popView</span><br><span class="line">&#123;</span><br><span class="line">    [self popViewControllerAnimated:YES];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//手势代理</span><br><span class="line">- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer</span><br><span class="line">&#123;</span><br><span class="line">    return self.childViewControllers.count &gt; 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在使用普通controller时如果需要使用导航栏则需要嵌入到NavigationController中。</span><br><span class="line">使用方式如下：</span><br><span class="line"> UIViewController *firstNavigationController = [[GwbNavigationController alloc]</span><br><span class="line">                                                       initWithRootViewController:firstViewController];</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/24/Mac下搭建hexo博客/" itemprop="url">
                  Mac系统下hexo3.x&github搭建博客
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-24T23:10:50+08:00" content="2016-05-24">
              2016-05-24
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>上篇文章记录了在windows系统下的搭建过程，这次补充一下在Mac系统下的搭建过程，整体大同小异，重点纪录几个异常，供大家参考。</p>
</blockquote>
<hr>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><ol>
<li><p>Homebrew安装（Homebrew简称brew，是Mac OSX上的软件包管理工具，能在Mac中方便的安装软件或者卸载软件）<a href="http://brew.sh/index_zh-cn.html" target="_blank" rel="external">这里</a></p>
</li>
<li><p>安装node.js </p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br><span class="line">使用以下命令验证是否安装成功</span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure>
<p>   3.Hexo安装<br>   npm install hexo -g </p>
<hr>
<h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><ul>
<li>确定在git上创建完项目之后，执行如下命令<br>npm install hexo-deployer-git –save</li>
<li>修改config.yml文件</li>
</ul>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy: </span><br><span class="line">  type: git </span><br><span class="line">  repo: https://github.com/username/username.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>
<ul>
<li>依次执行如下命令<br>1.hexo clean<br>2.hexo g<br>3.hexo d<br>如不报错，则部署成功，访问username.github.io即可。</li>
</ul>
<hr>
<h1 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h1><p>Segmentation fault: 11<br>如有如上异常，cd到项目目录下重新执行npm rebuild。再次执行命令，可能还会报错，但不影响使用。如果还不能使用则再次执行npm install hexo-deployer-git –save，重新cd到项目目录下执行上边的部署命令即可(也可尝试多次执行部署命令)。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/19/windows下hexo-github搭建博客/" itemprop="url">
                  windows下用hexo3.x&GitHub创建个人博客
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-19T18:10:50+08:00" content="2016-05-19">
              2016-05-19
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>昨天用hexo&amp;GitHub创建了个人博客，网上很多教程是针对的hexo2.x的，有些小坑，在这记录一下，供需要的人参考。</p>
</blockquote>
<hr>
<h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><ul>
<li>安装node.js<a href="http://jingyan.baidu.com/article/b0b63dbfca599a4a483070a5.html" target="_blank" rel="external">这里</a>  </li>
<li>创建git<a href="http://jingyan.baidu.com/article/455a9950abe0ada167277864.html" target="_blank" rel="external">这里</a></li>
<li>Git Bash<a href="http://jingyan.baidu.com/article/90895e0fb3495f64ed6b0b50.html" target="_blank" rel="external">这里</a> (用windows的命令行执行hexo deploy时可能出现Error: spawn ENOENT)</li>
<li>安装hexo (安装好了msysGit和Node.js软件后，打开Git Bash，执行以下命令开始安装：npm install -g hexo)</li>
</ul>
<hr>
<h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><p>1.登录git创建个人项目，项目名：username.github.io（这个是固定的）<br>2.我们可以新建一个目录，然后在cd到该目录下执行以下命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo init //初始化</span><br><span class="line">hexo g    //生成静态页</span><br><span class="line">hexo s    //启动本地服务 在浏览器中打开 http://localhost:4000/可访问</span><br></pre></td></tr></table></figure></p>
<p>3.配置.yml文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">在当前项目目录下找到_config.yml在最底部编辑如下内容</span><br><span class="line"></span><br><span class="line"># Deployment</span><br><span class="line">## Docs: http://hexo.io/docs/deployment.html</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: https://github.com/username/username.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure></p>
<p>4.部署到GitHub<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">继续执行如下命令</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line">如果无异常，则部署成功，等待几分钟，访问username.github.io就可以访问到主页</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>别的使用心得，后续介绍;-)</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="spike" />
          <p class="site-author-name" itemprop="name">spike</p>
          <p class="site-description motion-element" itemprop="description">小郭的编程之路</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">18</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">spike</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  
  

  

  

</body>
</html>
