<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>CALayer | spike</title>
  <meta name="author" content="John Doe">
  
  <meta name="description" content="在iOS中，你能看得见摸得着的东西基本上都是UIView，比如一个按钮、一个文本标签、一个文本输入框、一个图标等等，这些都是UIView。其实UIView之所以能显示在屏幕上，完全是因为它内部的一个图层，在创建UIView对象时，UIView内部会自动创建一个图层(即CALayer对象)，通过UIView的layer属性可以访问这个层@property(nonatomic,readonly,retain) CALayer *layer;当UIView需要显示到屏幕上时，会调用drawRect:方法进行绘图，并且会将所有内容绘制在自己的图层（CALayer）上，绘图完毕后，系统会将图层拷贝到屏幕上，于是就完成了UIView的显示换句话说，UIView本身不具备显示的功能，拥有显示功能的是它内部的图层。NSObject–&amp;gt;CALayer">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="CALayer"/>
  <meta property="og:site_name" content="spike"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="spike" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/css/sidenav.css" media="screen" type="text/css">  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  

</head>

<body id="body" data-spy="scroll" data-target=".toc">
  <div class="container" id="container">
	<div class="content">
	  <div class="page-header">		
  <h1><a class="brand" href="/">spike</a><span class="split"></span><span class="title">CALayer</span><span class="date" id="title-date"><i class="fa fa-clock-o"></i> 2016-07-06</span></h1>
</div>		

<div class="row page">
  <!-- cols -->	
  
  

  
	<div class="col-md-12">
	  

	  <!-- content -->
	  <blockquote>
<p>在iOS中，你能看得见摸得着的东西基本上都是UIView，比如一个按钮、一个文本标签、一个文本输入框、一个图标等等，这些都是UIView。<br>其实UIView之所以能显示在屏幕上，完全是因为它内部的一个图层，在创建UIView对象时，UIView内部会自动创建一个图层(即CALayer对象)，通过UIView的layer属性可以访问这个层<br>@property(nonatomic,readonly,retain) CALayer *layer;<br>当UIView需要显示到屏幕上时，会调用drawRect:方法进行绘图，并且会将所有内容绘制在自己的图层（CALayer）上，绘图完毕后，系统会将图层拷贝到屏幕上，于是就完成了UIView的显示<br>换句话说，UIView本身不具备显示的功能，拥有显示功能的是它内部的图层。<br>NSObject–&gt;CALayer</p>
</blockquote>
<a id="more"></a>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>UIView之所以能够显示，完全是因为内部的CALayer对象。因此，通过操作这个CALayer对象，可以很方便地调整UIView的一些界面属性，比如：阴影、圆角大小、边框宽度和颜色等。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">示例1：</span><br><span class="line">新建一个项目，在storyboard中添加一个view.</span><br><span class="line">1.通过layer设置边框的宽度和颜色</span><br><span class="line"> </span><br><span class="line">#import &quot;YYViewController.h&quot;</span><br><span class="line"></span><br><span class="line">@interface YYViewController ()</span><br><span class="line">@property (weak, nonatomic) IBOutlet UIView *customView;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation YYViewController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    //设置边框的宽度为20</span><br><span class="line">    self.customView.layer.borderWidth=20;</span><br><span class="line">    //设置边框的颜色</span><br><span class="line">    self.customView.layer.borderColor=[UIColor greenColor].CGColor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2.通过layer设置边框为圆角self.customView.layer.cornerRadius=20;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">3.在layer上添加一张图片 </span><br><span class="line">#import &quot;YYViewController.h&quot;</span><br><span class="line"></span><br><span class="line">@interface YYViewController ()</span><br><span class="line">@property (weak, nonatomic) IBOutlet UIView *customView;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation YYViewController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    //设置边框的宽度为20</span><br><span class="line">    self.customView.layer.borderWidth=5;</span><br><span class="line">    //设置边框的颜色</span><br><span class="line">    self.customView.layer.borderColor=[UIColor blackColor].CGColor;</span><br><span class="line">    //设置layer的圆角</span><br><span class="line">    self.customView.layer.cornerRadius=20;</span><br><span class="line">    //在view的图层上添加一个image，contents表示接受内容</span><br><span class="line">    self.customView.layer.contents=(id)[UIImage imageNamed:@&quot;me&quot;].CGImage;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">@end</span><br><span class="line">说明：contents是id类型，可以接受内容，上面的实例让layer显示一张图片，仔细观察可以发现四个圆角的部分露了一个角出来。</span><br><span class="line">产生的原因说明：</span><br><span class="line">那是因为设置的image不是展示在主图层上的，而是显示在子图层上的。可以通过设置一个范围，设置超出主图层的部分把它给剪切掉。</span><br><span class="line">有以下两种方法，建议使用layer中的方法（第二种）self.customView.layer.masksToBounds=YES;</span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    //设置边框的宽度为20</span><br><span class="line">    self.customView.layer.borderWidth=5;</span><br><span class="line">    //设置边框的颜色</span><br><span class="line">    self.customView.layer.borderColor=[UIColor blackColor].CGColor;</span><br><span class="line">    //设置layer的圆角</span><br><span class="line">    self.customView.layer.cornerRadius=20;</span><br><span class="line">    //设置超过子图层的部分裁减掉</span><br><span class="line">    //UI框架中使用的方法</span><br><span class="line">//    self.customView.clipsToBounds=YES;</span><br><span class="line">    self.customView.layer.masksToBounds=YES;</span><br><span class="line">    //在view的图层上添加一个image，contents表示接受内容</span><br><span class="line">    self.customView.layer.contents=(id)[UIImage imageNamed:@&quot;me&quot;].CGImage;</span><br><span class="line">&#125;</span><br><span class="line">注意：layer中不能直接接受UI框架中的东西</span><br><span class="line"></span><br><span class="line">4.设置阴影</span><br><span class="line">设置阴影，不光需要设置阴影颜色，还应该设置阴影的偏移位和透明度。</span><br><span class="line">因为如果不设置偏移位的话，那么阴影和layer完全重叠，且默认透明度为0（即完全透明）。</span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    //设置阴影的颜色</span><br><span class="line">    self.customView.layer.shadowColor=[UIColor blackColor].CGColor;</span><br><span class="line">    //设置阴影的偏移量，如果为正数，则代表为往右边偏移</span><br><span class="line">    self.customView.layer.shadowOffset=CGSizeMake(15, 5);</span><br><span class="line">    //设置阴影的透明度(0~1之间，0表示完全透明)</span><br><span class="line">    self.customView.layer.shadowOpacity=0.6;</span><br><span class="line">&#125;</span><br><span class="line">补充说明：如果设置了超过主图层的部分减掉，则设置阴影不会有显示效果。</span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    //设置边框的宽度为20</span><br><span class="line">    self.customView.layer.borderWidth=5;</span><br><span class="line">    //设置边框的颜色</span><br><span class="line">    self.customView.layer.borderColor=[UIColor blackColor].CGColor;</span><br><span class="line">    //设置layer的圆角</span><br><span class="line">    self.customView.layer.cornerRadius=20;</span><br><span class="line">    //设置超过子图层的部分裁减掉</span><br><span class="line">    //UI框架中使用的方法</span><br><span class="line">    //self.customView.clipsToBounds=YES;</span><br><span class="line">    self.customView.layer.masksToBounds=YES;</span><br><span class="line">    //在view的图层上添加一个image，contents表示接受内容</span><br><span class="line">    self.customView.layer.contents=(id)[UIImage imageNamed:@&quot;me&quot;].CGImage;</span><br><span class="line">    //设置阴影的颜色</span><br><span class="line">    self.customView.layer.shadowColor=[UIColor blackColor].CGColor;</span><br><span class="line">    //设置阴影的偏移量，如果为正数，则代表为往右边偏移</span><br><span class="line">    self.customView.layer.shadowOffset=CGSizeMake(15, 5);</span><br><span class="line">    //设置阴影的透明度(0~1之间，0表示完全透明)</span><br><span class="line">    self.customView.layer.shadowOpacity=0.6;</span><br><span class="line">&#125;</span><br><span class="line">把剪切超出主图层部分的代码注释掉之后的显示效果</span><br></pre></td></tr></table></figure>	  

	  <div>
  		<center>
		  <div class="pagination">
<ul class="pagination">
	
	
	
	
	
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
			
		
	
		
			
			
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
		
	
		
	
		
	
		
	
		
			
		
	
		
	
		
	
		
			
		
	
		
	
		
	
	
	
		<li class="prev"><a href="/2016/08/08/iOS/iOS-事件/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>prev</a></li>
	
	<li><a href="/"><i class="fa fa-archive"></i>Home</a></li>
	
		<li class="next"><a href="/2016/07/04/iOS/布局相关/" class="alignright next">next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

		</center>
	  </div>
	  
	</div> <!-- col-md-9/col-md-12 -->
	
  </div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
	<footer> <p>
  &copy; 2016 John Doe
  
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-wixo/">Wixo</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.tableofcontents.min.js"></script>
<script src="/js/tocgenerator.min.js"></script>
<script src="/js/main.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
</html>
