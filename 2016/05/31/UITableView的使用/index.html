<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> UITableView的使用 · coder-gwb</title><meta name="description" content="UITableView的使用 - null"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">首页</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="/categories/编程" target="_self" class="nav-list-link">编程</a></li><li class="nav-list-item"><a href="/categories/读书" target="_self" class="nav-list-link">读书</a></li><li class="nav-list-item"><a href="/categories/生活" target="_self" class="nav-list-link">生活</a></li><li class="nav-list-item"><a href="https://github.com/coderspike" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">UITableView的使用</h1><div class="post-info">2016年5月31日</div><div class="post-content"><blockquote>
<p>UITableView是使用最多的UI控件之一，非常重要，以下内容来自网上一些优秀文章的摘录和自己日常使用中的心得。</p>
</blockquote>
<hr>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><blockquote>
<p>UITableView继承自UIScrollView，基本配置主要是通过两个协议，UITableViewDataSource（提供显示用的数据）和UITableViewDelegate（用来控制tableview的选择section的头和尾的显示），有两种风格Plain和Grouped。UITableView中显示的每一个单元都是一个UITableViewCell对象在tableView快速滑动的滑动的过程中，频繁的alloc对象是比较费时的，于是引入了cell的重用机制。简单的理解就是：UITableView只会创建一屏幕（或一屏幕多一点）的UITableViewCell，其他都是从中取出来重用的。每当Cell滑出屏幕时，就会放入到一个集合（或数组）中（这里就相当于一个重用池），当要显示某一位置的Cell时，会先去集合（或数组）中取，如果有，就直接拿来显示；如果没有，才会创建。这样做的好处可想而知，极大的减少了内存的开销。另外还有几点：<br>1、UITableView需要一个数据源(dataSource)来显示数据<br>2、UITableView会向数据源查询一共有多少行数据以及每一行显示什么数据等<br>3、没有设置数据源的UITableView只是个空壳<br>4、凡是遵守UITableViewDataSource协议的OC对象，都可以是UITableView的数据源</p>
</blockquote>
<h2 id="UITableView的常见属性"><a href="#UITableView的常见属性" class="headerlink" title="UITableView的常见属性"></a>UITableView的常见属性</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">/* tableView的样式 */</span><br><span class="line">@property (nonatomic, readonly) UITableViewStyle style;</span><br><span class="line">// tableView有两种样式</span><br><span class="line">//     UITableViewStylePlain  普通的表格样式</span><br><span class="line">//    UITableViewStyleGrouped  分组模式</span><br><span class="line"></span><br><span class="line">/* tableView的数据源 */</span><br><span class="line">@property (nonatomic, weak, nullable) id &lt;UITableViewDataSource&gt; dataSource;</span><br><span class="line">/* tableView的代理 */</span><br><span class="line">@property (nonatomic, weak, nullable) id &lt;UITableViewDelegate&gt; delegate;</span><br><span class="line"></span><br><span class="line">#pragma mark - 高度相关</span><br><span class="line">/* tableView每一行的高度，默认为44 */</span><br><span class="line">@property (nonatomic) CGFloat rowHeight;</span><br><span class="line">/* tableView统一的每一组头部的高度 */</span><br><span class="line">@property (nonatomic) CGFloat sectionHeaderHeight;</span><br><span class="line">/* tableView统一的每一组头部的高度 */</span><br><span class="line">@property (nonatomic) CGFloat sectionFooterHeight;</span><br><span class="line">/* 估算的tableView的统一的每一行行高 */</span><br><span class="line">@property (nonatomic) CGFloat estimatedRowHeight;</span><br><span class="line">/* 估算的统一的每一组头部高度，设置估算高度可以优化性能 */</span><br><span class="line">@property (nonatomic) CGFloat estimatedSectionHeaderHeight;</span><br><span class="line">/* 估算的统一的每一组的尾部高度 */</span><br><span class="line">@property (nonatomic) CGFloat estimatedSectionFooterHeight;</span><br><span class="line"></span><br><span class="line">/* 总共有多少组 */</span><br><span class="line">@property (nonatomic, readonly) NSInteger numberOfSections;</span><br><span class="line">/* 选中行的indexPath */</span><br><span class="line">@property (nonatomic, readonly, nullable) NSIndexPath *indexPathForSelectedRow;</span><br><span class="line"></span><br><span class="line">#pragma mark - 索引条</span><br><span class="line">/* 索引条文字的颜色 */</span><br><span class="line">@property (nonatomic, strong, nullable) UIColor *sectionIndexColor;</span><br><span class="line">/* 索引条的背景色 */</span><br><span class="line">@property (nonatomic, strong, nullable) UIColor *sectionIndexBackgroundColor;</span><br><span class="line"></span><br><span class="line">#pragma mark - 分隔线</span><br><span class="line">/* 分隔线的样式 */</span><br><span class="line">@property (nonatomic) UITableViewCellSeparatorStyle separatorStyle;</span><br><span class="line">// 分隔线的样式有：</span><br><span class="line">// UITableViewCellSeparatorStyleNone,  没有分隔线</span><br><span class="line">// UITableViewCellSeparatorStyleSingleLine, 正常分隔线</span><br><span class="line">/*  分隔线的颜色 */</span><br><span class="line">@property (nonatomic, strong, nullable) UIColor *separatorColor; </span><br><span class="line"></span><br><span class="line">#pragma mark - 头尾部控件</span><br><span class="line">/* tableView的头部控件，只能设置高度，宽度默认填充表格 */</span><br><span class="line">@property (nonatomic, strong, nullable) UIView *tableHeaderView;</span><br><span class="line">/* tableView的尾部控件，只能设置高度，宽度默认填充表格*/</span><br><span class="line">@property (nonatomic, strong, nullable) UIView *tableFooterView;</span><br><span class="line"></span><br><span class="line">#pragma mark - 编辑模式</span><br><span class="line">/* 是否是编辑模式，默认是NO */</span><br><span class="line">@property (nonatomic, getter=isEditing) BOOL editing;</span><br><span class="line">/* tableView处在编辑模式的时候是否允许选中行，默认是NO */</span><br><span class="line">@property (nonatomic) BOOL allowsSelectionDuringEditing;</span><br><span class="line">/* tableView处在编辑模式的时候是否允许选中多行数据，默认是NO */</span><br><span class="line">@property (nonatomic) BOOL allowsMultipleSelectionDuringEditing;</span><br></pre></td></tr></table></figure>
<h2 id="UITableViewCell的常见属性"><a href="#UITableViewCell的常见属性" class="headerlink" title="UITableViewCell的常见属性"></a>UITableViewCell的常见属性</h2><h5 id="cell的重用原理"><a href="#cell的重用原理" class="headerlink" title="cell的重用原理"></a>cell的重用原理</h5><p>iOS设备的内存有限，如果用UITableView显示成千上万条数据，就需要成千上万个UITableViewCell对象的话，那将会耗尽iOS设备的内存。要解决该问题，需要重用UITableViewCell对象。</p>
<p>重用原理：当滚动列表时，部分UITableViewCell会移出窗口，UITableView会将窗口外的UITableViewCell放入一个缓存池中，等待重用。当UITableView要求dataSource返回UITableViewCell时，dataSource会先查看这个缓存池，如果池中有未使用的UITableViewCell，dataSource会用新的数据配置这个UITableViewCell，然后返回给UITableView，重新显示到窗口中，从而避免创建新对象。</p>
<p>还有一个非常重要的问题：有时候需要自定义UITableViewCell(用一个子类继承UITableViewCell)，而且每一行用的不一定是同一种UITableViewCell，所以一个UITableView可能拥有不同类型的UITableViewCell，缓存池中也会有很多不同类型的UITableViewCell，那么UITableView在重用UITableViewCell时可能会得到错误类型的UITableViewCell。</p>
<p>解决方案：UITableViewCell有个NSString *reuseIdentifier属性，可以在初始化UITableViewCell的时候传入一个特定的字符串标识来设置reuseIdentifier(一般用UITableViewCell的类名)。当UITableView要求dataSource返回UITableViewCell时，先通过一个字符串标识到缓存池中查找对应类型的UITableViewCell对象，如果有，就重用，如果没有，就传入这个字符串标识来初始化一个UITableViewCell对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - Cell内部子控件</span><br><span class="line">/*  默认为nil，imageView是懒加载，用到时才加载 */</span><br><span class="line">@property (nonatomic, readonly, strong, nullable) UIImageView *imageView;</span><br><span class="line">/* 默认为nil，是懒加载，用到时才加载 */</span><br><span class="line">@property (nonatomic, readonly, strong, nullable) UILabel *textLabel;</span><br><span class="line">/* 只有当Cell的样式为UITableViewCellStyleSubtitle时才会显示出来，默认为nil，是懒加载，用到时才加载 */</span><br><span class="line">@property (nonatomic, readonly, strong, nullable) UILabel *detailTextLabel;</span><br><span class="line"></span><br><span class="line">/* 当你想要自定义一个cell的时候，子控件最好添加到cell的contentView上，方便编辑表格 */</span><br><span class="line">@property (nonatomic, readonly, strong) UIView *contentView;</span><br><span class="line"></span><br><span class="line">/* cell的复用标识 */</span><br><span class="line">@property (nonatomic, readonly, copy, nullable) NSString *reuseIdentifier;</span><br><span class="line"></span><br><span class="line">/* cell的选中样式 */</span><br><span class="line">@property (nonatomic) UITableViewCellSelectionStyle   selectionStyle;</span><br><span class="line">/* cell是否是选中状态 */</span><br><span class="line">@property (nonatomic, getter=isSelected) BOOL  selected;</span><br><span class="line"></span><br><span class="line">/* cell的编辑样式，默认是UITableViewCellEditingStyleNone */</span><br><span class="line">@property (nonatomic, readonly) UITableViewCellEditingStyle editingStyle;</span><br><span class="line">// cell的编辑样式有：</span><br><span class="line">// UITableViewCellEditingStyleNone,</span><br><span class="line">// UITableViewCellEditingStyleDelete, 删除模式</span><br><span class="line">// UITableViewCellEditingStyleInsert   插入模式</span><br><span class="line"></span><br><span class="line">/* 指示器的样式，默认是UITableViewCellAccessoryNone */</span><br><span class="line">@property (nonatomic) UITableViewCellAccessoryType accessoryType;</span><br><span class="line">// 指示器的样式有：</span><br><span class="line">// UITableViewCellAccessoryNone   不显示指示器</span><br><span class="line">// UITableViewCellAccessoryDisclosureIndicator cell右侧显示一个箭头</span><br><span class="line">// UITableViewCellAccessoryDetailDisclosureButton cell右侧显示一个箭头和一个详情图标</span><br><span class="line">// UITableViewCellAccessoryCheckmark cell右侧显示一个对勾</span><br><span class="line">// UITableViewCellAccessoryDetailButton cell右侧显示一个详情图标</span><br><span class="line"></span><br><span class="line">/* cell右侧指示器view，设置了以后，cell的accessoryType就会失效  */</span><br><span class="line">@property (nonatomic, strong, nullable) UIView *accessoryView;</span><br></pre></td></tr></table></figure>
<h2 id="UITableView的常用方法"><a href="#UITableView的常用方法" class="headerlink" title="UITableView的常用方法"></a>UITableView的常用方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">/* 全局刷新 */</span><br><span class="line">- (void)reloadData;</span><br><span class="line">/* 刷新索引条 */</span><br><span class="line">- (void)reloadSectionIndexTitles;</span><br><span class="line"></span><br><span class="line">/* 返回第section组有多少行 */</span><br><span class="line">- (NSInteger)numberOfRowsInSection:(NSInteger)section;</span><br><span class="line">/* 返回indexPath对应的那一行的cell */</span><br><span class="line">- (nullable __kindof UITableViewCell *)cellForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/* 返回第section组的头部view */</span><br><span class="line">- (nullable UITableViewHeaderFooterView *)headerViewForSection:(NSInteger)section;</span><br><span class="line">/* 返回第section组的尾部view */</span><br><span class="line">- (nullable UITableViewHeaderFooterView *)footerViewForSection:(NSInteger)section;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  插入数据,刷新数据</span><br><span class="line"> *  @param indexPaths 插入在哪个位置</span><br><span class="line"> *  @param animation  动画效果，枚举UITableViewRowAnimation</span><br><span class="line"> */</span><br><span class="line">- (void)insertRowsAtIndexPaths:(NSArray&lt;NSIndexPath *&gt; *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  删除数据</span><br><span class="line"> *  @param indexPaths 删除数据的位置</span><br><span class="line"> *  @param animation  动画效果，枚举UITableViewRowAnimation</span><br><span class="line"> */</span><br><span class="line">- (void)deleteRowsAtIndexPaths:(NSArray&lt;NSIndexPath *&gt; *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation;</span><br><span class="line">// 枚举UITableViewRowAnimation包括：</span><br><span class="line">// UITableViewRowAnimationFade,  淡入淡出</span><br><span class="line">// UITableViewRowAnimationRight,  向右滑动</span><br><span class="line">// UITableViewRowAnimationLeft,  向左滑动</span><br><span class="line">// UITableViewRowAnimationTop,  向上滑动</span><br><span class="line">// UITableViewRowAnimationBottom,  向下滑动</span><br><span class="line">// UITableViewRowAnimationNone,  无动画效果,iOS 3.0以后可用</span><br><span class="line">// UITableViewRowAnimationMiddle,  保持cell的中间，iOS 3.2以后可用</span><br><span class="line">// UITableViewRowAnimationAutomatic  自动选择一个合适的动画效果</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  刷新某一行的数据</span><br><span class="line"> *  @param indexPaths 刷新数据的位置</span><br><span class="line"> *  @param animation  动画效果，枚举UITableViewRowAnimation</span><br><span class="line"> */</span><br><span class="line">- (void)reloadRowsAtIndexPaths:(NSArray&lt;NSIndexPath *&gt; *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation;</span><br><span class="line"></span><br><span class="line">/** 动画开启/关闭编辑模式 */</span><br><span class="line">- (void)setEditing:(BOOL)editing animated:(BOOL)animated;</span><br><span class="line"></span><br><span class="line">/** 返回一个带有复用标识的cell */</span><br><span class="line">- (nullable __kindof UITableViewCell *)dequeueReusableCellWithIdentifier:(NSString *)identifier;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  使用xib时注册自定义的cell</span><br><span class="line"> *  @param nib        要注册的nib</span><br><span class="line"> *  @param identifier 复用标识</span><br><span class="line"> */</span><br><span class="line">- (void)registerNib:(nullable UINib *)nib forCellReuseIdentifier:(NSString *)identifier;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *   代码自定义cell时注册自定义的cell</span><br><span class="line"> *  @param cellClass  注册的自定义cell的类型</span><br><span class="line"> *  @param identifier 复用标识</span><br><span class="line"> */</span><br><span class="line">- (void)registerClass:(nullable Class)cellClass forCellReuseIdentifier:(NSString *)identifier;</span><br><span class="line"></span><br><span class="line">/** 初始化一个带有复用标识的cell */</span><br><span class="line">- (instancetype)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(nullable NSString *)reuseIdentifier</span><br></pre></td></tr></table></figure>
<h2 id="UITableViewDataSource中的常用方法"><a href="#UITableViewDataSource中的常用方法" class="headerlink" title="UITableViewDataSource中的常用方法"></a>UITableViewDataSource中的常用方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 必须实现的方法：</span><br><span class="line">/* 设置第section组有多少行数据 */</span><br><span class="line">- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section;</span><br><span class="line">/* 设置每一行cell的内容，每当有一个cell进入视野屏幕的时候就会调用这个方法，所以在这个方法内部进行优化（cell的复用） */</span><br><span class="line">- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">// 可实现可不实现的方法：</span><br><span class="line">/* 总共有多少组，如果不实现，默认是一组 */</span><br><span class="line">- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView;</span><br><span class="line"></span><br><span class="line">/* 第section组的头部标题 */</span><br><span class="line">- (nullable NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section;</span><br><span class="line">/* 第section组的尾部标题 */</span><br><span class="line">- (nullable NSString *)tableView:(UITableView *)tableView titleForFooterInSection:(NSInteger)section;</span><br><span class="line"></span><br><span class="line">/** 设置索引条 */</span><br><span class="line">- (nullable NSArray&lt;NSString *&gt; *)sectionIndexTitlesForTableView:(UITableView *)tableView;</span><br></pre></td></tr></table></figure>
<h2 id="UITableViewDelegate中的常用方法"><a href="#UITableViewDelegate中的常用方法" class="headerlink" title="UITableViewDelegate中的常用方法"></a>UITableViewDelegate中的常用方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">/** 设置每一行cell的高度 */</span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line">/** 设置第section组的头部高度 */</span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section;</span><br><span class="line">/** 设置第section组的尾部高度 */</span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section;</span><br><span class="line"></span><br><span class="line">/** 每一行的估算高度 */</span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView estimatedHeightForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/** 设置第section组的headerView */</span><br><span class="line">- (nullable UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section;</span><br><span class="line">/** 设置第section组的footerView */</span><br><span class="line">- (nullable UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section;</span><br><span class="line"></span><br><span class="line">/** 选中了某一行cell的时候就会调用这个方法 */</span><br><span class="line">- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  设置左滑删除按钮的文字</span><br><span class="line"> *  @param tableView         被编辑的tableView</span><br><span class="line"> *  @param indexPath         indexPath</span><br><span class="line"> *  @return 返回删除按钮显示的文字</span><br><span class="line"> */</span><br><span class="line">- (nullable NSString *)tableView:(UITableView *)tableView titleForDeleteConfirmationButtonForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  创建一个左滑出现按钮的操作（UITableViewRowAction）数组</span><br><span class="line"> *  @param tableView         添加操作的tableView</span><br><span class="line"> *  @param indexPath         indexPath，可以指定每一行有不同的效果</span><br><span class="line"> *  @return 返回一个操作（UITableViewRowAction）数组</span><br><span class="line"> */</span><br><span class="line">- (nullable NSArray&lt;UITableViewRowAction *&gt; *)tableView:(UITableView *)tableView editActionsForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  移动cell</span><br><span class="line"> *  @param tableView            操作的tableView</span><br><span class="line"> *  @param sourceIndexPath      移动的行</span><br><span class="line"> *  @param destinationIndexPath 目标行</span><br><span class="line"> */</span><br><span class="line">- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath;</span><br><span class="line"></span><br><span class="line">/** 根据editingStyle处理是删除还是添加操作，完成删除、插入操作刷新表格 */</span><br><span class="line">- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  设置表格编辑模式，不实现默认都是删除</span><br><span class="line"> *  @param tableView 操作的tableView</span><br><span class="line"> *  @param indexPath cell的位置</span><br><span class="line"> *  @return 返回表格编辑样式</span><br><span class="line"> */</span><br><span class="line">- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath;</span><br></pre></td></tr></table></figure>
<h2 id="tableView展示数据的过程"><a href="#tableView展示数据的过程" class="headerlink" title="tableView展示数据的过程"></a>tableView展示数据的过程</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController ()&lt;UITableViewDataSource,UITableViewDelegate&gt;</span><br><span class="line"></span><br><span class="line">@property (weak, nonatomic) IBOutlet UITableView *tableView;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line"></span><br><span class="line">    self.tableView.dataSource = self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - UITableViewDataSource</span><br><span class="line">- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView&#123;</span><br><span class="line">    // 在这个方法中设置总共有多少组数据</span><br><span class="line">    // 这个方法如果不实现，默认是一组</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section&#123;</span><br><span class="line">    // 在这个方法中设置第section组有多行数据</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    // 1.定义一个cell的复用标识</span><br><span class="line">      static NSString *ID = @&quot;cell&quot;;</span><br><span class="line"></span><br><span class="line">    // 2.根据复用标识，从缓存池中取出带有同样的复用标识的cell</span><br><span class="line">      UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:ID];</span><br><span class="line"></span><br><span class="line">    // 3.如果缓存池中没有带有这种复用标识的cell，就创建一个带有这种复用标识的cell</span><br><span class="line">      if (cell == nil) &#123;</span><br><span class="line">        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:ID];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 4.设置cell的一些属性</span><br><span class="line"></span><br><span class="line">    return cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSString *)tableView:(UITableView *)tableView titleForFooterInSection:(NSInteger)section&#123;</span><br><span class="line">    // 在这个方法中设置第section组的尾部标题</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section&#123;</span><br><span class="line">    // 在这个方法中设置第section组的头部标题</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - UITableViewDelegate</span><br><span class="line"></span><br><span class="line">- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    // 当选中了某一行的时候就会调用这个方法，可以在这里进行一些操作</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="一些补充"><a href="#一些补充" class="headerlink" title="一些补充"></a>一些补充</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br></pre></td><td class="code"><pre><span class="line">更改Cell的背景</span><br><span class="line">UIView *myview = [[UIView alloc] init]; </span><br><span class="line">myview.frame = CGRectMake(0, 0, 320, 47); </span><br><span class="line">myview.backgroundColor = [UIColorcolorWithPatternImage:[UIImage imageNamed:@&quot;0006.png&quot;]]; </span><br><span class="line">cell.selectedBackgroundView = myview;</span><br><span class="line"></span><br><span class="line">更改Cell的标题</span><br><span class="line">cell.backgroundColor = [UIColorscrollViewTexturedBackgroundColor]; </span><br><span class="line">// 设置文字的字体  </span><br><span class="line">cell.textLabel.font = [UIFont fontWithName:@&quot;AmericanTypewriter&quot; size:100.0f]; </span><br><span class="line">// 设置文字的颜色  </span><br><span class="line">cell.textLabel.textColor = [UIColor orangeColor]; </span><br><span class="line">// 设置文字的背景颜色  </span><br><span class="line">cell.textLabel.shadowColor = [UIColor whiteColor]; </span><br><span class="line">// 设置文字的显示位置  </span><br><span class="line">cell.textLabel.textAlignment = UITextAlignmentCenter; </span><br><span class="line"></span><br><span class="line">默认选中某一行</span><br><span class="line"></span><br><span class="line">NSIndexPath *ip=[NSIndexPath indexPathForRow:0 inSection:2];  </span><br><span class="line">[tableView selectRowAtIndexPath:ip animated:YES scrollPosition:UITableViewScrollPositionBottom];  </span><br><span class="line"></span><br><span class="line">NSIndexPath *path=[NSIndexPath indexPathForItem:0 inSection:2];  </span><br><span class="line">[self tableView:tableView didSelectRowAtIndexPath:path];  </span><br><span class="line"></span><br><span class="line">手绘分割线：</span><br><span class="line"> if(indexPath.row&gt;0 &amp;&amp; indexPath.row&lt;=[self.basicData count])&#123;</span><br><span class="line">        self.tableView.separatorStyle=UITableViewCellSeparatorStyleNone;</span><br><span class="line">        UIView* separatorLineView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 0.5)];/// change size as you need.</span><br><span class="line">        separatorLineView.backgroundColor = [UIColor grayColor];// you can also put image here</span><br><span class="line">        [cell.contentView addSubview:separatorLineView];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">删除之前选中的行：</span><br><span class="line">- (void)viewWillAppear:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">	[super viewWillAppear:animated];</span><br><span class="line">	// this UIViewController is about to re-appear, make sure we remove the current selection in our table view</span><br><span class="line">	NSIndexPath *tableSelection = [self.tableView indexPathForSelectedRow];</span><br><span class="line">	[self.tableView deselectRowAtIndexPath:tableSelection animated:NO];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">多选：</span><br><span class="line">[uitableview本身就提供多选功能，选中的状态的管理不需要自己再维护。允许uitableivew多选设置一个属性就可以了,这时]:</span><br><span class="line">self.tableView.allowsMultipleSelectionDuringEditing=YES;</span><br><span class="line">[self.tableView setEditing:YES]; //////设置uitableview为编译状态</span><br><span class="line">//同时还有一个属性保存了你当前选择的indexPath集合</span><br><span class="line">NSArray *indexPaths =[self.tableView indexPathsForSelectedRows];</span><br><span class="line"></span><br><span class="line">重新设置uitableView的大小：</span><br><span class="line">- (void)viewDidAppear:(BOOL)animated&#123;    [self.tableView setFrame:CGRectMake(x, y, w, h)];&#125;</span><br><span class="line"></span><br><span class="line">隐藏多余的分割线:</span><br><span class="line">self.tableView.tableFooterView=[[UIView alloc] init]; // hide line</span><br><span class="line"></span><br><span class="line">动态添加行：</span><br><span class="line">dispatch_async(dispatch_get_main_queue(), ^&#123;  </span><br><span class="line">        self.dataSourceArray= a new Array.  </span><br><span class="line">        [self.tableView reloadData];  </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line">在一个UIview中添加UItableview：</span><br><span class="line">TODOTableViewController  *todo = [[TODOTableViewController alloc] init];</span><br><span class="line">    todo.view.autoresizingMask = UIViewAutoresizingNone;</span><br><span class="line">    [self addChildViewController:todo];</span><br><span class="line">    todo.view.frame = CGRectMake(0, 200, self.view.bounds.size.width, self.view.bounds.size.height);</span><br><span class="line">    [self.view addSubview:todo.view];</span><br><span class="line">    [todo didMoveToParentViewController:self];</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">点击行不变色：</span><br><span class="line">    cell.selectionStyle = UITableViewCellSelectionStyleNone;</span><br><span class="line">    </span><br><span class="line">实现UItableview的cell侧滑出现多个按钮：</span><br><span class="line">-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line">- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    return  UITableViewCellEditingStyleDelete;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">-(void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    if (editingStyle == UITableViewCellEditingStyleDelete) &#123;</span><br><span class="line">        [self.dataSource removeObjectAtIndex:indexPath.row];</span><br><span class="line">        [self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">- (NSArray *)tableView:(UITableView *)tableView editActionsForRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    //设置删除按钮</span><br><span class="line">      UITableViewRowAction *deleteRowAction = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDestructive title:@&quot;删除&quot;handler:^(UITableViewRowAction *action,NSIndexPath *indexPath) &#123;</span><br><span class="line">          [self.dataSource removeObjectAtIndex:indexPath.row];</span><br><span class="line">          [self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];</span><br><span class="line">      &#125;];</span><br><span class="line">    </span><br><span class="line">    //设置收藏按钮</span><br><span class="line">    UITableViewRowAction *collectRowAction = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDefault title:@&quot;收藏&quot;handler:^(UITableViewRowAction *action,NSIndexPath *indexPath) &#123;</span><br><span class="line">         collectRowAction.backgroundColor = [UIColor greenColor];</span><br><span class="line">         UIAlertView *alertView = [[UIAlertView alloc]initWithTitle:@&quot;收藏&quot; message:@&quot;收藏成功&quot; delegate:self cancelButtonTitle:@&quot;确定&quot;otherButtonTitles:nil, nil];</span><br><span class="line">         [alertView show];</span><br><span class="line">         &#125;];</span><br><span class="line">    //设置置顶按钮</span><br><span class="line">    UITableViewRowAction *topRowAction = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDefault title:@&quot;置顶&quot;handler:^(UITableViewRowAction *action, NSIndexPath *indexPath) &#123;</span><br><span class="line">         [self.dataSource exchangeObjectAtIndex:indexPath.row withObjectAtIndex:0];</span><br><span class="line">        NSIndexPath *firstIndexPath = [NSIndexPath indexPathForRow:0 inSection:indexPath.section];</span><br><span class="line">        [tableView moveRowAtIndexPath:indexPath toIndexPath:firstIndexPath];</span><br><span class="line">    &#125;];</span><br><span class="line">    collectRowAction.backgroundEffect = [UIBlurEffect effectWithStyle:UIBlurEffectStyleLight];</span><br><span class="line">    topRowAction.backgroundColor = [UIColor blueColor];</span><br><span class="line">    collectRowAction.backgroundColor = [UIColor grayColor]; </span><br><span class="line">    return  @[deleteRowAction,collectRowAction,topRowAction];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">行高：</span><br><span class="line">一种是针对所有 Cell 具有固定高度的情况，通过：</span><br><span class="line">self.tableView.rowHeight = 88;</span><br><span class="line">上面的代码指定了一个所有 cell 都是 88 高度的 UITableView，对于定高需求的表格，强烈建议使用这种</span><br><span class="line"></span><br><span class="line">自定义button右边箭头等标识：</span><br><span class="line">UIButton *actonButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];</span><br><span class="line">    [inactonButton setTitle:@&quot;活跃&quot;  forState:UIControlStateNormal];</span><br><span class="line">    [inactonButton setTintColor:[UIColor redColor]];</span><br><span class="line">    CGRect aframe = CGRectMake(0.0, 0.0, 30, 30);</span><br><span class="line">    inactonButton.frame=aframe;</span><br><span class="line">    cell.accessoryView=button;</span><br><span class="line">    可以自定义右边的显示图片，文字或图片可以通过设置button来设定</span><br><span class="line">    </span><br><span class="line">设置UItableview的imageview中image的大小:</span><br><span class="line">//1、首先对image付值</span><br><span class="line">cell.imageView.image=[UIImage imageNamed:@&quot;灰时间&quot;];</span><br><span class="line">//2、调整大小</span><br><span class="line">      CGSize itemSize = CGSizeMake(40, 40);      UIGraphicsBeginImageContextWithOptions(itemSize, NO, UIScreen.mainScreen.scale);      CGRect imageRect = CGRectMake(0.0, 0.0, itemSize.width, itemSize.height);      [cell.imageView.image drawInRect:imageRect];      cell.imageView.image = UIGraphicsGetImageFromCurrentImageContext();      UIGraphicsEndImageContext();     return cell;</span><br><span class="line">     </span><br><span class="line">UITableView  reloaddata:</span><br><span class="line"></span><br><span class="line">RIGHT WAY: </span><br><span class="line">Principle:  Always change dataSource in MAIN thread and call the reloadData immediately after it. </span><br><span class="line">Option 1: If the operation to change the dataSource should be executed in background, the operation can create a temp dataSource array and pass it to main thread with notification, the main thread observes the notification,  assign the tmpDataSource to dataSource and reload the tableView by reloadData.</span><br><span class="line"></span><br><span class="line">Option 2: In the background, call the GDC dispatch_async to send the two methods to main thread together.</span><br><span class="line">dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        self.dataSourceArray= a new Array.//   或删除当前列表的内容，从新加载[self.dataarray   removeAllObjects];</span><br><span class="line">             [self.tableView reloadData];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">设置搜索框:</span><br><span class="line">[_tableView setTableHeaderView:_searchBar];要记住在headerView中设置，否则会发生遮挡</span><br><span class="line"></span><br><span class="line">UItableview异步加载数据：</span><br><span class="line"></span><br><span class="line">用AFNetworking为TableView异步加载数据</span><br><span class="line">为了让APP有更好的用户体验，所以是不能阻塞主线程的，而RSS的获取和解析都需要一定的时间，所以需要异步地来处理这些工作，配上MBProgressHUD效果更好。</span><br><span class="line"></span><br><span class="line">@interface auditTableViewController ()&lt;MBProgressHUDDelegate&gt;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *bianHao;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *fakeData;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *userIdData;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *dataing;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *time;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *uid;</span><br><span class="line">@property (strong, nonatomic) NSMutableArray *searchResultsData;</span><br><span class="line">@property (strong, nonatomic) NSMutableDictionary *uAuditId;</span><br><span class="line">@property (strong, nonatomic) MBProgressHUD  *progress;</span><br><span class="line"></span><br><span class="line">@property (assign) NSInteger index;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation auditTableViewController</span><br><span class="line"></span><br><span class="line">-(void) getDataAsy:(NSString *)page &#123;</span><br><span class="line">    self.progress=[[MBProgressHUD alloc] initWithView:self.view];</span><br><span class="line">    self.progress.progress=0.4;</span><br><span class="line">    [self.view addSubview:self.progress];</span><br><span class="line">    self.progress.dimBackground=NO;</span><br><span class="line">    self.progress.labelText=@&quot;加载中，请稍后&quot;;</span><br><span class="line">    [self.progress show:YES];</span><br><span class="line">    AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];</span><br><span class="line">    manager.requestSerializer = [AFHTTPRequestSerializer serializer];</span><br><span class="line">    manager.responseSerializer = [AFHTTPResponseSerializer serializer];</span><br><span class="line">    NSString *sid = [[APPDELEGATE.sessionInfo objectForKey:@&quot;obj&quot;]objectForKey:@&quot;sid&quot;];</span><br><span class="line">    NSDictionary *parameters = @&#123;@&quot;MOBILE_SID&quot;:sid,</span><br><span class="line">                                 @&quot;page&quot;:page&#125;;</span><br><span class="line">    [manager POST:[SERVER_URL stringByAppendingString:@&quot;mJobSubmissionAction!renWuJBXXSHDatagrid.action?&quot;] parameters:parameters success:^(AFHTTPRequestOperation *operation, id responseObject) &#123;</span><br><span class="line">        NSString *result =  [[NSString alloc]initWithData:responseObject encoding:NSUTF8StringEncoding];</span><br><span class="line">        [self removeUnescapedCharacter:result];</span><br><span class="line">        NSDictionary *rececive = [NSJSONSerialization JSONObjectWithData:[[self removeUnescapedCharacter:result] dataUsingEncoding:NSUTF8StringEncoding] options:NSJSONReadingMutableContainers error:nil];</span><br><span class="line">        if([[rececive objectForKey:@&quot;success&quot;] boolValue] == YES)&#123;</span><br><span class="line">            NSArray *list = [rececive objectForKey:@&quot;obj&quot;];</span><br><span class="line">            for (int i = 0;i&lt;[list count];i++) &#123;</span><br><span class="line">                NSDictionary *listdic = [list objectAtIndex:i];</span><br><span class="line">                [self.uid addObject:listdic];</span><br><span class="line">                NSString *bianHao  = (NSString *)[listdic objectForKey:@&quot;bianHao&quot;];</span><br><span class="line">                NSString *teamname = (NSString *)[listdic objectForKey:@&quot;qiYeMC&quot;];</span><br><span class="line">                NSString *userId   = (NSString *)[listdic objectForKey:@&quot;yeWuZLMC_cn&quot;];</span><br><span class="line">                NSString *time     = (NSString *)[listdic objectForKey:@&quot;renWuTJSJStr&quot;];</span><br><span class="line">                [self.fakeData  addObject:teamname];</span><br><span class="line">                [self.time      addObject:time];</span><br><span class="line">                [self.dataing   addObject:userId];</span><br><span class="line">                [self.bianHao   addObject:bianHao];</span><br><span class="line">            &#125;</span><br><span class="line">            dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                [self.tableView reloadData];</span><br><span class="line">                [self.progress hide:YES];</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">             [self.progress hide:YES];</span><br><span class="line">            UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;网络连接超时&quot; message:@&quot;请检查网络，重新加载!&quot; delegate:self cancelButtonTitle:@&quot;OK&quot; otherButtonTitles: nil,nil];</span><br><span class="line">            [alert show];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; failure:^(AFHTTPRequestOperation *operation, NSError *error) &#123;</span><br><span class="line">        </span><br><span class="line">         [self.progress hide:YES];</span><br><span class="line">        NSLog(@&quot;%@&quot;,error);</span><br><span class="line">        UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;请求错误&quot; message:@&quot;请检查网络，重新加载!&quot; delegate:self cancelButtonTitle:@&quot;OK&quot; otherButtonTitles: nil,nil];</span><br><span class="line">        [alert show];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSMutableArray *)fakeData</span><br><span class="line">&#123;</span><br><span class="line">    if (!_fakeData) &#123;</span><br><span class="line">        self.bianHao=[[NSMutableArray alloc] init];</span><br><span class="line">        self.fakeData=[[NSMutableArray alloc] init];</span><br><span class="line">        self.dataing=[[NSMutableArray alloc] init];</span><br><span class="line">        self.time=[[NSMutableArray alloc] init];</span><br><span class="line">        self.uid=[[NSMutableArray alloc] init];</span><br><span class="line">        [self getDataAsy:@&quot;1&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">    return _fakeData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(void)viewWillAppear:(BOOL)animated&#123;</span><br><span class="line">    if([APPDELEGATE.paramForaudit isEqualToString:@&quot;fromAuditDetail&quot;])&#123;</span><br><span class="line">        APPDELEGATE.paramForaudit=@&quot;&quot;;//控制刷新，通过字段限定不是每个页面跳转回来都刷新页面</span><br><span class="line">        [self.fakeData removeAllObjects];</span><br><span class="line">        [self.bianHao  removeAllObjects];</span><br><span class="line">        [self.dataing  removeAllObjects];</span><br><span class="line">        [self.time     removeAllObjects];</span><br><span class="line">        [self.uid      removeAllObjects];</span><br><span class="line">        dispatch_async(dispatch_get_main_queue(),^&#123;</span><br><span class="line">            [self getDataAsy:@&quot;1&quot;];</span><br><span class="line">            [self.tableView reloadData];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">同上：</span><br><span class="line">- (void)loadFeed &#123;  AFHTTPRequestOperationManager *manager =      [AFHTTPRequestOperationManager manager];</span><br><span class="line">AFHTTPResponseSerializer *responseSerializer =      [AFHTTPResponseSerializer serializer];</span><br><span class="line">responseSerializer.acceptableContentTypes =      [NSSet setWithObjects:@&quot;application/atom+xml&quot;, nil];  manager.responseSerializer = responseSerializer;</span><br><span class="line">[manager GET:URL parameters:nil         success:^(AFHTTPRequestOperation *operation, id responseObject)&#123;      NSData *response = (NSData *)responseObject;      Feed *feed = [FeedParser parse:response];      self.feed = feed;</span><br><span class="line">     [self.tableView reloadData];    &#125;failure:  ^(AFHTTPRequestOperation * operation, NSError * error) &#123;    NSLog(@&quot;error: , %@&quot;, error);  &#125;];&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;  [super viewDidLoad];</span><br><span class="line">// Uncomment the following line to preserve selection between presentations.  // self.clearsSelectionOnViewWillAppear = NO;</span><br><span class="line">// Uncomment the following line to display an Edit button in the navigation  // bar for this view controller.  // self.navigationItem.rightBarButtonItem = self.editButtonItem;</span><br><span class="line">[self loadFeed];&#125;</span><br><span class="line"></span><br><span class="line">另外一种不阻塞主线程的方式:</span><br><span class="line">-(void)getDataForActivity&#123;</span><br><span class="line">    AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];</span><br><span class="line">    NSString *sid = [[APPDELEGATE.sessionInfo objectForKey:@&quot;obj&quot;]objectForKey:@&quot;sid&quot;];</span><br><span class="line">    NSDictionary *parameters = @&#123;@&quot;MOBILE_SID&quot;:sid,</span><br><span class="line">                                 @&quot;order&quot;:@&quot;desc&quot;,</span><br><span class="line">                                 @&quot;sort&quot; :@&quot;time&quot;&#125;;</span><br><span class="line">    [manager POST:[SERVER_URL stringByAppendingString:@&quot;mcustomerCallRecordsAction!mDatagrid1.action?&quot;] parameters:parameters success:^(AFHTTPRequestOperation *operation, id responseObject) &#123;</span><br><span class="line">        if([[responseObject objectForKey:@&quot;success&quot;] boolValue] == YES)&#123;</span><br><span class="line">            NSArray *list = [responseObject objectForKey:@&quot;obj&quot;];</span><br><span class="line">            for (int i = 0;i&lt;[list count];i++) &#123;</span><br><span class="line">                NSDictionary *listDic =[list objectAtIndex:i];</span><br><span class="line">                NSString *time = (NSString *)[listDic objectForKey:@&quot;timeStr&quot;];</span><br><span class="line">                if([time isEqualToString:self.date1])&#123;</span><br><span class="line">                    self.acitvityIndex1++;</span><br><span class="line">                &#125;else if([time isEqualToString:self.date2])&#123;</span><br><span class="line">                    self.acitvityIndex2++;</span><br><span class="line">                &#125;else if([time isEqualToString:self.date3])&#123;</span><br><span class="line">                    self.acitvityIndex3++;</span><br><span class="line">                &#125;else if([time isEqualToString:self.date4])&#123;</span><br><span class="line">                    self.acitvityIndex4++;</span><br><span class="line">                &#125;else if([time isEqualToString:self.date5])&#123;</span><br><span class="line">                    self.acitvityIndex5++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            NSString *data= [NSString stringWithFormat:@&quot;%d&quot;,self.acitvityIndex1];</span><br><span class="line">            [self performSelectorOnMainThread:@selector(setUpActivityUI) withObject:data waitUntilDone:YES];</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            [self setUpActivityUI];</span><br><span class="line">            UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;网络连接超时&quot; message:@&quot;请检查网络，重新加载!&quot; delegate:self cancelButtonTitle:@&quot;OK&quot; otherButtonTitles: nil,nil];</span><br><span class="line">            [alert show];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; failure:^(AFHTTPRequestOperation *operation, NSError *error) &#123;</span><br><span class="line">        UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;请求错误&quot; message:@&quot;请检查网络，重新加载!&quot; delegate:self cancelButtonTitle:@&quot;OK&quot; otherButtonTitles: nil,nil];</span><br><span class="line">        [alert show];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">上面是PNChart的调用画线，不阻塞主线程，当页面数据请求完毕时绘制，但是每次进入页面都会绘制，所以才去如下方法清空并重新绘制：</span><br><span class="line">-(void) viewWillAppear:(BOOL)animated&#123;</span><br><span class="line">    for(UIView *view in self.scrollView.subviews)&#123;</span><br><span class="line">        [view removeFromSuperview];</span><br><span class="line">    &#125;</span><br><span class="line">    self.acitvityIndex1=0;</span><br><span class="line">    self.acitvityIndex2=0;</span><br><span class="line">    self.acitvityIndex3=0;</span><br><span class="line">    self.acitvityIndex4=0;</span><br><span class="line">    self.acitvityIndex5=0;</span><br><span class="line">    self.telIndex1=0;</span><br><span class="line">    self.telIndex2=0;</span><br><span class="line">    self.telIndex3=0;</span><br><span class="line">    self.telIndex4=0;</span><br><span class="line">    self.telIndex5=0;</span><br><span class="line">    [self  setUpUI];</span><br><span class="line">    [self  DateForIn];</span><br><span class="line">    [self  getDataForActivity];</span><br><span class="line">    [self  getDataForTel];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">刷新当前行：</span><br><span class="line">[_tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];</span><br><span class="line"></span><br><span class="line">给UItableview添加动画：</span><br><span class="line">	</span><br><span class="line">	-(void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">	// 1. 配置CATransform3D的内容</span><br><span class="line">	CATransform3D transform;</span><br><span class="line">	transform = CATransform3DMakeRotation( (90.0*M_PI)/180, 0.0, 0.7, 0.4);</span><br><span class="line">	transform.m34 = 1.0/ -600;</span><br><span class="line">	// 2. 定义cell的初始状态</span><br><span class="line">	cell.layer.shadowColor = [[UIColor blackColor]CGColor];</span><br><span class="line">	cell.layer.shadowOffset = CGSizeMake(10, 10);</span><br><span class="line">	cell.alpha = 0;</span><br><span class="line">	cell.layer.transform = transform;</span><br><span class="line">	cell.layer.anchorPoint = CGPointMake(0, 0.5);</span><br><span class="line">	// 3. 定义cell的最终状态，并提交动画</span><br><span class="line">	[UIView beginAnimations:@&quot;transform&quot; context:NULL];</span><br><span class="line">	[UIView setAnimationDuration:0.5];</span><br><span class="line">	cell.layer.transform = CATransform3DIdentity;</span><br><span class="line">	cell.alpha = 1;</span><br><span class="line">	cell.layer.shadowOffset = CGSizeMake(0, 0);</span><br><span class="line">	cell.frame = CGRectMake(0, cell.frame.origin.y, cell.frame.size.width, cell.frame.size.height);</span><br><span class="line">	[UIView commitAnimations];</span><br><span class="line">	&#125;</span><br><span class="line">第一步：使用CATransform3D在Y和Z轴上做旋转设置。</span><br><span class="line">第二步：定义cell的初始状态，添加了一些阴影，并将第一步中的transform设置给cell中layer的transform matrix。然后将anchor设置为0.0, 0.5，也就是说让cell围绕着左边进行旋转。</span><br><span class="line">第三步：通过动画，将cell设置为原始状态。此处利用了UIView的beginAnimations:context方法来更新cell中layer的值。当然还有别的方法来执行动画，不过这种方法比较简单，我们可以设置持续时间。代码里面将transform设置为CATransform3DIdentity。</span><br><span class="line">这样通过第二步和第三步的状态就能够引导动画，以此完成最终效果。</span><br></pre></td></tr></table></figure>
<p>暂时就这么多吧，后续会更一下关于轻量化UItableview和自定义UItableview的内容，:-D</p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/06/06/第三方框架使用介绍/" class="prev">PREV</a><a href="/2016/05/27/Foundation学习笔记/" class="next">NEXT</a></div><div data-thread-key="2016/05/31/UITableView的使用/" data-title="UITableView的使用" data-url="http://yoursite.com/2016/05/31/UITableView的使用/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"true"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2015 - 2016 <a href="http://yoursite.com"></a>, unless otherwise noted.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>