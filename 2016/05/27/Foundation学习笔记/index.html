<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Foundation学习笔记 | spike</title>
  <meta name="author" content="John Doe">
  
  <meta name="description" content="简介：Cocoa框架中包含众多子框架，Foundation是其中的重要框架，NSObject就在Foundation框架之中。">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Foundation学习笔记"/>
  <meta property="og:site_name" content="spike"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="spike" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/css/sidenav.css" media="screen" type="text/css">  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  

</head>

<body id="body" data-spy="scroll" data-target=".toc">
  <div class="container" id="container">
	<div class="content">
	  <div class="page-header">		
  <h1><a class="brand" href="/">spike</a><span class="split"></span><span class="title">Foundation学习笔记</span><span class="date" id="title-date"><i class="fa fa-clock-o"></i> 2016-05-27</span></h1>
</div>		

<div class="row page">
  <!-- cols -->	
  
  

  
	<div class="col-md-12">
	  

	  <!-- content -->
	  <blockquote>
<p>简介：Cocoa框架中包含众多子框架，Foundation是其中的重要框架，NSObject就在Foundation框架之中。</p>
</blockquote>
<a id="more"></a>
<h2 id="常用结构体"><a href="#常用结构体" class="headerlink" title="常用结构体"></a>常用结构体</h2><hr>
<h5 id="NSRange-范围结构体，用来对对象进行范围操作。"><a href="#NSRange-范围结构体，用来对对象进行范围操作。" class="headerlink" title="NSRange:范围结构体，用来对对象进行范围操作。"></a>NSRange:范围结构体，用来对对象进行范围操作。</h5><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *str = <span class="string">@"123456789"</span>;  </span><br><span class="line"><span class="built_in">NSRange</span> r1 = [str rangeOfString:<span class="string">@"9"</span>];  </span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"location = %ld, length = %ld"</span>, r1.location, r1.length);    </span><br><span class="line">&#125;</span><br><span class="line">结果：location = <span class="number">8</span>, length = <span class="number">1</span>  </span><br><span class="line">如果找不到相应字符串，返回的是<span class="built_in">NSNotFound</span>, 而<span class="built_in">NSNotFound</span>就是<span class="number">-1</span>, 由于<span class="built_in">NSNotFound</span>是unsignedlong类型, 所以打印出来是这么一大堆的数字 。</span><br><span class="line">调用输出语句输出<span class="built_in">NSNotFound</span>，<span class="built_in">NSLog</span>(<span class="string">@"%d ---- %lu"</span>, <span class="built_in">NSNotFound</span>, <span class="built_in">NSNotFound</span>); </span><br><span class="line">结果：</span><br><span class="line">location = <span class="number">9223372036854775807</span>, length = <span class="number">0</span>  </span><br><span class="line"> <span class="number">-1</span> ---- <span class="number">9223372036854775807</span></span><br></pre></td></tr></table></figure>
<h5 id="NSPoint：表示一个点。"><a href="#NSPoint：表示一个点。" class="headerlink" title="NSPoint：表示一个点。"></a>NSPoint：表示一个点。</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CGPoint p = NSMakePoint(1, 2);      </span><br><span class="line">NSPoint p1 = CGPointMake(10, 20); //开发中最长用的  </span><br><span class="line">NSLog(@&quot;px = %f, py = %f&quot;, p.x, p.y);  </span><br><span class="line">NSLog(@&quot;p1x = %f, p1y = %f&quot;, p1.x, p1.y);        </span><br><span class="line">&#125;  </span><br><span class="line">结果： px = 1.000000, py = 2.000000  </span><br><span class="line">      p1x = 10.000000, p1y = 20.000000</span><br></pre></td></tr></table></figure>
<h5 id="NSSize-表示宽高"><a href="#NSSize-表示宽高" class="headerlink" title="NSSize :表示宽高"></a>NSSize :表示宽高</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct NSSize &#123;  </span><br><span class="line">  CGFloat width;  </span><br><span class="line">  CGFloat height;  </span><br><span class="line">  &#125;;  </span><br><span class="line">NSSize size = &#123;10, 30&#125;;  </span><br><span class="line">CGSize size2 = NSMakeSize(100, 200);  </span><br><span class="line">NSSize s1 =  CGSizeMake(10, 30);  </span><br><span class="line">NSSize s2 =  NSMakeSize(100, 200);  </span><br><span class="line">CGSize s3 = CGSizeMake(10, 30);  </span><br><span class="line">CGSize s4 = NSMakeSize(100, 200);   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="CGRect-用来表示一个矩形的位置和宽高"><a href="#CGRect-用来表示一个矩形的位置和宽高" class="headerlink" title="CGRect: 用来表示一个矩形的位置和宽高"></a>CGRect: 用来表示一个矩形的位置和宽高</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct CGRect &#123;  </span><br><span class="line">  CGPoint origin;  </span><br><span class="line">  CGSize size;  </span><br><span class="line">&#125;;</span><br><span class="line">CGRect r1 = CGRectMake(10, 10, 50, 50);      </span><br><span class="line">CGRect r2 = &#123;&#123;0, 0&#125;, &#123;100, 100&#125;&#125;;  </span><br><span class="line">CGRect r3 = &#123;CGPointMake(0, 0), CGSizeMake(100, 100)&#125;;  </span><br><span class="line">NSLog(@&quot;r1 = %@&quot;, NSStringFromRect(r1));  </span><br><span class="line">NSLog(@&quot;r2 = %@&quot;, NSStringFromRect(r2));  </span><br><span class="line">NSLog(@&quot;r3 = %@&quot;, NSStringFromRect(r3));  </span><br><span class="line">r1 = &#123;&#123;10, 10&#125;, &#123;50, 50&#125;&#125;  </span><br><span class="line">r2 = &#123;&#123;0, 0&#125;, &#123;100, 100&#125;&#125;  </span><br><span class="line">r3 = &#123;&#123;0, 0&#125;, &#123;100, 100&#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="日期操作"><a href="#日期操作" class="headerlink" title="日期操作"></a>日期操作</h2><hr>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//获得当前日期</span><br><span class="line">NSDate *date1=[NSDate date];</span><br><span class="line">NSLog(@&quot;%@&quot;,date1); //结果：2014-07-16 07:25:28 +0000</span><br><span class="line">//在当前日期的基础上加上100秒注意在ObjC中多数时间单位都是秒</span><br><span class="line">NSDate *date2=[NSDate dateWithTimeIntervalSinceNow:100];，</span><br><span class="line">NSLog(@&quot;%@&quot;,date2); //结果：2014-07-16 07:27:08 +0000</span><br><span class="line">//随机获取一个将来的日期</span><br><span class="line">NSDate *date3=[NSDate distantFuture];</span><br><span class="line">NSLog(@&quot;%@&quot;,date3); //结果：4001-01-01 00:00:00 +0000</span><br><span class="line">//日期之差,返回单位为秒</span><br><span class="line">NSTimeInterval time=[date2 timeIntervalSinceDate:date1];</span><br><span class="line">NSLog(@&quot;%f&quot;,time); //结果：100.008833</span><br><span class="line">//返回比较早的日期</span><br><span class="line">NSDate *date5=[date1 earlierDate:date3];</span><br><span class="line">NSLog(@&quot;%@&quot;,date5); //结果：2014-07-16 07:25:28 +0000</span><br><span class="line">//日期格式化</span><br><span class="line">//将日期时间转化为字符串</span><br><span class="line">// 实例化NSDateFormatter</span><br><span class="line">NSDateFormatter *formatter = [[NSDateFormatter alloc] init];</span><br><span class="line">// 设置日期格式</span><br><span class="line">[formatter setDateFormat:@&quot;yyyy-mm-dd HH:mm:ss&quot;];</span><br><span class="line">// 获取当前日期</span><br><span class="line">NSDate *currentDate = [NSDate date];</span><br><span class="line">NSString *currentDateString = [formatter stringFromDate:currentDate];</span><br><span class="line">NSLog(@&quot;%@&quot;, currentDateString);</span><br><span class="line">//将时间字符串转换为日期</span><br><span class="line">NSDateFormatter *formatter = [[NSDateFormatter alloc] init];</span><br><span class="line">// 要转换的日期字符串</span><br><span class="line">NSString *dateString = @&quot;2011-05-03 23:11:40&quot;;</span><br><span class="line">// 设置为UTC时区</span><br><span class="line">// 这里如果不设置为UTC时区，会把要转换的时间字符串定为当前时区的时间（东八区）转换为UTC时区的时间</span><br><span class="line">NSTimeZone *timezone = [NSTimeZone timeZoneWithAbbreviation:@&quot;UTC&quot;];</span><br><span class="line">NSDate *someDay = [formatter dateFromString:dateString];</span><br><span class="line">NSLog(@&quot;%@&quot;, someDay);</span><br></pre></td></tr></table></figure>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><hr>
<h5 id="不可变字符串"><a href="#不可变字符串" class="headerlink" title="不可变字符串"></a>不可变字符串</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> NSString *str2=@&quot;OC string&quot;;//ObjC字符串需要加@，并且这种方式创建的对象不需要自己释放内存</span><br><span class="line">//下面的创建方法都应该释放内存</span><br><span class="line">NSString *str3=[[NSString alloc] init];</span><br><span class="line">str3=@&quot;OC string&quot;;</span><br><span class="line">NSString *str4=[[NSString alloc] initWithString:@&quot;Objective-C string&quot;];</span><br><span class="line">NSString *str5=[[NSString alloc] initWithFormat:@&quot;age is %i,name is %.2f&quot;,19,1.72f];</span><br><span class="line">NSString *str6=[[NSString alloc] initWithUTF8String:&quot;C string&quot;];//C语言的字符串转换为ObjC字符串</span><br><span class="line">//以上方法都有对应静态方法（一般以string开头）,不需要管理内存（系统静态方法一般都是自动释放）</span><br><span class="line">NSString *str7=[NSString stringWithString:@&quot;Objective-C string&quot;];</span><br><span class="line">NSLog(@&quot;\&quot;Hello world!\&quot; to upper is %@&quot;,[@&quot;Hello world!&quot; uppercaseString]);</span><br><span class="line">//结果：&quot;Hello world!&quot; to upper is HELLO WORLD!</span><br><span class="line">NSLog(@&quot;\&quot;Hello world!\&quot; to lowwer is %@&quot;,[@&quot;Hello world!&quot; lowercaseString]);</span><br><span class="line">//结果：&quot;Hello world!&quot; to lowwer is hello world!</span><br><span class="line">//首字母大写，其他字母小写</span><br><span class="line">NSLog(@&quot;\&quot;Hello world!\&quot; to capitalize is %@&quot;,[@&quot;Hello world!&quot; capitalizedString]);</span><br><span class="line">//结果：&quot;Hello world!&quot; to capitalize is Hello World!</span><br><span class="line">BOOL result= [@&quot;abc&quot; isEqualToString:@&quot;aBc&quot;];</span><br><span class="line">NSLog(@&quot;%i&quot;,result);</span><br><span class="line">//结果：0</span><br><span class="line">NSComparisonResult result2= [@&quot;abc&quot; compare:@&quot;aBc&quot;];//如果是[@&quot;abc&quot; caseInsensitiveCompare:@&quot;aBc&quot;]则忽略大小写比较</span><br><span class="line">    if(result2==NSOrderedAscending)&#123;</span><br><span class="line">        NSLog(@&quot;left&lt;right.&quot;);</span><br><span class="line">    &#125;else if(result2==NSOrderedDescending)&#123;</span><br><span class="line">        NSLog(@&quot;left&gt;right.&quot;);</span><br><span class="line">    &#125;else if(result2==NSOrderedSame)&#123;</span><br><span class="line">        NSLog(@&quot;left=right.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">//结果：left&gt;right.</span><br><span class="line">NSLog(@&quot;has prefix ab? %i&quot;,[@&quot;abcdef&quot; hasPrefix:@&quot;ab&quot;]);</span><br><span class="line">//结果：has prefix ab? 1</span><br><span class="line">NSLog(@&quot;has suffix ab? %i&quot;,[@&quot;abcdef&quot; hasSuffix:@&quot;ef&quot;]);</span><br><span class="line">//结果：has suffix ab? 1</span><br><span class="line">NSRange range=[@&quot;abcdefabcdef&quot; rangeOfString:@&quot;cde&quot;];//注意如果遇到cde则不再往后面搜索,如果从后面搜索或其他搜索方式可以设置第二个options参数</span><br><span class="line">if(range.location==NSNotFound)&#123;</span><br><span class="line">NSLog(@&quot;not found.&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">NSLog(@&quot;range is %@&quot;,NSStringFromRange(range));</span><br><span class="line">&#125;</span><br><span class="line">//结果：range is &#123;2, 3&#125;</span><br><span class="line">NSLog(@&quot;%@&quot;,[@&quot;abcdef&quot; substringFromIndex:3]);//从第三个索引开始（包括第三个索引对应的字符）截取到最后一位</span><br><span class="line">//结果：def</span><br><span class="line">NSLog(@&quot;%@&quot;,[@&quot;abcdef&quot; substringToIndex:3]);////从0开始截取到第三个索引（不包括第三个索引对应的字符）</span><br><span class="line">//结果：abc</span><br><span class="line">NSLog(@&quot;%@&quot;,[@&quot;abcdef&quot; substringWithRange:NSMakeRange(2, 3)]);</span><br><span class="line">//结果：cde</span><br><span class="line">NSString *str1=@&quot;12.abcd.3a&quot;;</span><br><span class="line">NSArray *array1=[str1 componentsSeparatedByString:@&quot;.&quot;];//字符串分割</span><br><span class="line">NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">结果：</span><br><span class="line">(</span><br><span class="line">12,</span><br><span class="line">abcd,</span><br><span class="line">3a</span><br><span class="line">)</span><br><span class="line">NSLog(@&quot;%i&quot;,[@&quot;12&quot; intValue]);//类型转换</span><br><span class="line">//结果：12</span><br><span class="line">NSLog(@&quot;%zi&quot;,[@&quot;hello world,世界你好！&quot; length]);//字符串长度注意不是字节数</span><br><span class="line">//结果：17</span><br><span class="line">NSLog(@&quot;%c&quot;,[@&quot;abc&quot; characterAtIndex:0]);//取出制定位置的字符</span><br><span class="line">//结果：a</span><br><span class="line">const char *s=[@&quot;abc&quot; UTF8String];//转换为C语言字符串</span><br><span class="line">NSLog(@&quot;%s&quot;,s);</span><br><span class="line">//结果：abc</span><br></pre></td></tr></table></figure>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//去掉最后一个字符</span><br><span class="line">NSString * newString = [originString substringWithRange:NSMakeRange(0, [originString length] - 1)];</span><br><span class="line">//拼接字符串</span><br><span class="line">NSString </span><br><span class="line">NSString* string; // 结果字符串</span><br><span class="line">NSString* string1, string2; //已存在的字符串，需要将string1和string2连接起来</span><br><span class="line">方法1</span><br><span class="line">string = [NSString initWithFormat:@&quot;%@,%@&quot;, string1, string2 ];</span><br><span class="line">方法2</span><br><span class="line">string = [string1 stringByAppendingString:string2];</span><br><span class="line">方法3</span><br><span class="line">string = [string stringByAppendingFormat:@&quot;%@,%@&quot;,string1, string2];</span><br><span class="line">方法4：</span><br><span class="line">NSString *test =  [NSString stringWithFormat:@&quot;设备名称：%@ \n系统版本号：%@\n设备模式：%@\n手机型号: %@\nApp应用名称：%@\nApp应用版本：%@\n&quot;,strName,strSysVersion,strModel,phoneModel,strAppName,strAppVersion];</span><br><span class="line">//for循环添加字符串</span><br><span class="line">for (NSString *str in rolePick)&#123;</span><br><span class="line">  string = [string stringByAppendingFormat:@&quot;%@,&quot;,str];</span><br><span class="line">  &#125; </span><br><span class="line">截取字符串</span><br><span class="line">NSString *str = @&quot;hello:world&quot;;  </span><br><span class="line">NSRange range = [str rangeOfString:@&quot;:&quot;];  </span><br><span class="line">str = [str substringFromIndex:NSMaxRange(range)];  </span><br><span class="line">其中range这个东东有两个属性：length、location</span><br><span class="line">length表示用来做range的字符串的长度，在此就是&quot;:&quot;的长度 ＝ 1；</span><br><span class="line">location表示首个出现该匹配字符串的下标</span><br><span class="line">//判断字符串是否为空</span><br><span class="line">- (BOOL) isBlankString:(NSString *)string &#123;</span><br><span class="line">    if (string == nil || string == NULL)</span><br><span class="line">    &#123;</span><br><span class="line">        return YES;</span><br><span class="line">    &#125;</span><br><span class="line">    if ([string isKindOfClass:[NSNull class]])</span><br><span class="line">    &#123;</span><br><span class="line">        return YES;</span><br><span class="line">    &#125;</span><br><span class="line">    if ([[string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet]] length]==0)</span><br><span class="line">    &#123;</span><br><span class="line">        return YES;</span><br><span class="line">    &#125;</span><br><span class="line">    return NO;</span><br><span class="line">&#125;</span><br><span class="line">//分割字符串为数组</span><br><span class="line">NSArray *array = [string componentsSeparatedByString:@&quot;,&quot;]; // 通过逗号分隔字符串转化为数组</span><br><span class="line">//计算某个字符在字符串中的个数</span><br><span class="line">-(int) numberOfCharaterInString:(NSString *)stringToCount characterToCount:(NSString *) character&#123;</span><br><span class="line">    int numberPoint = 0;</span><br><span class="line">    for (int i = 0; i&lt;stringToCount.length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        NSString * temp = [stringToCount substringWithRange:NSMakeRange(i, 1)];</span><br><span class="line">        if ([temp isEqualToString:character])</span><br><span class="line">        &#123;</span><br><span class="line">            numberPoint ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return  numberPoint;</span><br><span class="line">&#125;</span><br><span class="line">//声明一个NSString属性使用copy要优于使用strong。</span><br><span class="line">//Nsstring 转 Nsnumber</span><br><span class="line"> NSNumberFormatter *f = [[NSNumberFormatter alloc] init];</span><br><span class="line">    if ([f numberFromString:ss])</span><br><span class="line">    &#123;</span><br><span class="line">        result=[NSNumber numberWithFloat:[ss floatValue]];</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        result=ss;</span><br><span class="line">    &#125;</span><br><span class="line">//字符串与int互转</span><br><span class="line">int intString = [newString intValue];   </span><br><span class="line">NSString *stringInt = [NSString stringWithFormat:@&quot;%d&quot;,intString];</span><br><span class="line">//字符串与float互转</span><br><span class="line">float floatString = [ newString floatValue];NSString *stringFloat = [NSString stringWithFormat:@&quot;%f&quot;,intString];</span><br><span class="line">//与NSData的转化</span><br><span class="line">NSData *string2data = [string dataUsingEncoding:NSUTF8StringEncoding];    NSLog(@&quot;%@&quot;,string2data);//    NSData to NSString    NSString *data2String = [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];    NSLog(@&quot;dataString = %@&quot;,data2String);</span><br><span class="line">//与NSDate的转化</span><br><span class="line">NSString to NSDate    NSDate *string2date = [self convertDateFromString:dateString withFormattre:@&quot;yyyyMMdd&quot;];    NSLog(@&quot;date = %@&quot;,string2date);</span><br><span class="line">//NSDate to NSString    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];    [dateFormatter setDateFormat:@&quot;yyyy-MM-dd HH:mm:ss&quot;];    NSString *date2string = [dateFormatter stringFromDate:[NSDate date]];    NSLog(@&quot;%@&quot;, date2string);// NSString to NSArray    NSArray *string2Arry = [arry2String componentsSeparatedByString:@&quot; &quot;];    NSLog(@&quot; %@&quot;,string2Arry);</span><br><span class="line">//NSString to NSDictionary</span><br><span class="line">  NSError *error = nil;  NSDictionary *string2dic = [NSJSONSerialization JSONObjectWithData: [dic2string dataUsingEncoding:NSUTF8StringEncoding]                                    options: NSJSONReadingMutableContainers                                      error: &amp;error];NSLog(@&quot;%@&quot;,string2dic);</span><br></pre></td></tr></table></figure>
<h5 id="可变字符串"><a href="#可变字符串" class="headerlink" title="可变字符串"></a>可变字符串</h5> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> /*可变字符串，注意NSMutableString是NSString子类*/</span><br><span class="line">//注意虽然initWithCapacity分配字符串大小，但是不是绝对的不可以超过此范围，声明此变量对性能有好处</span><br><span class="line">//设置字符串</span><br><span class="line">NSMutableString *str1= [[NSMutableString alloc] initWithCapacity:10];</span><br><span class="line">[str1 setString:@&quot;hello&quot;];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello</span><br><span class="line">//追加字符串</span><br><span class="line">[str1 appendString:@&quot;,world!&quot;];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!</span><br><span class="line">[str1 appendFormat:@&quot;我的年龄是%i。dear,I love you.&quot;,18];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!我的年龄是18。dear,I love you.</span><br><span class="line">//替换字符串</span><br><span class="line">NSRange range=[str1 rangeOfString:@&quot;dear&quot;];</span><br><span class="line">[str1 replaceCharactersInRange:range withString:@&quot;Honey&quot;];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!我的年龄是18。Honey,I love you.</span><br><span class="line">//插入字符串</span><br><span class="line">[str1 insertString:@&quot;My name is Kenshin.&quot; atIndex:12];</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!My name is Kenshin.我的年龄是18。Honey,I love you.</span><br><span class="line">//删除指定字符串</span><br><span class="line">[str1 deleteCharactersInRange:[str1 rangeOfString:@&quot;My name is Kenshin.&quot;]];//删除指定范围的字符串</span><br><span class="line">NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">//结果：hello,world!我的年龄是18。Honey,I love you.</span><br></pre></td></tr></table></figure>
<h2 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h2><hr>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">在ObjC中路径、文件读写等操作是利用字符串来完成的，这里通过几个简单的例子来演示（首先在桌面上新建一个test.txt文件，里面存储的内容是”hello world,世界你好！”）</span><br><span class="line"></span><br><span class="line">//读取文件内容</span><br><span class="line">void test1()&#123;</span><br><span class="line">NSString *path=@&quot;/Users/kenshincui/Desktop/test.txt&quot;;</span><br><span class="line">NSString *str1=[NSString stringWithContentsOfFile:path encoding:NSUTF8StringEncoding error:nil];</span><br><span class="line">//注意上面也可以使用gb2312 gbk等,例如kCFStringEncodingGB_18030_2000，但是需要用CFStringConvertEncodingToNSStringEncoding转换</span><br><span class="line">NSLog(@&quot;str1 is %@&quot;,str1);</span><br><span class="line">//结果：str1 is hello world,世界你好！</span><br><span class="line"></span><br><span class="line">//上面我们看到了读取文件，但并没有处理错误,当然在ObjC中可以@try @catch @finnally但通常我们并不那么做</span><br><span class="line">//由于我们的test.txt中有中文，所以使用下面的编码读取会报错，下面的代码演示了错误获取的过程</span><br><span class="line">NSError *error;</span><br><span class="line">NSString *str2=[NSString stringWithContentsOfFile:path encoding:kCFStringEncodingGB_18030_2000 error:&amp;error];//注意这句话中的error变量是**error，就是指针的指针那就是指针的地址，由于error就是一个指针此处也就是error的地址&amp;error，具体原因见下面补充</span><br><span class="line">    if(error)&#123;</span><br><span class="line">        NSLog(@&quot;read error ,the error is %@&quot;,error);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        NSLog(@&quot;read success,the file content is %@&quot;,str2);</span><br><span class="line">    &#125;</span><br><span class="line">//结果：read error ,the error is Error </span><br><span class="line"></span><br><span class="line">Domain=NSCocoaErrorDomain Code=261 &quot;The file couldn’t be opened using the specified text encoding.&quot; UserInfo=0x100109620 &#123;NSFilePath=/Users/kenshincui/Desktop/test.txt, NSStringEncoding=1586&#125;</span><br><span class="line"></span><br><span class="line">//读取文件内容还有一种方式就是利用URl，它除了可以读取本地文件还可以读取网络文件</span><br><span class="line">//NSURL *url=[NSURL URLWithString:@&quot;file:///Users/kenshincui/Desktop/test.txt&quot;];</span><br><span class="line">NSURL *url=[NSURL URLWithString:@&quot;http://www.apple.com&quot;];</span><br><span class="line">NSString *str3=[NSString stringWithContentsOfURL:url encoding:NSUTF8StringEncoding error:nil];</span><br><span class="line">NSLog(@&quot;str3 is %@&quot;,str3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//下面是文件写入</span><br><span class="line">void test2()&#123;</span><br><span class="line">NSString *path1=@&quot;/Users/kenshincui/Desktop/test2.txt&quot;;</span><br><span class="line">NSError *error1;</span><br><span class="line">NSString *str11=@&quot;hello world,世界你好！&quot;;</span><br><span class="line">[str11 writeToFile:path1 atomically:YES encoding:NSUTF8StringEncoding error:&amp;error1];//automically代表一次性写入，如果写到中间出错了最后就全部不写入</span><br><span class="line">if(error1)&#123;</span><br><span class="line">NSLog(@&quot;write fail,the error is %@&quot;,[error1 localizedDescription]);//调用localizedDescription是只打印关键错误信息</span><br><span class="line">&#125;else&#123;</span><br><span class="line">NSLog(@&quot;write success!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">//结果：write success!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//路径操作</span><br><span class="line">void test3()&#123;</span><br><span class="line">NSMutableArray *marray=[NSMutableArray array];//可变数组</span><br><span class="line">[marray addObject:@&quot;Users&quot;];</span><br><span class="line">[marray addObject:@&quot;KenshinCui&quot;];</span><br><span class="line">[marray addObject:@&quot;Desktop&quot;];</span><br><span class="line">NSString *path=[NSString pathWithComponents:marray];</span><br><span class="line">NSLog(@&quot;%@&quot;,path);//字符串拼接成路径</span><br><span class="line">//结果：Users/KenshinCui/Desktop</span><br><span class="line">NSLog(@&quot;%@&quot;,[path pathComponents]);//路径分割成数组</span><br><span class="line">/*结果： </span><br><span class="line">(</span><br><span class="line">        Users,</span><br><span class="line">        KenshinCui,</span><br><span class="line">        Desktop</span><br><span class="line">)</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%i&quot;,[path isAbsolutePath]);//是否绝对路径（其实就是看字符串是否以“/”开头）</span><br><span class="line">//结果：0</span><br><span class="line">NSLog(@&quot;%@&quot;,[path lastPathComponent]);//取得最后一个目录</span><br><span class="line">//结果：Desktop</span><br><span class="line">NSLog(@&quot;%@&quot;,[path stringByDeletingLastPathComponent]);//删除最后一个目录，注意path本身是常量不会被修改,只是返回一个新字符串</span><br><span class="line">//结果：Users/KenshinCui</span><br><span class="line">NSLog(@&quot;%@&quot;,[path stringByAppendingPathComponent:@&quot;Documents&quot;]);//路径拼接</span><br><span class="line">//结果：Users/KenshinCui/Desktop/Documents</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//扩展名操作</span><br><span class="line">void test4()&#123;</span><br><span class="line">NSString *path=@&quot;Users/KenshinCui/Desktop/test.txt&quot;;</span><br><span class="line">NSLog(@&quot;%@&quot;,[path pathExtension]);//取得扩展名，注意ObjC中扩展名不包括&quot;.&quot;</span><br><span class="line">//结果：txt</span><br><span class="line">NSLog(@&quot;%@&quot;,[path stringByDeletingPathExtension]);//删除扩展名，注意包含&quot;.&quot;</span><br><span class="line">//结果：Users/KenshinCui/Desktop/test</span><br><span class="line">NSLog(@&quot;%@&quot;,[@&quot;Users/KenshinCui/Desktop/test&quot; stringByAppendingPathExtension:@&quot;mp3&quot;]);//添加扩展名</span><br><span class="line">//结果：Users/KenshinCui/Desktop/test.mp3</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*目录操作*/</span><br><span class="line">void test1()&#123;</span><br><span class="line">//文件管理器是专门用于文件管理的类</span><br><span class="line">NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">//获得当前程序所在目录(当然可以改变)</span><br><span class="line">    NSString *currentPath=[manager currentDirectoryPath];</span><br><span class="line">    NSLog(@&quot;current path is :%@&quot;,currentPath);</span><br><span class="line">    //结果：/Users/kenshincui/Library/Developer/Xcode/DerivedData/FoundationFramework-awxjohcpgsqcpsanqofqogwbqgbx/Build/Products/Debug</span><br><span class="line">    </span><br><span class="line">    //创建目录</span><br><span class="line">    NSString *myPath=@&quot;/Users/kenshincui/Desktop/myDocument&quot;;</span><br><span class="line">    BOOL result= [manager createDirectoryAtPath:myPath withIntermediateDirectories:YES attributes:nil error:nil];</span><br><span class="line">    if(result==NO)&#123;</span><br><span class="line">        NSLog(@&quot;Couldn&apos;t create directory!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //目录重命名，如果需要删除目录只要调用removeItemAtPath:&lt;#(NSString *)#&gt; error:&lt;#(NSError **)#&gt;</span><br><span class="line">    NSError *error;</span><br><span class="line">    NSString *newPath=@&quot;/Users/kenshincui/Desktop/myNewDocument&quot;;</span><br><span class="line">    if([manager moveItemAtPath:myPath toPath:newPath error:&amp;error]==NO)&#123;</span><br><span class="line">        NSLog(@&quot;Rename directory failed!Error infomation is:%@&quot;,error);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //改变当前目录</span><br><span class="line">    if([manager changeCurrentDirectoryPath:newPath]==NO)&#123;</span><br><span class="line">        NSLog(@&quot;Change current directory failed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    NSLog(@&quot;current path is :%@&quot;,[manager currentDirectoryPath]);</span><br><span class="line">    //结果：current path is :/Users/kenshincui/Desktop/myNewDocument</span><br><span class="line">    </span><br><span class="line">    //遍历整个目录</span><br><span class="line">    NSString *path;</span><br><span class="line">    NSDirectoryEnumerator *directoryEnumerator= [manager enumeratorAtPath:newPath];</span><br><span class="line">    while (path=[directoryEnumerator nextObject]) &#123;</span><br><span class="line">        NSLog(@&quot;%@&quot;,path);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     documents</span><br><span class="line">     est.txt</span><br><span class="line">    */</span><br><span class="line">    </span><br><span class="line">    //或者这样遍历</span><br><span class="line">    NSArray *paths= [manager contentsOfDirectoryAtPath:newPath error:nil];</span><br><span class="line">    NSObject *p;</span><br><span class="line">    for (p in paths) &#123;</span><br><span class="line">        NSLog(@&quot;%@&quot;,p);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     documents</span><br><span class="line">     est.txt</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*文件操作*/</span><br><span class="line">void test2()&#123;</span><br><span class="line">    NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">    NSString *filePath=@&quot;/Users/kenshincui/Desktop/myNewDocument/test.txt&quot;;</span><br><span class="line">    NSString *filePath2=@&quot;/Users/kenshincui/Desktop/test.txt&quot;;</span><br><span class="line">    NSString *newPath=@&quot;/Users/kenshincui/Desktop/myNewDocument/test2.txt&quot;;</span><br><span class="line">    </span><br><span class="line">    //判断文件是否存在，这个方法也可以判断目录是否存在，这要后面的参数设置位YES</span><br><span class="line">    if ([manager fileExistsAtPath:filePath isDirectory:NO]) &#123;</span><br><span class="line">        NSLog(@&quot;File exists！&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //文件是否可读</span><br><span class="line">    if([manager isReadableFileAtPath:filePath])&#123;</span><br><span class="line">        NSLog(@&quot;File is readable!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //判断两个文件内容是否相等</span><br><span class="line">    if ([manager contentsEqualAtPath:filePath andPath:filePath2]) &#123;</span><br><span class="line">        NSLog(@&quot;file1 equals file2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //文件重命名，方法类似于目录重命名</span><br><span class="line">    if (![manager moveItemAtPath:filePath toPath:newPath error:nil]) &#123;</span><br><span class="line">        NSLog(@&quot;Rename file1 failed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //文件拷贝</span><br><span class="line">    NSString *filePath3=@&quot;/Users/kenshincui/Desktop/test3.txt&quot;;</span><br><span class="line">    if(![manager copyItemAtPath:newPath toPath:filePath3 error:nil])&#123;</span><br><span class="line">        NSLog(@&quot;Copy failed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //读取文件属性</span><br><span class="line">    NSDictionary *attributes;</span><br><span class="line">    if ((attributes=[manager attributesOfItemAtPath:newPath error:nil])==nil) &#123;</span><br><span class="line">        NSLog(@&quot;Read attributes failed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    for (NSObject *key in attributes) &#123;</span><br><span class="line">        NSLog(@&quot;%@=%@&quot;,key,attributes[key]);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">         NSFileOwnerAccountID=501</span><br><span class="line">         NSFileHFSTypeCode=0</span><br><span class="line">         NSFileSystemFileNumber=1781953</span><br><span class="line">         NSFileExtensionHidden=0</span><br><span class="line">         NSFileSystemNumber=16777218</span><br><span class="line">         NSFileSize=27</span><br><span class="line">         NSFileGroupOwnerAccountID=20</span><br><span class="line">         NSFileOwnerAccountName=kenshincui</span><br><span class="line">         NSFileCreationDate=2014-07-28 11:47:58 +0000</span><br><span class="line">         NSFilePosixPermissions=420</span><br><span class="line">         NSFileHFSCreatorCode=0</span><br><span class="line">         NSFileType=NSFileTypeRegular</span><br><span class="line">         NSFileExtendedAttributes=&#123;</span><br><span class="line">         &quot;com.apple.TextEncoding&quot; = &lt;7574662d 383b3133 34323137 393834&gt;;</span><br><span class="line">         &#125;</span><br><span class="line">         NSFileGroupOwnerAccountName=staff</span><br><span class="line">         NSFileReferenceCount=1</span><br><span class="line">         NSFileModificationDate=2014-07-28 11:47:58 +0000</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    //删除文件</span><br><span class="line">    [manager removeItemAtPath:newPath error:nil];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">//文件操作--文件内容操作（NSData，非结构化字节流对象，有缓冲区管理机制，可用于网络传输）</span><br><span class="line">void test3()&#123;</span><br><span class="line">    NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">    NSString *filePath=@&quot;/Users/kenshincui/Desktop/myNewDocument/test2.txt&quot;;</span><br><span class="line">    NSData *data=[manager contentsAtPath:filePath];</span><br><span class="line">    NSLog(@&quot;%@&quot;,data);//存储的是二进制字节流</span><br><span class="line">    //结果:&lt;68656c6c 6f20776f 726c642c e4b896e7 958ce4bd a0e5a5bd efbc81&gt;</span><br><span class="line">    </span><br><span class="line">    //NSData转化成字符串</span><br><span class="line">    NSString *str1=[[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];</span><br><span class="line">    NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">    //结果：hello world,世界你好！</span><br><span class="line">    </span><br><span class="line">    //字符串转化成NSData</span><br><span class="line">    NSString *str2=@&quot;Kenshin&quot;;</span><br><span class="line">    NSData *data2=[str2 dataUsingEncoding:NSUTF8StringEncoding];</span><br><span class="line">    NSLog(@&quot;%@&quot;,data2);</span><br><span class="line">    </span><br><span class="line">    //当然一般如果仅仅是简单读取文件内容，直接用户NSString方法即可</span><br><span class="line">    NSString *content=[NSString stringWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,content);</span><br><span class="line">    //结果：hello world,世界你好！</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">//文件操作--细粒度控制文件,文件操作柄</span><br><span class="line">void test4()&#123;</span><br><span class="line">    NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">    NSString *filePath=@&quot;/Users/kenshincui/Desktop/myNewDocument/test2.txt&quot;;</span><br><span class="line">    </span><br><span class="line">    //以只读方式打开文件</span><br><span class="line">    NSFileHandle *fileHandle=[NSFileHandle fileHandleForReadingAtPath:filePath];//注意这个方法返回类型为instancetype，也就是说对于上面的NSFileHandle它的返回类型也是NSFileHandle</span><br><span class="line">    NSData *data= [fileHandle readDataToEndOfFile];//完整读取文件</span><br><span class="line">    NSString *newPath=@&quot;/Users/kenshincui/Desktop/test4.txt&quot;;</span><br><span class="line">    [manager createFileAtPath:newPath contents:nil attributes:nil];</span><br><span class="line">    NSFileHandle *fileHandle2=[NSFileHandle fileHandleForWritingAtPath:newPath];//以可写方式打开文件</span><br><span class="line">    [fileHandle2 writeData:data];//写入文件内容</span><br><span class="line">    </span><br><span class="line">    [fileHandle2 closeFile];//关闭文件</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    //定位到指定位置,默认在文件开头</span><br><span class="line">    [fileHandle seekToFileOffset:12];</span><br><span class="line">    NSData *data2= [fileHandle readDataToEndOfFile];</span><br><span class="line">    NSLog(@&quot;data2=%@&quot;,[[NSString alloc]initWithData:data2 encoding:NSUTF8StringEncoding]);</span><br><span class="line">    //结果：data2=世界你好！</span><br><span class="line">    </span><br><span class="line">    [fileHandle seekToFileOffset:6];</span><br><span class="line">    NSData *data3=[fileHandle readDataOfLength:5];</span><br><span class="line">    NSLog(@&quot;data3=%@&quot;,[[NSString alloc]initWithData:data3 encoding:NSUTF8StringEncoding]);</span><br><span class="line">    //结果：data3=world</span><br><span class="line">    </span><br><span class="line">    [fileHandle closeFile];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//文件路径</span><br><span class="line">void test5()&#123;</span><br><span class="line">    NSString *filePath=@&quot;/Users/kenshincui/Desktop/myDocument&quot;;</span><br><span class="line">    NSString *filePath2=@&quot;/Users/kenshincui/Desktop/test.txt&quot;;</span><br><span class="line"></span><br><span class="line">    //临时文件所在目录</span><br><span class="line">    NSString *path=NSTemporaryDirectory();</span><br><span class="line">    NSLog(@&quot;temporary directory is :%@&quot;,path);</span><br><span class="line">    //结果：/var/folders/h6/lss6gncs509c2pgzgty3wd_40000gn/T/</span><br><span class="line"></span><br><span class="line">    NSString *lastComponent= [filePath lastPathComponent];</span><br><span class="line">    NSLog(@&quot;%@&quot;,lastComponent); //结果：myDocument</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;%@&quot;,[filePath stringByDeletingLastPathComponent]);</span><br><span class="line">    //结果：/Users/kenshincui/Desktop</span><br><span class="line">    NSLog(@&quot;%@&quot;,[filePath stringByAppendingPathComponent:@&quot;Pictrues&quot;]);</span><br><span class="line">    //结果：/Users/kenshincui/Desktop/myDocument/Pictrues</span><br><span class="line">    NSLog(@&quot;%@&quot;,[filePath2 pathExtension]);</span><br><span class="line">    //结果：txt</span><br><span class="line">    </span><br><span class="line">    [[filePath pathComponents] enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) &#123;</span><br><span class="line">        NSLog(@&quot;%i=%@&quot;,idx,obj);</span><br><span class="line">    &#125;];</span><br><span class="line">    /*结果：</span><br><span class="line">     0=/</span><br><span class="line">     1=Users</span><br><span class="line">     2=kenshincui</span><br><span class="line">     3=Desktop</span><br><span class="line">     4=myDocument</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//文件操作--NSURL</span><br><span class="line">void test6()&#123;</span><br><span class="line">    NSURL *url=[NSURL URLWithString:@&quot;http://developer.apple.com&quot;];</span><br><span class="line">    NSString *str1=[NSString stringWithContentsOfURL:url encoding:NSUTF8StringEncoding error:nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,str1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//文件操作--NSBundle，程序包，一般用于获取Resource中的资源（当然由于当前并非IOS应用没有程序包，只是表示当前程序运行路径）</span><br><span class="line">//在ios中经常用于读取应用程序中的资源文件，如图片、声音、视频等</span><br><span class="line">void test7()&#123;</span><br><span class="line">    //在程序包所在目录创建一个文件</span><br><span class="line">    NSFileManager *manager=[NSFileManager defaultManager];</span><br><span class="line">    NSString *currentPath=[manager currentDirectoryPath];</span><br><span class="line">    NSLog(@&quot;current path is :%@&quot;,currentPath);</span><br><span class="line">    //结果：current path is :/Users/kenshincui/Library/Developer/Xcode/DerivedData/FoundationFramework-awxjohcpgsqcpsanqofqogwbqgbx/Build/Products/Debug</span><br><span class="line">    NSString *filePath=[currentPath stringByAppendingPathComponent:@&quot;test.txt&quot;];</span><br><span class="line">    [manager createFileAtPath:filePath contents:[@&quot;Hello,world!&quot; dataUsingEncoding:NSUTF8StringEncoding] attributes:nil];</span><br><span class="line">    //利用NSBundle在程序包所在目录查找对应的文件</span><br><span class="line">    NSBundle *bundle=[NSBundle mainBundle];//主要操作程序包所在目录</span><br><span class="line">    //如果有test.txt则返回路径，否则返回nil</span><br><span class="line">    NSString *path=[bundle pathForResource:@&quot;test&quot; ofType:@&quot;txt&quot;];//也可以写成：[bundle pathForResource:@&quot;instructions.txt&quot; ofType:nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,path);</span><br><span class="line">    //结果：/Users/kenshincui/Library/Developer/Xcode/DerivedData/FoundationFramework-awxjohcpgsqcpsanqofqogwbqgbx/Build/Products/Debug/test.txt</span><br><span class="line">    NSLog(@&quot;%@&quot;,[NSString stringWithContentsOfFile:path encoding:NSUTF8StringEncoding error:nil]);</span><br><span class="line">    //结果：Hello,world!</span><br><span class="line">    //假设我们在程序运行创建一个Resources目录，并且其中新建pic.jpg，那么用下面的方法获得这个文件完整路径</span><br><span class="line">    NSString *path1= [bundle pathForResource:@&quot;pic&quot; ofType:@&quot;jpg&quot; inDirectory:@&quot;Resources&quot;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,path1);</span><br><span class="line">    //结果：/Users/kenshincui/Library/Developer/Xcode/DerivedData/FoundationFramework-awxjohcpgsqcpsanqofqogwbqgbx/Build/Products/Debug/Resources/pic.jpg</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><hr>
<h5 id="不可变数组"><a href="#不可变数组" class="headerlink" title="不可变数组"></a>不可变数组</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">void test1()&#123;</span><br><span class="line">//NSArray长度不可变所以初始化的时候就赋值，并且最后以nil结尾</span><br><span class="line">//此外需要注意NSArray不能存放C语言的基础类型</span><br><span class="line">NSObject *obj=[[NSObject alloc]init];</span><br><span class="line"></span><br><span class="line">NSArray *array1=[[NSArray alloc] initWithObjects:@&quot;abc&quot;,obj,@&quot;cde&quot;,@&quot;opq&quot;, nil];</span><br><span class="line"></span><br><span class="line">//推荐简便的声明方式</span><br><span class="line">NSArray *array1=@[@&quot;Mac Pro&quot;, @&quot;Mac mini&quot;, @&quot;iMac&quot;, @&quot;MacBook&quot;, @&quot;MacBook Pro&quot;, @&quot;MacBook Air&quot;];</span><br><span class="line"></span><br><span class="line">NSArray *array1=[NSArray arrayWithObjects:@&quot;abc&quot;,obj,@&quot;cde&quot;,@&quot;opq&quot;,@25, nil];</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%zi&quot;,array1.count);//数组长度,结果：5</span><br><span class="line">NSLog(@&quot;%i&quot;,[array1 containsObject:@&quot;cde&quot;]);//是否包含某个对象，结果：1</span><br><span class="line">NSLog(@&quot;%@&quot;,[array1 lastObject]);//最后一个对象，结果：25</span><br><span class="line">NSLog(@&quot;%zi&quot;,[array1 indexOfObject:@&quot;abc&quot;]);//对象所在的位置：0</span><br><span class="line">    </span><br><span class="line">    Person *person1=[Person personWithName:@&quot;Kenshin&quot;];</span><br><span class="line">    Person *person2=[Person personWithName:@&quot;Kaoru&quot;];</span><br><span class="line">    Person *person3=[Person personWithName:@&quot;Rosa&quot;];</span><br><span class="line">    NSArray *array2=[[NSArray alloc]initWithObjects:person1,person2,person3, nil];</span><br><span class="line">    [array2 makeObjectsPerformSelector:@selector(showMessage:) withObject:@&quot;Hello,world!&quot;];//执行所有元素的showMessage方法,后面的参数最多只能有一个</span><br><span class="line">    /*结果：</span><br><span class="line">     My name is Kenshin,the infomation is &quot;Hello,world!&quot;.</span><br><span class="line">     My name is Kaoru,the infomation is &quot;Hello,world!&quot;.</span><br><span class="line">     My name is Rosa,the infomation is &quot;Hello,world!&quot;.</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//数组的遍历</span><br><span class="line">void test2()&#123;</span><br><span class="line">    NSObject *obj=[[NSObject alloc]init];</span><br><span class="line">    NSArray *array=[[NSArray alloc] initWithObjects:@&quot;abc&quot;,obj,@&quot;cde&quot;,@&quot;opq&quot;,@25, nil];</span><br><span class="line">    //方法1</span><br><span class="line">    for(int i=0,len=array.count;i&lt;len;++i)&#123;</span><br><span class="line">        NSLog(@&quot;method1:index %i is %@&quot;,i,[array objectAtIndex:i]);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     method1:index 0 is abc</span><br><span class="line">     method1:index 1 is &lt;NSObject: 0x100106de0&gt;</span><br><span class="line">     method1:index 2 is cde</span><br><span class="line">     method1:index 3 is opq</span><br><span class="line">     method1:index 4 is 25</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法2</span><br><span class="line">    for(id obj in array)&#123;</span><br><span class="line">        NSLog(@&quot;method2:index %zi is %@&quot;,[array indexOfObject:obj],obj);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     method2:index 0 is abc</span><br><span class="line">     method2:index 1 is &lt;NSObject: 0x100602f00&gt;</span><br><span class="line">     method2:index 2 is cde</span><br><span class="line">     method2:index 3 is opq</span><br><span class="line">     method2:index 4 is 25</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法3,利用代码块方法</span><br><span class="line">    [array enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) &#123;</span><br><span class="line">        NSLog(@&quot;method3:index %zi is %@&quot;,idx,obj);</span><br><span class="line">        if(idx==2)&#123;//当idx=2时设置*stop为YES停止遍历</span><br><span class="line">            *stop=YES;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    /*结果：</span><br><span class="line">     method3:index 0 is abc</span><br><span class="line">     method3:index 1 is &lt;NSObject: 0x100106de0&gt;</span><br><span class="line">     method3:index 2 is cde</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法4，利用迭代器</span><br><span class="line">    //NSEnumerator *enumerator= [array objectEnumerator];//获得一个迭代器</span><br><span class="line">    NSEnumerator *enumerator=[array reverseObjectEnumerator];//获取一个反向迭代器</span><br><span class="line">    //NSLog(@&quot;all:%@&quot;,[enumerator allObjects]);//获取所有迭代对象，注意调用完此方法迭代器就遍历完了，下面的nextObject就没有值了</span><br><span class="line">    id obj2=nil;</span><br><span class="line">    while (obj2=[enumerator nextObject]) &#123;</span><br><span class="line">        NSLog(@&quot;method4:%@&quot;,obj2);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     method4:25</span><br><span class="line">     method4:opq</span><br><span class="line">     method4:cde</span><br><span class="line">     method4:&lt;NSObject: 0x100106de0&gt;</span><br><span class="line">     method4:abc</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//数组派生出新的数组</span><br><span class="line">void test3()&#123;</span><br><span class="line">    NSArray *array=[NSArray arrayWithObjects:@&quot;1&quot;,@&quot;2&quot;,@&quot;3&quot;, nil];</span><br><span class="line">    NSArray *array2=[array arrayByAddingObject:@&quot;4&quot;];//注意此时array并没有变</span><br><span class="line">    NSLog(@&quot;%@&quot;,array2);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3,</span><br><span class="line">         4</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">NSLog(@&quot;%@&quot;,[array2 arrayByAddingObjectsFromArray:[NSArray arrayWithObjects:@&quot;5&quot;,@&quot;6&quot;, nil]]);//追加形成新的数组</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3,</span><br><span class="line">         4,</span><br><span class="line">         5,</span><br><span class="line">         6</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">NSLog(@&quot;%@&quot;,[array2 subarrayWithRange:NSMakeRange(1, 3)]);//根据一定范围取得生成一个新的数组</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         2,</span><br><span class="line">         3,</span><br><span class="line">         4</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">NSLog(@&quot;%@&quot;,[array componentsJoinedByString:@&quot;,&quot;]);//数组连接，形成一个字符串</span><br><span class="line">    //结果：1,2,3</span><br><span class="line">    </span><br><span class="line">    //读写文件</span><br><span class="line">    NSString *path=@&quot;/Users/KenshinCui/Desktop/array.xml&quot;;</span><br><span class="line">    [array writeToFile:path atomically:YES];</span><br><span class="line">    NSArray *array3=[NSArray arrayWithContentsOfFile:path];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array3);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//数组排序</span><br><span class="line">void test4()&#123;</span><br><span class="line">    //方法1,使用自带的比较器</span><br><span class="line">    NSArray *array=[NSArray arrayWithObjects:@&quot;3&quot;,@&quot;1&quot;,@&quot;2&quot;, nil];</span><br><span class="line">    NSArray *array2= [array sortedArrayUsingSelector:@selector(compare:)];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array2);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法2,自己定义比较器</span><br><span class="line">    Person *person1=[Person personWithName:@&quot;Kenshin&quot;];</span><br><span class="line">    Person *person2=[Person personWithName:@&quot;Kaoru&quot;];</span><br><span class="line">    Person *person3=[Person personWithName:@&quot;Rosa&quot;];</span><br><span class="line">    NSArray *array3=[NSArray arrayWithObjects:person1,person2,person3, nil];</span><br><span class="line">    NSArray *array4=[array3 sortedArrayUsingSelector:@selector(comparePerson:)];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array4);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kaoru&quot;,</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Rosa&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法3使用代码块</span><br><span class="line">    NSArray *array5=[array3 sortedArrayUsingComparator:^NSComparisonResult(Person *obj1, Person *obj2) &#123;</span><br><span class="line">        return [obj2.name compare:obj1.name];//降序</span><br><span class="line">    &#125;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array5);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Rosa&quot;,</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //方法4 通过描述器定义排序规则</span><br><span class="line">    Person *person4=[Person personWithName:@&quot;Jack&quot;];</span><br><span class="line">    Person *person5=[Person personWithName:@&quot;Jerry&quot;];</span><br><span class="line">    Person *person6=[Person personWithName:@&quot;Tom&quot;];</span><br><span class="line">    Person *person7=[Person personWithName:@&quot;Terry&quot;];</span><br><span class="line">    NSArray *array6=[NSArray arrayWithObjects:person4,person5,person6,person7, nil];</span><br><span class="line">    //定义一个排序描述</span><br><span class="line">    NSSortDescriptor *personName=[NSSortDescriptor sortDescriptorWithKey:@&quot;name&quot; ascending:YES];</span><br><span class="line">    NSSortDescriptor *accountBalance=[NSSortDescriptor sortDescriptorWithKey:@&quot;account.balance&quot; ascending:YES];</span><br><span class="line">    NSArray *des=[NSArray arrayWithObjects:personName,accountBalance, nil];//先按照person的name排序再按照account的balance排序</span><br><span class="line">    NSArray *array7=[array6 sortedArrayUsingDescriptors:des];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array7);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Jack&quot;,</span><br><span class="line">         &quot;name=Jerry&quot;,</span><br><span class="line">         &quot;name=Terry&quot;,</span><br><span class="line">         &quot;name=Tom&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line">//补充</span><br><span class="line"></span><br><span class="line">//与可变数组的转化     </span><br><span class="line">NSArray --&gt; NSMutableArray: </span><br><span class="line">NSMutableArray *myMutableArray = [myArray mutableCopy];    </span><br><span class="line">NSMutableArray --&gt; NSArray:</span><br><span class="line">NSArray *myArray = [myMutableArray copy]; </span><br><span class="line"></span><br><span class="line">//可变性</span><br><span class="line">虽然 NSArray 类本身不可变，但它仍可包含可变对象。例如，如果将可变字符串添加到不可变的数组，</span><br><span class="line">如下所示：</span><br><span class="line">NSMutableString *mutableString = [NSMutableString stringWithString:@&quot;Hello&quot;];</span><br><span class="line">NSArray *immutableArray = @[mutableString];</span><br><span class="line">就可让您变异该字符串。</span><br><span class="line">if ([immutableArray count] &gt; 0) &#123;</span><br><span class="line">id string = immutableArray[0];</span><br><span class="line">if ([string isKindOfClass:[NSMutableString class]]) &#123;</span><br><span class="line">[string appendString:@&quot; World!&quot;];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//NSArray  去重</span><br><span class="line">面试题</span><br><span class="line">对数组中的元素去重复 </span><br><span class="line">NSArray *array = @[@&quot;12-11&quot;, @&quot;12-11&quot;, @&quot;12-11&quot;, @&quot;12-12&quot;, @&quot;12-13&quot;, @&quot;12-14&quot;];//推荐的写法</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">有如下几种方案：</span><br><span class="line">• 第一种方法：开辟新的内存空间，然后判断是否存在，若不存在则添加到数组中，得到最终结果的顺序不发生变化。效率分析：时间复杂度为O ( n2 )：</span><br><span class="line"> </span><br><span class="line">NSMutableArray *resultArray = [[NSMutableArray alloc] initWithCapacity:array.count];</span><br><span class="line">// 外层一个循环</span><br><span class="line">for (NSString *item in array) &#123;</span><br><span class="line">   // 调用-containsObject:本质也是要循环去判断，因此本质上是双层遍历</span><br><span class="line">   // 时间复杂度为O ( n^2 )而不是O (n)</span><br><span class="line">    if (![resultArray containsObject:item]) &#123;</span><br><span class="line">      [resultArray addObject:item];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">NSLog(@&quot;resultArray: %@&quot;, resultArray);</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">原来集合操作可以通过valueForKeyPath来实现的，去重可以一行代码实现： </span><br><span class="line">array = [array valueForKeyPath:@&quot;@distinctUnionOfObjects.self&quot;];</span><br><span class="line">NSLog(@&quot;%@&quot;, array);</span><br><span class="line"> </span><br><span class="line">但是返回的结果是无序的，与原来的顺序不同。</span><br><span class="line"></span><br><span class="line">• 第二种方法：利用NSDictionary去重，字典在设置key-value时，若已存在则更新值，若不存在则插入值，然后获取allValues。若不要求有序，则可以采用此种方法。若要求有序，还得进行排序。效率分析：只需要一个循环就可以完成放入字典，若不要求有序，时间复杂度为O(n)。若要求排序，则效率与排序算法有关：</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">NSMutableDictionary *resultDict = [[NSMutableDictionary alloc] initWithCapacity:array.count];</span><br><span class="line">for (NSString *item in array) &#123;</span><br><span class="line">    [resultDict setObject:item forKey:item];</span><br><span class="line">&#125;</span><br><span class="line">NSArray *resultArray = resultDict.allValues;</span><br><span class="line">NSLog(@&quot;%@&quot;, resultArray);</span><br><span class="line"> </span><br><span class="line">如果需要按照原来的升序排序，可以这样：</span><br><span class="line">resultArray = [resultArray sortedArrayUsingComparator:^NSComparisonResult(id  _Nonnull obj1, id  _Nonnull obj2) &#123;</span><br><span class="line">  NSString *item1 = obj1;</span><br><span class="line">  NSString *item2 = obj2;</span><br><span class="line">  return [item1 compare:item2 options:NSLiteralSearch];</span><br><span class="line">&#125;];</span><br><span class="line">NSLog(@&quot;%@&quot;, resultArray);</span><br><span class="line"></span><br><span class="line">• 第三种方法：利用集合NSSet的特性(确定性、无序性、互异性)，放入集合就自动去重了。但是它与字典拥有同样的无序性，所得结果顺序不再与原来一样。如果不要求有序，使用此方法与字典的效率应该是差不多的。效率分析：时间复杂度为O (n)：</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">NSSet *set = [NSSet setWithArray:array];</span><br><span class="line">NSArray *resultArray = [set allObjects];</span><br><span class="line">NSLog(@&quot;%@&quot;, resultArray);</span><br><span class="line"> </span><br><span class="line">如果要求有序，那就得排序，比如这里要升序排序：</span><br><span class="line"> </span><br><span class="line">resultArray = [resultArray sortedArrayUsingComparator:^NSComparisonResult(id  _Nonnull obj1, id  _Nonnull obj2) &#123;</span><br><span class="line">  NSString *item1 = obj1;</span><br><span class="line">  NSString *item2 = obj2;</span><br><span class="line">  return [item1 compare:item2 options:NSLiteralSearch];</span><br><span class="line">&#125;];</span><br><span class="line">NSLog(@&quot;%@&quot;, resultArray);</span><br><span class="line"> </span><br><span class="line">补充：</span><br><span class="line">一直没有使用过有序集合，网友们反馈到可以直接使用有序集合，感谢大家：</span><br><span class="line">NSOrderedSet *set = [NSOrderedSet orderedSetWithArray:array];</span><br><span class="line">NSLog(@&quot;%@&quot;, set.array);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> //NSArray to NSData</span><br><span class="line">NSData *arry2data = [NSKeyedArchiver archivedDataWithRootObject:array];//NSData to NSArrayNSArray *data2arry = [NSKeyedUnarchiver unarchiveObjectWithData:arry2data];NSLog(@&quot;%@  /n %@&quot;,arry2data,data2arry);</span><br><span class="line">//NSArray to NSString</span><br><span class="line">NSString *arry2String = [array componentsJoinedByString:@&quot; &quot;];NSLog(@&quot;string = %@&quot;,arry2String);</span><br><span class="line"></span><br><span class="line">//判断数组是否为空</span><br><span class="line">有人说可以用（［array count］＝＝0 ）来判断是否为空，都是坑，如果array为空的话，执行count就会直接报错，程序崩溃退出。</span><br><span class="line">正确判断NSArray是否为空的方法：用 （!array）</span><br><span class="line"> </span><br><span class="line">if (array != nil &amp;&amp; ![array isKindOfClass:[NSNull class]] &amp;&amp; array.count != 0)&#123;</span><br><span class="line">//执行array不为空时的操作</span><br><span class="line">&#125;</span><br><span class="line">这样才是iOS判断数组是否为空的准确方式。</span><br><span class="line"></span><br><span class="line">// 数组过滤</span><br><span class="line">需求：在一个数组里面，将在这个数组中的并且在另一个数组里面的元素过滤掉。</span><br><span class="line">即：在一个数组dataArray里面，将在dataArray数组中的并且在filteredArray数组里面的元素过滤掉。</span><br><span class="line">//iOS-筛选数组内的元素//在dataArray中里面，将在dataArray中的并且在filteredArray数组里面的元素过滤掉//需要去掉的元素数组NSMutableArray *filteredArray = [[NSMutableArray alloc]initWithObjects:@&quot;1&quot;,@&quot;3&quot;,@&quot;9&quot;, nil];//需要被筛选的数组NSMutableArray *dataArray = [[NSMutableArray alloc]initWithObjects:@&quot;1&quot;,@&quot;2&quot;,@&quot;3&quot;,@&quot;1&quot;,@&quot;1&quot;,@&quot;3&quot;,@&quot;1&quot;,@&quot;5&quot;,@&quot;7&quot;, nil];/*方法一：利用NSPredicate注：NSPredicate所属Cocoa框架，在密码、用户名等正则判断中经常用到。         类似于SQL语句         NOT 不是         SELF 代表字符串本身         IN 范围运算符         那么NOT (SELF IN %@) 意思就是：不是这里所指定的字符串的值         */NSPredicate * filterPredicate = [NSPredicate predicateWithFormat:@&quot;NOT (SELF IN %@)&quot;,filteredArray];//过滤数组NSArray * reslutFilteredArray = [dataArray filteredArrayUsingPredicate:filterPredicate];NSLog(@&quot;Reslut Filtered Array = %@&quot;,reslutFilteredArray);  /*方法二：从后往前遍历数组，然后匹配删除*/int i = (int)[dataArray count]-1;        for(;i &gt;= 0;i --)&#123;            //containsObject 判断元素是否存在于数组中(根据两者的内存地址判断，相同：YES  不同：NO）            if([filteredArray containsObject:[dataArray objectAtIndex:i]]) &#123;                [dataArray removeObjectAtIndex:i];&#125;&#125;NSLog(@&quot;Data Array = %@&quot;,dataArray);</span><br><span class="line"></span><br><span class="line">//浮点数存入数组</span><br><span class="line">NSNumber *number = [NSNumber numberWithFloat:value];  </span><br><span class="line">[temparray addObject:number;  </span><br><span class="line">//取出  </span><br><span class="line">[[temparray objectAtIndex:0] floatValue]； </span><br><span class="line">需要注意几点：</span><br><span class="line"></span><br><span class="line">NSArray中只能存放对象，不能存放基本数据类型，通常我们可以通过在基本数据类型前加@进行转换；</span><br><span class="line"></span><br><span class="line">数组中的元素后面必须加nil以表示数据结束；</span><br><span class="line"></span><br><span class="line">makeObjectsPerformSelector执行数组中对象的方法，其参数最多只能有一个；</span><br><span class="line"></span><br><span class="line">上面数组操作中无论是数组的追加、删除、截取都没有改变原来的数组，只是产生了新的数组而已；</span><br><span class="line"></span><br><span class="line">对象的比较除了使用系统自带的方法，我们可以通过自定义比较器的方法来实现；</span><br></pre></td></tr></table></figure>
<ul>
<li><h5 id="可变数组"><a href="#可变数组" class="headerlink" title="可变数组"></a>可变数组</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">void test1()&#123;</span><br><span class="line">    Person *person1=[Person personWithName:@&quot;Kenshin&quot;];</span><br><span class="line">    Person *person2=[Person personWithName:@&quot;Kaoru&quot;];</span><br><span class="line">    Person *person3=[Person personWithName:@&quot;Rosa&quot;];</span><br><span class="line">    NSMutableArray *array1=[NSMutableArray arrayWithObjects:person1,person2,person3, nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;,</span><br><span class="line">         &quot;name=Rosa&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    Person *person4=[Person personWithName:@&quot;Jack&quot;];//此时person4的retainCount为1</span><br><span class="line">    [array1 addObject:person4];//添加一个元素,此时person4的retainCount为2</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;,</span><br><span class="line">         &quot;name=Rosa&quot;,</span><br><span class="line">         &quot;name=Jack&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [array1 removeObject:person3];//删除一个元素</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;,</span><br><span class="line">         &quot;name=Jack&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [array1 removeLastObject];//删除最后一个元素,//此时person4的retainCount为1</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         &quot;name=Kenshin&quot;,</span><br><span class="line">         &quot;name=Kaoru&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [array1 removeAllObjects];//删除所以元素</span><br><span class="line">    </span><br><span class="line">    //注意当往数组中添加一个元素时会retain因此计数器+1，当从数组中移除一个元素时会release因此计数器-1</span><br><span class="line">    //当NSMutalbeArray对象release的时候会依次调用每一个对象的release</span><br><span class="line">&#125;</span><br><span class="line">void test2()&#123;</span><br><span class="line">    NSMutableArray *array1=[NSMutableArray arrayWithObjects:@&quot;1&quot;,@&quot;3&quot;,@&quot;2&quot;, nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         3,</span><br><span class="line">         2</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    NSArray *array2= [array1 sortedArrayUsingSelector:@selector(compare:)];//注意这个方法没有修改array1</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         3,</span><br><span class="line">         2</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;%@&quot;,array2);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    [array1 sortUsingSelector:@selector(compare:)];//这个方法会修改array1</span><br><span class="line">    NSLog(@&quot;%@&quot;,array1);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         2,</span><br><span class="line">         3</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//补充</span><br><span class="line"></span><br><span class="line">//NSMutableArray 转json</span><br><span class="line">NSMutableArray *arr = [[NSMutableArray alloc] init];  </span><br><span class="line">NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:  </span><br><span class="line">                        @&quot;ni hao&quot;, @&quot;key&quot;,  </span><br><span class="line">                        @&quot;45&quot;, @&quot;value&quot;,  </span><br><span class="line">                        @&quot;USD&quot;, @&quot;code&quot;,nil];  </span><br><span class="line">NSDictionary *params2 = [NSDictionary dictionaryWithObjectsAndKeys:  </span><br><span class="line">                        @&quot;hao&quot;, @&quot;key&quot;,  </span><br><span class="line">                        @&quot;45&quot;, @&quot;value&quot;,  </span><br><span class="line">                        @&quot;USD&quot;, @&quot;code&quot;,nil]; </span><br><span class="line">[arr addObject:params];  </span><br><span class="line">[arr addObject:params2];  </span><br><span class="line">NSDictionary *params3 = [NSDictionary dictionaryWithObjectsAndKeys:  </span><br><span class="line">                          arr, @&quot;json&quot;,  </span><br><span class="line">                         nil nil];  </span><br><span class="line">//convert object to data  </span><br><span class="line">NSData* jsonData =[NSJSONSerialization dataWithJSONObject:params3  </span><br><span class="line">                                                  options:NSJSONWritingPrettyPrinted error:&amp;error];    </span><br><span class="line">//print out the data contents    </span><br><span class="line">NSString* text =[[NSString alloc] initWithData:jsonData  </span><br><span class="line">                                        encoding:NSUTF8StringEncoding];    </span><br><span class="line">  NSLog(@&quot;json字典里面的内容为--》%@&quot;, text );</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">可变数组中的元素后面必须加nil以表示数据结束；</span><br><span class="line"></span><br><span class="line">往一个可变数组中添加一个对象，此时这个对象的引用计数器会加1，当这个对象从可变数组中移除其引用计数器减1。同时当整个数组销毁之后会依次调</span><br><span class="line">用每个对象的releaes方法。</span><br><span class="line"></span><br><span class="line">在不可变数组中无论对数组怎么排序，原来的数组顺序都不会改变，但是在可变数组中如果使用sortUsingSelector:排序原来的数组顺序就发生了变化。</span><br></pre></td></tr></table></figure>
<h5 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">void test1()&#123;</span><br><span class="line">    NSDictionary *dic1=[NSDictionary dictionaryWithObject:@&quot;1&quot; forKey:@&quot;a&quot;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic1);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">        a = 1;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    //常用的方式</span><br><span class="line">    NSDictionary *dic2=[NSDictionary dictionaryWithObjectsAndKeys:</span><br><span class="line">                        @&quot;1&quot;,@&quot;a&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;b&quot;,</span><br><span class="line">                        @&quot;3&quot;,@&quot;c&quot;,</span><br><span class="line">                        nil];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic2);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 1;</span><br><span class="line">         b = 2;</span><br><span class="line">         c = 3;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    NSDictionary *dic3=[NSDictionary dictionaryWithObjects:[NSArray arrayWithObjects:@&quot;1&quot;,@&quot;2&quot;, nil] forKeys:[NSArray arrayWithObjects:@&quot;a&quot;,@&quot;b&quot;, nil]];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic3);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 1;</span><br><span class="line">         b = 2;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    //更简单的方式</span><br><span class="line">    NSDictionary *dic4=@&#123;@&quot;1&quot;:@&quot;a&quot;,@&quot;2&quot;:@&quot;b&quot;,@&quot;3&quot;:@&quot;c&quot;&#125;;</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic4);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         1 = a;</span><br><span class="line">         2 = b;</span><br><span class="line">         3 = c;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line">void test2()&#123;</span><br><span class="line">    NSDictionary *dic1=[NSDictionary dictionaryWithObjectsAndKeys:</span><br><span class="line">                        @&quot;1&quot;,@&quot;a&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;b&quot;,</span><br><span class="line">                        @&quot;3&quot;,@&quot;c&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;d&quot;,</span><br><span class="line">                        nil];</span><br><span class="line">    NSLog(@&quot;%zi&quot;,[dic1 count]); //结果：4</span><br><span class="line">    NSLog(@&quot;%@&quot;,[dic1 valueForKey:@&quot;b&quot;]);//根据键取得值，结果：2</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic1[@&quot;b&quot;]);//还可以这样读取，结果：2</span><br><span class="line">    NSLog(@&quot;%@,%@&quot;,[dic1 allKeys],[dic1 allValues]);</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         d,</span><br><span class="line">         b,</span><br><span class="line">         c,</span><br><span class="line">         a</span><br><span class="line">     ),(</span><br><span class="line">         2,</span><br><span class="line">         2,</span><br><span class="line">         3,</span><br><span class="line">         1</span><br><span class="line">     )</span><br><span class="line"></span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;%@&quot;,[dic1 objectsForKeys:[NSArray arrayWithObjects:@&quot;a&quot;,@&quot;e&quot; , nil]notFoundMarker:@&quot;not fount&quot;]);//后面一个参数notFoundMarker是如果找不到对应的key用什么值代替</span><br><span class="line">    /*结果：</span><br><span class="line">     (</span><br><span class="line">         1,</span><br><span class="line">         &quot;not fount&quot;</span><br><span class="line">     )</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line">void test3()&#123;</span><br><span class="line">    NSDictionary *dic1=[NSDictionary dictionaryWithObjectsAndKeys:</span><br><span class="line">                        @&quot;1&quot;,@&quot;a&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;b&quot;,</span><br><span class="line">                        @&quot;3&quot;,@&quot;c&quot;,</span><br><span class="line">                        @&quot;2&quot;,@&quot;d&quot;,</span><br><span class="line">                        nil];</span><br><span class="line">    //遍历1</span><br><span class="line">    for (id key in dic1) &#123;//注意对于字典for遍历循环的是key</span><br><span class="line">        NSLog(@&quot;%@=%@&quot;,key,[dic1 objectForKey:key]);</span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     d=2</span><br><span class="line">     b=2</span><br><span class="line">     c=3</span><br><span class="line">     a=1</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    //遍历2</span><br><span class="line">    NSEnumerator *enumerator=[dic1 keyEnumerator];//还有值的迭代器[dic1 objectEnumerator]</span><br><span class="line">    id key=nil;</span><br><span class="line">    while (key=[enumerator nextObject]) &#123;</span><br><span class="line">        NSLog(@&quot;%@=%@&quot;,key,[dic1 objectForKey:key]);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    /*结果：</span><br><span class="line">     d=2</span><br><span class="line">     b=2</span><br><span class="line">     c=3</span><br><span class="line">     a=1</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    //遍历3</span><br><span class="line">    [dic1 enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) &#123;</span><br><span class="line">        NSLog(@&quot;%@=%@&quot;,key,obj);</span><br><span class="line">    &#125;];</span><br><span class="line">    /*结果：</span><br><span class="line">     d=2</span><br><span class="line">     b=2</span><br><span class="line">     c=3</span><br><span class="line">     a=1</span><br><span class="line">     */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void test4()&#123;</span><br><span class="line">    NSMutableDictionary *dic=[NSMutableDictionary dictionaryWithObjectsAndKeys:@&quot;1&quot;,@&quot;a&quot;,</span><br><span class="line">                              @&quot;2&quot;,@&quot;b&quot;,</span><br><span class="line">                              @&quot;3&quot;,@&quot;c&quot;,</span><br><span class="line">                              @&quot;2&quot;,@&quot;d&quot;,</span><br><span class="line">                            nil];</span><br><span class="line">    [dic removeObjectForKey:@&quot;b&quot;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 1;</span><br><span class="line">         c = 3;</span><br><span class="line">         d = 2;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [dic addEntriesFromDictionary:@&#123;@&quot;e&quot;:@&quot;7&quot;,@&quot;f&quot;:@&quot;6&quot;&#125;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 1;</span><br><span class="line">         c = 3;</span><br><span class="line">         d = 2;</span><br><span class="line">         e = 7;</span><br><span class="line">         f = 6;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    [dic setValue:@&quot;5&quot; forKey:@&quot;a&quot;];</span><br><span class="line">    NSLog(@&quot;%@&quot;,dic);</span><br><span class="line">    /*结果：</span><br><span class="line">     &#123;</span><br><span class="line">         a = 5;</span><br><span class="line">         c = 3;</span><br><span class="line">         d = 2;</span><br><span class="line">         e = 7;</span><br><span class="line">         f = 6;</span><br><span class="line">     &#125;</span><br><span class="line">     */</span><br><span class="line">     </span><br><span class="line">    </span><br><span class="line">    //注意，一个字典的key或value添加到字典中时计数器+1；字典释放时调用key或value的release一次，计数器-1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//一些补充</span><br><span class="line"></span><br><span class="line">//判断是否为空</span><br><span class="line">![listi isKindOfClass:[NSNull class]]</span><br><span class="line"></span><br><span class="line">//NSDictionary Json</span><br><span class="line">NSDictionary *dictionary  = [NSDictionary dictionaryWithObjectsAndKeys:</span><br><span class="line">myDelegate.reason,@&quot;reason&quot;,</span><br><span class="line">myDelegate.username,@&quot;userName&quot;,nil];</span><br><span class="line"></span><br><span class="line">NSError *parseError = nil;</span><br><span class="line"></span><br><span class="line">NSData* jsonData = [NSJSONSerialization dataWithJSONObject:dictionary options:NSJSONWritingPrettyPrinted error:&amp;parseError];</span><br><span class="line"></span><br><span class="line">NSString* businessData = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];</span><br><span class="line"></span><br><span class="line">//NSDictionary to NSData</span><br><span class="line">NSMutableData *dic2data = [[NSMutableData alloc] init];    NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:dic2data];    [archiver encodeObject:dic forKey:@&quot;Some Key Value&quot;];    [archiver finishEncoding];    NSLog(@&quot;%@&quot;,dic2data);</span><br><span class="line">//NSData to NSDictionaryNSKeyedUnarchiver *unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData:dic2data];    NSDictionary *data2dic = [unarchiver decodeObjectForKey:@&quot;Some Key Value&quot;];    [unarchiver finishDecoding];    NSLog(@&quot;%@&quot;,data2dic);</span><br><span class="line"></span><br><span class="line">//NSDictionary to NSStringNSString *dic2string=[dic JSONRepresentation]; //这个方法是SBJson类库里的，需要导入SBJson.hNSLog(@&quot;%@&quot;,dic2string);</span><br></pre></td></tr></table></figure>
<h2 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bool 是int</span><br><span class="line">BOOL 是char</span><br><span class="line">bool b1 当b1&gt;0 就＝YES</span><br><span class="line">BOOL b2 当b2=1 才＝YES</span><br><span class="line"></span><br><span class="line">//__NSCFBoolean 判断</span><br><span class="line">if ([[messageDic objectForKey:@&quot;myself&quot;]boolValue] == NO)</span><br><span class="line"></span><br><span class="line">//输出Bool值</span><br><span class="line">NSLog(@&quot;ifReadOnly value: %@&quot; ,ifReadOnly?@&quot;YES&quot;:@&quot;NO&quot;);</span><br></pre></td></tr></table></figure>
<h2 id="NSNumber"><a href="#NSNumber" class="headerlink" title="NSNumber"></a>NSNumber</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSNumber *myIntValue = @32;</span><br><span class="line">NSNumber *myDoubleValue = @3.22346432;</span><br><span class="line"></span><br><span class="line">NSNumber *myBoolValue = @YES;</span><br><span class="line">NSNumber *myCharValue = @&apos;V&apos;;</span><br><span class="line"></span><br><span class="line">可以创建 NSNumber 对象，表示无符号整型 (unsigned integers)、长整型 (long integers)、长长整型 (long</span><br><span class="line">long integers) 和浮点值 (float values)，方法是将字符“U”、“L”、“LL”和“F”分别追加到记号值末尾。例如，</span><br><span class="line">创建封装浮点值的 NSNumber 对象，可以编写如下代码：</span><br><span class="line">NSNumber *myFloatValue = @3.2F</span><br></pre></td></tr></table></figure>
<h2 id="NSUserDefaults"><a href="#NSUserDefaults" class="headerlink" title="NSUserDefaults"></a>NSUserDefaults</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//全局的NsUserDefaults	</span><br><span class="line">//AppDelegate.h文件中添加 #define appDelegate ((AppDelegate *)[[UIApplication sharedApplication] delegate])@property (assign, nonatomic)NSUserDefaults *appDefault;</span><br><span class="line">	</span><br><span class="line">//AppDelegate.m文件中添加@synthesize appDefault;appDelegate.appDefault = [NSUserDefaults standardUserDefaults];</span><br><span class="line">	</span><br><span class="line">//顺带初始化下</span><br><span class="line">[appDelegate.appDefault setObject:NULL forKey:@&quot;one&quot;];</span><br><span class="line">	</span><br><span class="line">//存数据[appDelegate.appDefault setObject:@&quot;122333&quot; forKey:@&quot;one&quot;];//读数据[appDelegate.appDefault objectForKey:@&quot;one&quot;]</span><br></pre></td></tr></table></figure>
<h2 id="NSobject"><a href="#NSobject" class="headerlink" title="NSobject"></a>NSobject</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSobject常见的类方法有:alloc、new（基本等同于[[alloc]init],缺点是无法调用initWith等方法了）、description等。</span><br></pre></td></tr></table></figure>
<h2 id="NSLocale"><a href="#NSLocale" class="headerlink" title="NSLocale"></a>NSLocale</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSLocale可以获取用户的本地化信息设置，例如货币类型，国家，语言，数字，日期格式的格式化，提供正确的地理位置显示等等。下面的代码获取机器当前语言和国家代码。</span><br><span class="line">//Getting the User’s Language  </span><br><span class="line">NSArray *languageArray = [NSLocale preferredLanguages];  </span><br><span class="line">NSString *language = [languageArray objectAtIndex:0];  </span><br><span class="line">NSLog(@&quot;语言：%@&quot;, language);//en  </span><br><span class="line">NSLocale *locale = [NSLocale currentLocale];  </span><br><span class="line">NSString *country = [locale localeIdentifier];  </span><br><span class="line">NSLog(@&quot;国家：%@&quot;, country); //en_US</span><br></pre></td></tr></table></figure>
	  

	  <div>
  		<center>
		  <div class="pagination">
<ul class="pagination">
	
	
	
	
	
	
		
	
		
			
		
	
		
			
		
	
		
	
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
	
		
	
		
			
		
	
		
			
		
	
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
			
		
	
		
			
			
			
		
			
		
	
		
			
		
	
		
			
		
	
	
	
		<li class="prev"><a href="/2016/05/31/UITableView的使用/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>prev</a></li>
	
	<li><a href="/"><i class="fa fa-archive"></i>Home</a></li>
	
		<li class="next"><a href="/2016/05/25/iOS编程常用方法/" class="alignright next">next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

		</center>
	  </div>
	  
	</div> <!-- col-md-9/col-md-12 -->
	
  </div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
	<footer> <p>
  &copy; 2016 John Doe
  
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-wixo/">Wixo</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.tableofcontents.min.js"></script>
<script src="/js/tocgenerator.min.js"></script>
<script src="/js/main.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
</html>
