<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>iOS代码风格 | spike</title>
  <meta name="author" content="John Doe">
  
  <meta name="description" content="代码风格===多用字面量语法，少用与之等价的方法推荐：//字面量令代码中更为整洁 NSNumber * someNumber = @1; NSArray   * someArray = @[@&amp;quot;1&amp;quot;,@&amp;quot;2&amp;quot;]; NSDictionary * someD">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="iOS代码风格"/>
  <meta property="og:site_name" content="spike"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="spike" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/css/sidenav.css" media="screen" type="text/css">  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  

</head>

<body id="body" data-spy="scroll" data-target=".toc">
  <div class="container" id="container">
	<div class="content">
	  <div class="page-header">		
  <h1><a class="brand" href="/">spike</a><span class="split"></span><span class="title">iOS代码风格</span><span class="date" id="title-date"><i class="fa fa-clock-o"></i> 2016-08-09</span></h1>
</div>		

<div class="row page">
  <!-- cols -->	
  
  

  
	<div class="col-md-12">
	  

	  <!-- content -->
	  <h5 id="代码风格"><a href="#代码风格" class="headerlink" title="代码风格"></a>代码风格</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">===多用字面量语法，少用与之等价的方法</span><br><span class="line">推荐：</span><br><span class="line"></span><br><span class="line">//字面量令代码中更为整洁 NSNumber * someNumber = @1; NSArray   * someArray = @[@&quot;1&quot;,@&quot;2&quot;]; NSDictionary * someDictionary = @&#123;@&quot;one&quot;:@1,@&quot;two&quot;:@2&#125;;</span><br><span class="line"></span><br><span class="line">//取值 NSString * one = someArray[0]; NSNumber * oneNumber = someDictionary[@&quot;one&quot;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===多用类型常量，少用#define预处理指令</span><br><span class="line">#define YANG_ANIMATION_DURATION 0.5  // 转换为static const NSTimeInterval yangAnimationDuration = 0.3;</span><br><span class="line"></span><br><span class="line">当然我们用到更多的是在编译单元之外的&quot;全局符号表&quot;：</span><br><span class="line">// .m 文件中 NSString * const LoginMethod =  @&quot;loginRequestHandler&quot;;  // .h 文件中 UIKIT_EXTERN NSString * const LoginMethod;</span><br><span class="line"></span><br><span class="line">不要用预处理指令定义常量。 这样定义出来的常量不含类型信息，编译器只是会在编译前据此执行查找与替换操作，即使有人重新定义了常量值，编译器也不会产生，导致应用程序中的常量值不一致。</span><br><span class="line"></span><br><span class="line">在实现文件中使用 static const 来定义“只在编译单元内可见的常量”；</span><br><span class="line">头文件中使用 UIKIT_EXTERN来声明全局常量，并在相关实现文件中定义其值。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===用枚举表示状态、选项、状态码</span><br><span class="line">当使用 enum 的时候，建议使用新的固定的基础类型定义，因它有更强大的的类型检查和代码补全。 SDK 现在有一个宏来鼓励和促进使用固定类型定义 - NS_ENUM()</span><br><span class="line">typedef NS_ENUM(NSUInteger, YangMachineState) &#123;      YangMachineStateNone,      YangMachineStateIdle,      YangMachineStateRunning,      YangMachineStatePaused&#125;;</span><br><span class="line">在处理枚举类型的switch 语句中不要实现default分支。这样的话，假如新枚举之后编译器就会提示我们开发者：switch 语句并未处理所有枚举。</span><br><span class="line"></span><br><span class="line">===推荐的代码书写方式</span><br><span class="line">Preferred:</span><br><span class="line">if (!error) &#123;    return success;&#125;</span><br><span class="line">Not preferred:</span><br><span class="line">if (!error)    return success;</span><br><span class="line">or</span><br><span class="line">if (!error) return success;</span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">- (void)someMethod &#123;  if (![someOther boolValue]) &#123;      return;  &#125;</span><br><span class="line">//Do something important&#125;</span><br><span class="line">Not preferred:</span><br><span class="line">- (void)someMethod &#123;  if ([someOther boolValue]) &#123;    //Do something important  &#125;&#125;</span><br><span class="line">Preferred:</span><br><span class="line">if ([myValue isEqual:@42]) &#123; ...</span><br><span class="line">Not preferred:</span><br><span class="line">if ([@42 isEqual:myValue]) &#123; ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">if (someObject) &#123; ...if (![someObject boolValue]) &#123; ...if (!someObject) &#123; ...</span><br><span class="line">Not Preferred:</span><br><span class="line">if (someObject == YES) &#123; ... // Wrongif (myRawValue == YES) &#123; ... // Never do this.if ([someObject boolValue] == NO) &#123; ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">- (void)someMethod &#123;  if (![someOther boolValue]) &#123;      return;  &#125;</span><br><span class="line">//Do something important&#125;</span><br><span class="line">Not preferred:</span><br><span class="line">- (void)someMethod &#123;  if ([someOther boolValue]) &#123;    //Do something important  &#125;&#125;</span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">BOOL nameContainsSwift  = [sessionName containsString:@&quot;Swift&quot;];BOOL isCurrentYear      = [sessionDateCompontents year] == 2014;BOOL isSwiftSession     = nameContainsSwift &amp;&amp; isCurrentYear;</span><br><span class="line">if (isSwiftSession) &#123;    // Do something very cool&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">result = a &gt; b ? x : y;</span><br><span class="line">Not preferred:</span><br><span class="line">result = a &gt; b ? x = c &gt; d ? c : d : y;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">result = object ? : [self createObject];</span><br><span class="line">Not preferred:</span><br><span class="line">result = object ? object : [self createObject];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Case Statements</span><br><span class="line">case的几种形式：</span><br><span class="line">switch (condition) &#123;    case 1:        // ...        break;    case 2: &#123;        // ...        // Multi-line example using braces        break;       &#125;    case 3:        // ...        break;    default:         // ...        break;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">switch (condition) &#123;    case 1:    case 2:        // code executed for values 1 and 2        break;    default:         // ...        break;&#125;</span><br><span class="line"></span><br><span class="line">When using an enumerated type for a switch, default is not needed. For example:</span><br><span class="line">switch (menuType) &#123;    case ZOCEnumNone:        // ...        break;    case ZOCEnumValue1:        // ...        break;    case ZOCEnumValue2:        // ...        break;&#125;</span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">UIButton *settingsButton;</span><br><span class="line">Not Preferred:</span><br><span class="line">UIButton *setBut;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">static const NSTimeInterval ZOCSignInViewControllerFadeOutAnimationDuration = 0.4;</span><br><span class="line">Not Preferred:</span><br><span class="line">static const NSTimeInterval fadeOutTime = 0.4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">static NSString * const ZOCCacheControllerDidClearCacheNotification = @&quot;ZOCCacheControllerDidClearCacheNotification&quot;;static const CGFloat ZOCImageThumbnailHeight = 50.0f;</span><br><span class="line">Not Preferred:</span><br><span class="line">#define CompanyName @&quot;Apple Inc.&quot;#define magicNumber 42</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Methods:</span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">- (void)setExampleText:(NSString *)text image:(UIImage *)image;- (void)sendAction:(SEL)aSelector to:(id)anObject forAllCells:(BOOL)flag;- (id)viewWithTag:(NSInteger)tag;- (instancetype)initWithWidth:(CGFloat)width height:(CGFloat)height;</span><br><span class="line">Not Preferred:</span><br><span class="line">- (void)setT:(NSString *)text i:(UIImage *)image;- (void)sendAction:(SEL)aSelector :(id)anObject :(BOOL)flag;- (id)taggedView:(NSInteger)tag;- (instancetype)initWithWidth:(CGFloat)width andHeight:(CGFloat)height;- (instancetype)initWith:(int)width and:(int)height;  // Never do this.</span><br><span class="line"></span><br><span class="line">init methods should be structured like this:</span><br><span class="line">- (instancetype)init&#123;    self = [super init]; // call the designated initializer    if (self) &#123;        // Custom initialization    &#125;    return self;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Designated and Secondary Initializers</span><br><span class="line">@implementation ZOCEvent</span><br><span class="line">- (instancetype)initWithTitle:(NSString *)title                         date:(NSDate *)date                     location:(CLLocation *)location&#123;    self = [super init];    if (self) &#123;        _title    = title;        _date     = date;        _location = location;    &#125;    return self;&#125;</span><br><span class="line">- (instancetype)initWithTitle:(NSString *)title                         date:(NSDate *)date&#123;    return [self initWithTitle:title date:date location:nil];&#125;</span><br><span class="line">- (instancetype)initWithTitle:(NSString *)title&#123;    return [self initWithTitle:title date:[NSDate date] location:nil];&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A typical example is whether you create a UIViewController subclass overriding initWithNibName:bundle::</span><br><span class="line">@implementation ZOCViewController</span><br><span class="line">- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil&#123;    // call to the superclass designated initializer    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];    if (self) &#123;        // Custom initialization    &#125;    return self;&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> Let&apos;s see an example of the correct way to implement this:</span><br><span class="line">@implementation ZOCNewsViewController</span><br><span class="line">- (id)initWithNews:(ZOCNews *)news&#123;    // call to the immediate superclass&apos;s designated initializer    self = [super initWithNibName:nil bundle:nil];    if (self) &#123;        _news = news;    &#125;    return self;&#125;</span><br><span class="line">// Override the immediate superclass&apos;s designated initializer- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil&#123;    // call the new designated initializer    return [self initWithNews:nil];&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Singleton</span><br><span class="line">+ (instancetype)sharedInstance&#123;   static id sharedInstance = nil;   static dispatch_once_t onceToken = 0;   dispatch_once(&amp;onceToken, ^&#123;      sharedInstance = [[self alloc] init];   &#125;);   return sharedInstance;&#125;</span><br><span class="line">The use of dispatch_once(), which is synchronous, replaces the following, yet obsolete, idiom:</span><br><span class="line">+ (instancetype)sharedInstance&#123;    static id sharedInstance;    @synchronized(self) &#123;        if (sharedInstance == nil) &#123;            sharedInstance = [[MyClass alloc] init];        &#125;    &#125;    return sharedInstance;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Properties</span><br><span class="line">For example:</span><br><span class="line">NSString *text;</span><br><span class="line">Not:</span><br><span class="line">NSString* text;NSString * text;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">For example:</span><br><span class="line">view.backgroundColor = [UIColor orangeColor];[UIApplication sharedApplication].delegate;</span><br><span class="line">Not:</span><br><span class="line">[view setBackgroundColor:[UIColor orangeColor]];UIApplication.sharedApplication.delegate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Property Declaration</span><br><span class="line">@property (nonatomic, readwrite, copy) NSString *name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In order to achieve a public getter and a private setter, you can declare the public property as readonly and re-declare the same property in the the class extension as readwrite:</span><br><span class="line">@interface MyClass : NSObject@property (nonatomic, readonly) NSObject *object@end</span><br><span class="line">@implementation MyClass ()@property (nonatomic, readwrite, strong) NSObject *object@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Private Properties</span><br><span class="line">For example:</span><br><span class="line">@interface ZOCViewController ()@property (nonatomic, strong) UIView *bannerView;@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Lazy Loading</span><br><span class="line">- (NSDateFormatter *)dateFormatter &#123;  if (!_dateFormatter) &#123;    _dateFormatter = [[NSDateFormatter alloc] init];        NSLocale *enUSPOSIXLocale = [[NSLocale alloc] initWithLocaleIdentifier:@&quot;en_US_POSIX&quot;];        [dateFormatter setLocale:enUSPOSIXLocale];        [dateFormatter setDateFormat:@&quot;yyyy-MM-dd&apos;T&apos;HH:mm:ss.SSSSS&quot;];  &#125;  return _dateFormatter;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A complete pattern for the isEqual* method should be as so:</span><br><span class="line">- (BOOL)isEqual:(id)object &#123;    if (self == object) &#123;      return YES;    &#125;</span><br><span class="line">if (![object isKindOfClass:[ZOCPerson class]]) &#123;      return NO;    &#125;</span><br><span class="line">return [self isEqualToPerson:(ZOCPerson *)object];&#125;</span><br><span class="line">- (BOOL)isEqualToPerson:(Person *)person &#123;    if (!person) &#123;        return NO;    &#125;</span><br><span class="line">BOOL namesMatch = (!self.name &amp;&amp; !person.name) ||                       [self.name isEqualToString:person.name];    BOOL birthdaysMatch = (!self.birthday &amp;&amp; !person.birthday) ||                           [self.birthday isEqualToDate:person.birthday];</span><br><span class="line">return haveEqualNames &amp;&amp; haveEqualBirthdays;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Categories</span><br><span class="line">Example:</span><br><span class="line">@interface NSDate (ZOCTimeExtensions)- (NSString *)zoc_timeAgoShort;@end</span><br><span class="line">Not:</span><br><span class="line">@interface NSDate (ZOCTimeExtensions)- (NSString *)timeAgoShort;@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface NSDate : NSObject &lt;NSCopying, NSSecureCoding&gt;</span><br><span class="line">@property (readonly) NSTimeInterval timeIntervalSinceReferenceDate;</span><br><span class="line">@end</span><br><span class="line">@interface NSDate (NSDateCreation)</span><br><span class="line">+ (instancetype)date;+ (instancetype)dateWithTimeIntervalSinceNow:(NSTimeInterval)secs;+ (instancetype)dateWithTimeIntervalSinceReferenceDate:(NSTimeInterval)ti;+ (instancetype)dateWithTimeIntervalSince1970:(NSTimeInterval)secs;+ (instancetype)dateWithTimeInterval:(NSTimeInterval)secsToBeAdded sinceDate:(NSDate *)date;// ...@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Beautifying the code</span><br><span class="line">Preferred:</span><br><span class="line">if (user.isHappy) &#123;    //Do something&#125;else &#123;    //Do something else&#125;</span><br><span class="line">Not Preferred:</span><br><span class="line">if (user.isHappy)&#123;  //Do something&#125; else &#123;  //Do something else&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Preferred:</span><br><span class="line">[UIView animateWithDuration:1.0                 animations:^&#123;                     // something                 &#125;                 completion:^(BOOL finished) &#123;                     // something                 &#125;];</span><br><span class="line">Not Preferred:</span><br><span class="line">[UIView animateWithDuration:1.0 animations:^&#123;    // something &#125; completion:^(BOOL finished) &#123;    // something&#125;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSURL *url = (&#123;    NSString *urlString = [NSString stringWithFormat:@&quot;%@/%@&quot;, baseURLString, endpoint];    [NSURL URLWithString:urlString];&#125;);</span><br><span class="line"></span><br><span class="line">warning</span><br><span class="line">- (float)divide:(float)dividend by:(float)divisor&#123;    #warning Dude, don&apos;t compare floating point numbers like this!    if (divisor != 0.0) &#123;        return (dividend / divisor);    &#125;    else &#123;        return NAN;    &#125;&#125;</span><br></pre></td></tr></table></figure>	  

	  <div>
  		<center>
		  <div class="pagination">
<ul class="pagination">
	
	
	
	
	
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
			
		
	
		
			
			
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
		
	
		
			
		
	
	
	
		<li class="prev disabled"><a><i class="fa fa-arrow-circle-o-left"></i>prev</a></li>
	
	<li><a href="/"><i class="fa fa-archive"></i>Home</a></li>
	
		<li class="next"><a href="/2016/08/09/iOS/iOS开发流程/" class="alignright next">next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

		</center>
	  </div>
	  
	</div> <!-- col-md-9/col-md-12 -->
	
  </div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
	<footer> <p>
  &copy; 2016 John Doe
  
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-wixo/">Wixo</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.tableofcontents.min.js"></script>
<script src="/js/tocgenerator.min.js"></script>
<script src="/js/main.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
</html>
